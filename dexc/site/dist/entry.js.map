{"version":3,"file":"entry.js","mappings":"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","sources":["webpack://dexclient/./node_modules/@babel/runtime/regenerator/index.js","webpack://dexclient/./node_modules/regenerator-runtime/runtime.js","webpack://dexclient/webpack/bootstrap","webpack://dexclient/webpack/runtime/compat get default export","webpack://dexclient/webpack/runtime/define property getters","webpack://dexclient/webpack/runtime/hasOwnProperty shorthand","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://dexclient/./src/js/locales.ts","webpack://dexclient/./src/js/doc.ts","webpack://dexclient/./src/js/state.ts","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://dexclient/./src/js/registry.ts","webpack://dexclient/./src/js/basepage.ts","webpack://dexclient/./src/js/http.ts","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://dexclient/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://dexclient/./src/js/orderutil.ts","webpack://dexclient/./src/js/forms.ts","webpack://dexclient/./src/js/register.ts","webpack://dexclient/./src/js/login.ts","webpack://dexclient/./src/js/notifications.ts","webpack://dexclient/./src/js/wallets.ts","webpack://dexclient/./src/js/settings.ts","webpack://dexclient/./src/js/orderbook.ts","webpack://dexclient/./src/js/charts.ts","webpack://dexclient/./src/js/ws.ts","webpack://dexclient/./src/js/markets.ts","webpack://dexclient/./src/js/orders.ts","webpack://dexclient/./src/js/order.ts","webpack://dexclient/./src/js/dexsettings.ts","webpack://dexclient/./src/js/app.ts","webpack://dexclient/./src/index.ts"],"sourcesContent":["module.exports = require(\"regenerator-runtime\");\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","type Locale = Record<string, string>\n\nexport const ID_NO_PASS_ERROR_MSG = 'ID_NO_PASS_ERROR_MSG'\nexport const ID_NO_APP_PASS_ERROR_MSG = 'ID_NO_APP_PASS_ERROR_MSG'\nexport const ID_SET_BUTTON_BUY = 'ID_SET_BUTTON_BUY'\nexport const ID_SET_BUTTON_SELL = 'ID_SET_BUTTON_SELL'\nexport const ID_OFF = 'ID_OFF'\nexport const ID_READY = 'ID_READY'\nexport const ID_LOCKED = 'ID_LOCKED'\nexport const ID_NOWALLET = 'ID_NOWALLET'\nexport const ID_WALLET_SYNC_PROGRESS = 'ID_WALLET_SYNC_PROGRESS'\nexport const ID_HIDE_ADDITIONAL_SETTINGS = 'ID_HIDE_ADDITIONAL_SETTINGS'\nexport const ID_SHOW_ADDITIONAL_SETTINGS = 'ID_SHOW_ADDITIONAL_SETTINGS'\nexport const ID_BUY = 'ID_BUY'\nexport const ID_SELL = 'ID_SELL'\nexport const ID_NOT_SUPPORTED = 'ID_NOT_SUPPORTED'\nexport const ID_CONNECTION_FAILED = 'ID_CONNECTION_FAILED'\nexport const ID_ORDER_PREVIEW = 'ID_ORDER_PREVIEW'\nexport const ID_CALCULATING = 'ID_CALCULATING'\nexport const ID_ESTIMATE_UNAVAILABLE = 'ID_ESTIMATE_UNAVAILABLE'\nexport const ID_NO_ZERO_RATE = 'ID_NO_ZERO_RATE'\nexport const ID_NO_ZERO_QUANTITY = 'ID_NO_ZERO_QUANTITY'\nexport const ID_TRADE = 'ID_TRADE'\nexport const ID_NO_ASSET_WALLET = 'ID_NO_ASSET_WALLET'\nexport const ID_EXECUTED = 'ID_EXECUTED'\nexport const ID_BOOKED = 'ID_BOOKED'\nexport const ID_CANCELING = 'ID_CANCELING'\nexport const ID_PASSWORD_NOT_MATCH = 'ID_PASSWORD_NOT_MATCH'\nexport const ID_ACCT_UNDEFINED = 'ID_ACCT_UNDEFINED'\nexport const ID_KEEP_WALLET_PASS = 'ID_KEEP_WALLET_PASS'\nexport const ID_NEW_WALLET_PASS = 'ID_NEW_WALLET_PASS'\nexport const ID_LOT = 'ID_LOT'\nexport const ID_LOTS = 'ID_LOTS'\nexport const ID_UNKNOWN = 'ID_UNKNOWN'\nexport const ID_EPOCH = 'ID_EPOCH'\nexport const ID_SETTLING = 'ID_SETTLING'\nexport const ID_NO_MATCH = 'ID_NO_MATCH'\nexport const ID_CANCELED = 'ID_CANCELED'\nexport const ID_REVOKED = 'ID_REVOKED'\nexport const ID_WAITING_FOR_CONFS = 'ID_WAITING_FOR_CONFS'\nexport const ID_NONE_SELECTED = 'ID_NONE_SELECTED' // unused?\nexport const ID_REGISTRATION_FEE_SUCCESS = 'ID_REGISTRATION_FEE_SUCCESS'\nexport const ID_API_ERROR = 'ID_API_ERROR'\nexport const ID_ADD = 'ID_ADD'\nexport const ID_CREATE = 'ID_CREATE'\nexport const ID_SETUP_WALLET = 'ID_SETUP_WALLET'\nexport const ID_WALLET_READY = 'ID_WALLET_READY'\nexport const ID_CHANGE_WALLET_TYPE = 'ID_CHANGE_WALLET_TYPE'\nexport const ID_KEEP_WALLET_TYPE = 'ID_KEEP_WALLET_TYPE'\nexport const WALLET_READY = 'WALLET_READY'\nexport const SETUP_NEEDED = 'SETUP_NEEDED'\n\nexport const enUS: Locale = {\n  [ID_NO_PASS_ERROR_MSG]: 'password cannot be empty',\n  [ID_NO_APP_PASS_ERROR_MSG]: 'app password cannot be empty',\n  [ID_PASSWORD_NOT_MATCH]: 'passwords do not match',\n  [ID_SET_BUTTON_BUY]: 'Place order to buy  {{ asset }}',\n  [ID_SET_BUTTON_SELL]: 'Place order to sell {{ asset }}',\n  [ID_OFF]: 'off',\n  [ID_READY]: 'ready',\n  [ID_LOCKED]: 'locked',\n  [ID_NOWALLET]: 'no wallet',\n  [ID_WALLET_SYNC_PROGRESS]: 'wallet is {{ syncProgress }}% synced',\n  [ID_HIDE_ADDITIONAL_SETTINGS]: 'hide additional settings',\n  [ID_SHOW_ADDITIONAL_SETTINGS]: 'show additional settings',\n  [ID_BUY]: 'Buy',\n  [ID_SELL]: 'Sell',\n  [ID_NOT_SUPPORTED]: '{{ asset }} is not supported',\n  [ID_CONNECTION_FAILED]: 'Connection to dex server failed. You can close dexc and try again later or wait for it to reconnect.',\n  [ID_ORDER_PREVIEW]: 'Total: {{ total }} {{ asset }}',\n  [ID_CALCULATING]: 'calculating...',\n  [ID_ESTIMATE_UNAVAILABLE]: 'estimate unavailable',\n  [ID_NO_ZERO_RATE]: 'zero rate not allowed',\n  [ID_NO_ZERO_QUANTITY]: 'zero quantity not allowed',\n  [ID_TRADE]: 'trade',\n  [ID_NO_ASSET_WALLET]: 'No {{ asset }} wallet',\n  [ID_EXECUTED]: 'executed',\n  [ID_BOOKED]: 'booked',\n  [ID_CANCELING]: 'canceling',\n  [ID_ACCT_UNDEFINED]: 'Account undefined.',\n  [ID_KEEP_WALLET_PASS]: 'keep current wallet password',\n  [ID_NEW_WALLET_PASS]: 'set a new wallet password',\n  [ID_LOT]: 'lot',\n  [ID_LOTS]: 'lots',\n  [ID_UNKNOWN]: 'unknown',\n  [ID_EPOCH]: 'epoch',\n  [ID_SETTLING]: 'settling',\n  [ID_NO_MATCH]: 'no match',\n  [ID_CANCELED]: 'canceled',\n  [ID_REVOKED]: 'revoked',\n  [ID_WAITING_FOR_CONFS]: 'Waiting for confirmations...',\n  [ID_NONE_SELECTED]: 'none selected',\n  [ID_REGISTRATION_FEE_SUCCESS]: 'Registration fee payment successful!',\n  [ID_API_ERROR]: 'API error',\n  [ID_ADD]: 'Add',\n  [ID_CREATE]: 'Create',\n  [ID_WALLET_READY]: 'Ready',\n  [ID_SETUP_WALLET]: 'Setup',\n  [ID_CHANGE_WALLET_TYPE]: 'change the wallet type',\n  [ID_KEEP_WALLET_TYPE]: 'don\\'t change the wallet type',\n  [WALLET_READY]: 'Wallet Ready',\n  [SETUP_NEEDED]: 'Setup Needed'\n}\n\nexport const ptBR: Locale = {\n  [ID_NO_PASS_ERROR_MSG]: 'senha não pode ser vazia',\n  [ID_NO_APP_PASS_ERROR_MSG]: 'senha do app não pode ser vazia',\n  [ID_PASSWORD_NOT_MATCH]: 'senhas diferentes',\n  [ID_SET_BUTTON_BUY]: 'Ordem de compra de {{ asset }}',\n  [ID_SET_BUTTON_SELL]: 'Ordem de venda de {{ asset }}',\n  [ID_OFF]: 'desligar',\n  [ID_READY]: 'pronto',\n  [ID_LOCKED]: 'trancado',\n  [ID_NOWALLET]: 'sem carteira',\n  [ID_WALLET_SYNC_PROGRESS]: 'carteira está {{ syncProgress }}% sincronizada',\n  [ID_HIDE_ADDITIONAL_SETTINGS]: 'esconder configurações adicionais',\n  [ID_SHOW_ADDITIONAL_SETTINGS]: 'mostrar configurações adicionais',\n  [ID_BUY]: 'Comprar',\n  [ID_SELL]: 'Vender',\n  [ID_NOT_SUPPORTED]: '{{ asset }} não tem suporte',\n  [ID_CONNECTION_FAILED]: 'Conexão ao server dex falhou. Pode fechar dexc e tentar novamente depois ou esperar para tentar se reconectar.',\n  [ID_ORDER_PREVIEW]: 'Total: {{ total }} {{ asset }}',\n  [ID_CALCULATING]: 'calculando...',\n  [ID_ESTIMATE_UNAVAILABLE]: 'estimativa indisponível',\n  [ID_NO_ZERO_RATE]: 'taxa não pode ser zero',\n  [ID_NO_ZERO_QUANTITY]: 'quantidade não pode ser zero',\n  [ID_TRADE]: 'troca',\n  [ID_NO_ASSET_WALLET]: 'Sem carteira {{ asset }}',\n  [ID_EXECUTED]: 'executado',\n  [ID_BOOKED]: 'reservado',\n  [ID_CANCELING]: 'cancelando',\n  [ID_ACCT_UNDEFINED]: 'conta não definida.',\n  [ID_KEEP_WALLET_PASS]: 'manter senha da carteira',\n  [ID_NEW_WALLET_PASS]: 'definir nova senha para carteira',\n  [ID_LOT]: 'lote',\n  [ID_LOTS]: 'lotes',\n  [ID_UNKNOWN]: 'desconhecido',\n  [ID_EPOCH]: 'epoque',\n  [ID_SETTLING]: 'assentando',\n  [ID_NO_MATCH]: 'sem combinações',\n  [ID_CANCELED]: 'cancelado',\n  [ID_REVOKED]: 'revocado',\n  [ID_WAITING_FOR_CONFS]: 'Esperando confirmações...',\n  [ID_NONE_SELECTED]: 'nenhuma selecionado',\n  [ID_REGISTRATION_FEE_SUCCESS]: 'Sucesso no pagamento da taxa de registro!',\n  [ID_API_ERROR]: 'Erro de API',\n  [ID_ADD]: 'Adicionar',\n  [ID_CREATE]: 'Criar',\n  [ID_WALLET_READY]: 'Escolher',\n  [ID_SETUP_WALLET]: 'Configurar',\n  [ID_CHANGE_WALLET_TYPE]: 'trocar o tipo de carteira',\n  [ID_KEEP_WALLET_TYPE]: 'Não trocara tipo de carteira',\n  [WALLET_READY]: 'Carteira Pronta',\n  [SETUP_NEEDED]: 'Configuração Necessária'\n}\n\nexport const zhCN: Locale = {\n  [ID_NO_PASS_ERROR_MSG]: '密码不能为空',\n  [ID_NO_APP_PASS_ERROR_MSG]: '应用密码不能为空',\n  [ID_PASSWORD_NOT_MATCH]: '密码不相同',\n  [ID_SET_BUTTON_BUY]: '来自{{ asset }}的买入订单',\n  [ID_SET_BUTTON_SELL]: '来自{{ asset }}的卖出订单',\n  [ID_OFF]: '关闭',\n  [ID_READY]: '准备就绪', //  alt. 准备好\n  [ID_LOCKED]: '锁定',\n  [ID_NOWALLET]: '未连接钱包', // alt. 没有钱包\n  [ID_WALLET_SYNC_PROGRESS]: '钱包同步进度{{ syncProgress }}%',\n  [ID_HIDE_ADDITIONAL_SETTINGS]: '隐藏其它设置',\n  [ID_SHOW_ADDITIONAL_SETTINGS]: '显示其它设置',\n  [ID_BUY]: '买',\n  [ID_SELL]: '卖',\n  [ID_NOT_SUPPORTED]: '{{ asset }}不受支持',\n  [ID_CONNECTION_FAILED]: '连接到服务器 dex 失败。您可以关闭 dexc 并稍后重试或等待尝试重新连接。',\n  [ID_ORDER_PREVIEW]: '总计： {{ total }} {{ asset }}',\n  [ID_CALCULATING]: '计算中...',\n  [ID_ESTIMATE_UNAVAILABLE]: '估计不可用',\n  [ID_NO_ZERO_RATE]: '汇率不能为零',\n  [ID_NO_ZERO_QUANTITY]: '数量不能为零',\n  [ID_TRADE]: '交易',\n  [ID_NO_ASSET_WALLET]: '没有钱包 {{ asset }}',\n  [ID_EXECUTED]: '执行',\n  [ID_BOOKED]: '保留',\n  [ID_CANCELING]: '取消',\n  [ID_ACCT_UNDEFINED]: '帐户未定义。',\n  [ID_KEEP_WALLET_PASS]: '保留钱包密码',\n  [ID_NEW_WALLET_PASS]: '设置新的钱包密码',\n  [ID_LOT]: '批处理',\n  [ID_LOTS]: '批', // alt. 很多\n  [ID_UNKNOWN]: 'unknown', // TODO\n  [ID_EPOCH]: '时间',\n  [ID_SETTLING]: 'settling', // TODO - \"settling\" shows in the Your Orders table when the order is doing an atomic swap with another trade\n  [ID_NO_MATCH]: 'no match', // TODO - \"no match\" shows in the Your Orders table when the order did not match with another trade and is done\n  [ID_CANCELED]: 'canceled', // TODO - \"canceled\" shows in the Your Orders table when the order has been canceled\n  [ID_REVOKED]: 'revoked', // TODO - \"revoked\" shows in the Your Orders table when the order has failed during swap\n  [ID_WAITING_FOR_CONFS]: 'Waiting for confirmations...', // TODO - shows when the registration fee transaction is waiting to be mined (needs confirmations)\n  [ID_NONE_SELECTED]: 'none selected', // TODO - looks unused, but this indicates nothing is selected in some list\n  [ID_REGISTRATION_FEE_SUCCESS]: 'Registration fee payment successful!', // TODO - When the registration fee transaction reaches the required number of confirmations, this is shown\n  [ID_API_ERROR]: '接口错误',\n  [ID_ADD]: '加',\n  [ID_CREATE]: '创建',\n  [ID_WALLET_READY]: 'Choose Wallet', // xxx translate\n  [ID_SETUP_WALLET]: 'Setup' // xxx translate\n}\n\nexport const plPL: Locale = {\n  [ID_NO_PASS_ERROR_MSG]: 'hasło nie może być puste',\n  [ID_NO_APP_PASS_ERROR_MSG]: 'hasło aplikacji nie może być puste',\n  [ID_PASSWORD_NOT_MATCH]: 'hasła nie są jednakowe',\n  [ID_SET_BUTTON_BUY]: 'Złóż zlecenie, aby kupić  {{ asset }}',\n  [ID_SET_BUTTON_SELL]: 'Złóż zlecenie, aby sprzedać {{ asset }}',\n  [ID_OFF]: 'wyłączony',\n  [ID_READY]: 'gotowy',\n  [ID_LOCKED]: 'zablokowany',\n  [ID_NOWALLET]: 'brak portfela',\n  [ID_WALLET_SYNC_PROGRESS]: 'portfel zsynchronizowany w {{ syncProgress }}%',\n  [ID_HIDE_ADDITIONAL_SETTINGS]: 'ukryj dodatkowe ustawienia',\n  [ID_SHOW_ADDITIONAL_SETTINGS]: 'pokaż dodatkowe ustawienia',\n  [ID_BUY]: 'Kup',\n  [ID_SELL]: 'Sprzedaj',\n  [ID_NOT_SUPPORTED]: '{{ asset }} nie jest wspierany',\n  [ID_CONNECTION_FAILED]: 'Połączenie z serwerem dex nie powiodło się. Możesz zamknąć dexc i spróbować ponownie później, lub poczekać na wznowienie połączenia.',\n  [ID_ORDER_PREVIEW]: 'W sumie: {{ total }} {{ asset }}',\n  [ID_CALCULATING]: 'obliczanie...',\n  [ID_ESTIMATE_UNAVAILABLE]: 'brak szacunkowego wyliczenia',\n  [ID_NO_ZERO_RATE]: 'zero nie może być ceną',\n  [ID_NO_ZERO_QUANTITY]: 'zero nie może być ilością',\n  [ID_TRADE]: 'handluj',\n  [ID_NO_ASSET_WALLET]: 'Brak portfela {{ asset }}',\n  [ID_EXECUTED]: 'wykonano',\n  [ID_BOOKED]: 'zapisano',\n  [ID_CANCELING]: 'anulowanie',\n  [ID_ACCT_UNDEFINED]: 'Niezdefiniowane konto.',\n  [ID_KEEP_WALLET_PASS]: 'zachowaj obecne hasło portfela',\n  [ID_NEW_WALLET_PASS]: 'ustaw nowe hasło portfela',\n  [ID_LOT]: 'lot',\n  [ID_LOTS]: 'loty(ów)',\n  [ID_UNKNOWN]: 'nieznane',\n  [ID_EPOCH]: 'epoka',\n  [ID_SETTLING]: 'rozliczanie',\n  [ID_NO_MATCH]: 'brak spasowania',\n  [ID_CANCELED]: 'anulowano',\n  [ID_REVOKED]: 'unieważniono',\n  [ID_WAITING_FOR_CONFS]: 'Oczekiwanie na potwierdzenia...',\n  [ID_NONE_SELECTED]: 'brak zaznaczenia',\n  [ID_REGISTRATION_FEE_SUCCESS]: 'Płatność rejestracyjna powiodła się!',\n  [ID_API_ERROR]: 'błąd API',\n  [ID_ADD]: 'Dodaj',\n  [ID_CREATE]: 'Utwórz',\n  [ID_WALLET_READY]: 'Gotowy',\n  [ID_SETUP_WALLET]: 'Konfiguracja',\n  [ID_CHANGE_WALLET_TYPE]: 'zmień typ portfela',\n  [ID_KEEP_WALLET_TYPE]: 'nie zmieniaj typu portfela',\n  [WALLET_READY]: 'Portfel jest gotowy',\n  [SETUP_NEEDED]: 'Potrzebna konfiguracja'\n}\n\nconst localesMap: Record<string, Locale> = {\n  'en-us': enUS,\n  'pt-br': ptBR,\n  'zh-cn': zhCN,\n  'pl-pl': plPL\n}\n\n/* locale will hold the locale loaded via setLocale. */\nlet locale: Locale\n\nconst defaultLocale = enUS\n\n/*\n * setLocale read the language tag from the current document's html element lang\n * attribute and sets the locale. setLocale should be called once by the\n * application before prep is used.\n*/\nexport function setLocale () { locale = localesMap[document.documentElement.lang.toLowerCase()] }\n\n/* prep will format the message to the current locale. */\nexport function prep (k: string, args?: Record<string, string>) {\n  return stringTemplateParser(locale[k] || defaultLocale[k], args || {})\n}\n\n/*\n * stringTemplateParser is a template string matcher, where expression is any\n * text. It switches what is inside double brackets (e.g. 'buy {{ asset }}')\n * for the value described into args. args is an object with keys\n * equal to the placeholder keys. (e.g. {\"asset\": \"dcr\"}).\n * So that will be switched for: 'asset dcr'.\n */\nfunction stringTemplateParser (expression: string, args: Record<string, string>) {\n  // templateMatcher matches any text which:\n  // is some {{ text }} between two brackets, and a space between them.\n  // It is global, therefore it will change all occurrences found.\n  // text can be anything, but brackets '{}' and space '\\s'\n  const templateMatcher = /{{\\s?([^{}\\s]*)\\s?}}/g\n  return expression.replace(templateMatcher, (_, value) => args[value])\n}\n\nwindow.localeDiscrepancies = () => {\n  const ref = enUS\n  for (const [lang, dict] of Object.entries(localesMap)) {\n    if (dict === ref) continue\n    for (const [k, s] of Object.entries(ref)) {\n      if (!dict[k]) console.log(`${lang} needs a tranlation for: ${s}`)\n    }\n  }\n}\n","import * as intl from './locales'\nimport {\n  UnitInfo,\n  LayoutMetrics,\n  WalletState,\n  PageElement\n} from './registry'\n\nconst parser = new window.DOMParser()\n\nconst FPS = 30\n\nconst BipIDs = {\n  0: 'btc',\n  42: 'dcr',\n  2: 'ltc',\n  22: 'mona',\n  28: 'vtc',\n  3: 'doge',\n  145: 'bch',\n  60: 'eth',\n  133: 'zec'\n}\n\nconst BipSymbols = Object.values(BipIDs)\n\nconst intFormatter = new Intl.NumberFormat((navigator.languages as string[]))\n\n/* A cache for formatters used for Doc.formatCoinValue. */\nconst decimalFormatters = {}\n\n/*\n * decimalFormatter gets the formatCoinValue formatter for the specified decimal\n * precision.\n */\nfunction decimalFormatter (prec: number) {\n  return formatter(decimalFormatters, 2, prec)\n}\n\n/* A cache for formatters used for Doc.formatFullPrecision. */\nconst fullPrecisionFormatters = {}\n\n/*\n * fullPrecisionFormatter gets the formatFullPrecision formatter for the\n * specified decimal precision.\n */\nfunction fullPrecisionFormatter (prec: number) {\n  return formatter(fullPrecisionFormatters, prec, prec)\n}\n\n/*\n * formatter gets the formatter from the supplied cache if it already exists,\n * else creates it.\n */\nfunction formatter (formatters: Record<string, Intl.NumberFormat>, min: number, max: number): Intl.NumberFormat {\n  const k = `${min}-${max}`\n  let fmt = formatters[k]\n  if (!fmt) {\n    fmt = new Intl.NumberFormat((navigator.languages as string[]), {\n      minimumFractionDigits: min,\n      maximumFractionDigits: max\n    })\n    formatters[k] = fmt\n  }\n  return fmt\n}\n\n/*\n * convertToConventional converts the value in atomic units to conventional\n * units.\n */\nfunction convertToConventional (v: number, unitInfo?: UnitInfo) {\n  let prec = 8\n  if (unitInfo) {\n    const f = unitInfo.conventional.conversionFactor\n    v /= f\n    prec = Math.round(Math.log10(f))\n  }\n  return [v, prec]\n}\n\n// Helpers for working with the DOM.\nexport default class Doc {\n  /*\n   * idel is the element with the specified id that is the descendent of the\n   * specified node.\n   */\n  static idel (el: Document | Element, id: string): HTMLElement {\n    return el.querySelector(`#${id}`) as HTMLElement\n  }\n\n  /* bind binds the function to the event for the element. */\n  static bind (el: EventTarget, ev: string, f: (e: Event) => void) {\n    el.addEventListener(ev, f)\n  }\n\n  /* unbind removes the handler for the event from the element. */\n  static unbind (el: EventTarget, ev: string, f: (e: Event) => void) {\n    el.removeEventListener(ev, f)\n  }\n\n  /* noderize creates a Document object from a string of HTML. */\n  static noderize (html: string): Document {\n    return parser.parseFromString(html, 'text/html')\n  }\n\n  /*\n   * mouseInElement returns true if the position of mouse event, e, is within\n   * the bounds of the specified element.\n   */\n  static mouseInElement (e: MouseEvent, el: HTMLElement): boolean {\n    const rect = el.getBoundingClientRect()\n    return e.pageX >= rect.left && e.pageX <= rect.right &&\n      e.pageY >= rect.top && e.pageY <= rect.bottom\n  }\n\n  /*\n   * layoutMetrics gets information about the elements position on the page.\n   */\n  static layoutMetrics (el: HTMLElement): LayoutMetrics {\n    const box = el.getBoundingClientRect()\n    const docEl = document.documentElement\n    const top = box.top + docEl.scrollTop\n    const left = box.left + docEl.scrollLeft\n    const w = el.offsetWidth\n    const h = el.offsetHeight\n    return {\n      bodyTop: top,\n      bodyLeft: left,\n      width: w,\n      height: h,\n      centerX: left + w / 2,\n      centerY: top + h / 2\n    }\n  }\n\n  /* empty removes all child nodes from the specified element. */\n  static empty (...els: Element[]) {\n    for (const el of els) while (el.firstChild) el.removeChild(el.firstChild)\n  }\n\n  /*\n   * hide hides the specified elements. This is accomplished by adding the\n   * bootstrap d-hide class to the element. Use Doc.show to undo.\n   */\n  static hide (...els: Element[]) {\n    for (const el of els) el.classList.add('d-hide')\n  }\n\n  /*\n   * show shows the specified elements. This is accomplished by removing the\n   * bootstrap d-hide class as added with Doc.hide.\n   */\n  static show (...els: Element[]) {\n    for (const el of els) el.classList.remove('d-hide')\n  }\n\n  /* isHidden returns true if the specified element is hidden */\n  static isHidden (el: Element): boolean {\n    return el.classList.contains('d-hide')\n  }\n\n  /* isDisplayed returns true if the specified element is not hidden */\n  static isDisplayed (el: Element): boolean {\n    return !el.classList.contains('d-hide')\n  }\n\n  /*\n   * animate runs the supplied function, which should be a \"progress\" function\n   * accepting one argument. The progress function will be called repeatedly\n   * with the argument varying from 0.0 to 1.0. The exact path that animate\n   * takes from 0.0 to 1.0 will vary depending on the choice of easing\n   * algorithm. See the Easing object for the available easing algo choices. The\n   * default easing algorithm is linear.\n   */\n  static async animate (duration: number, f: (progress: number) => void, easingAlgo?: string) {\n    const easer = easingAlgo ? Easing[easingAlgo] : Easing.linear\n    const start = new Date().getTime()\n    const end = start + duration\n    const range = end - start\n    const frameDuration = 1000 / FPS\n    let now = start\n    while (now < end) {\n      f(easer((now - start) / range))\n      await sleep(frameDuration)\n      now = new Date().getTime()\n    }\n    f(1)\n  }\n\n  static applySelector (ancestor: HTMLElement, k: string): PageElement[] {\n    return Array.from(ancestor.querySelectorAll(k)) as PageElement[]\n  }\n\n  static kids (ancestor: HTMLElement): PageElement[] {\n    return Array.from(ancestor.children) as PageElement[]\n  }\n\n  static safeSelector (ancestor: HTMLElement, k: string): PageElement {\n    const el = ancestor.querySelector(k)\n    if (el) return el as PageElement\n    console.warn(`no element found for selector '${k}' on element ->`, ancestor)\n    return document.createElement('div')\n  }\n\n  /*\n   * idDescendants creates an object mapping to elements which are descendants\n   * of the ancestor and have id attributes. Elements are keyed by their id\n   * value.\n   */\n  static idDescendants (ancestor: HTMLElement): Record<string, PageElement> {\n    const d: Record<string, PageElement> = {}\n    for (const el of Doc.applySelector(ancestor, '[id]')) d[el.id] = el\n    return d\n  }\n\n  /*\n   * formatCoinValue formats the value in atomic units into a string\n   * representation in conventional units. If the value happens to be an\n   * integer, no decimals are displayed. Trailing zeros may be truncated.\n   */\n  static formatCoinValue (vAtomic: number, unitInfo?: UnitInfo): string {\n    const [v, prec] = convertToConventional(vAtomic, unitInfo)\n    if (Number.isInteger(v)) return intFormatter.format(v)\n    return decimalFormatter(prec).format(v)\n  }\n\n  /*\n   * formatFullPrecision formats the value in atomic units into a string\n   * representation in conventional units using the full decimal precision\n   * associated with the conventional unit's conversion factor.\n   */\n  static formatFullPrecision (vAtomic: number, unitInfo?: UnitInfo): string {\n    const [v, prec] = convertToConventional(vAtomic, unitInfo)\n    return fullPrecisionFormatter(prec).format(v)\n  }\n\n  /*\n   * formatFiatConversion formats the value in atomic units to its representation in\n   * conventional units and returns the fiat value as a string.\n   */\n  static formatFiatConversion (vAtomic: number, rate: number, unitInfo?: UnitInfo): string {\n    if (!rate || rate === 0) return 'unavailable'\n    const prec = 2\n    const [v] = convertToConventional(vAtomic, unitInfo)\n    const value = v * rate\n    return fullPrecisionFormatter(prec).format(value)\n  }\n\n  /*\n   * logoPath creates a path to a png logo for the specified ticker symbol. If\n   * the symbol is not a supported asset, the generic letter logo will be\n   * requested instead.\n   */\n  static logoPath (symbol: string): string {\n    if (BipSymbols.indexOf(symbol) === -1) symbol = symbol.substring(0, 1)\n    return `/img/coins/${symbol}.png`\n  }\n\n  /*\n  * cleanTemplates removes the elements from the DOM and deletes the id\n  * attribute.\n  */\n  static cleanTemplates (...tmpls: HTMLElement[]) {\n    tmpls.forEach(tmpl => {\n      tmpl.remove()\n      tmpl.removeAttribute('id')\n    })\n  }\n\n  /*\n  * tmplElement is a helper function for grabbing sub-elements of the market list\n  * template.\n  */\n  static tmplElement (ancestor: Document | Element, s: string): PageElement {\n    return ancestor.querySelector(`[data-tmpl=\"${s}\"]`) || document.createElement('div')\n  }\n\n  /*\n  * parseTemplate returns an object of data-tmpl elements, keyed by their\n  * data-tmpl values.\n  */\n  static parseTemplate (ancestor: HTMLElement): Record<string, PageElement> {\n    const d: Record<string, PageElement> = {}\n    for (const el of Doc.applySelector(ancestor, '[data-tmpl]')) d[el.dataset.tmpl || ''] = el\n    return d\n  }\n\n  /*\n   * timeSince returns a string representation of the duration since the\n   * specified unix timestamp.\n   */\n  static timeSince (t: number): string {\n    return Doc.formatDuration((new Date().getTime()) - t)\n  }\n\n  /* formatDuration returns a string representation of the duration */\n  static formatDuration (dur: number): string {\n    let seconds = Math.floor(dur)\n    let result = ''\n    let count = 0\n    const add = (n: number, s: string) => {\n      if (n > 0 || count > 0) count++\n      if (n > 0) result += `${n} ${s} `\n      return count >= 2\n    }\n    let y, mo, d, h, m, s\n    [y, seconds] = timeMod(seconds, aYear)\n    if (add(y, 'y')) { return result }\n    [mo, seconds] = timeMod(seconds, aMonth)\n    if (add(mo, 'mo')) { return result }\n    [d, seconds] = timeMod(seconds, aDay)\n    if (add(d, 'd')) { return result }\n    [h, seconds] = timeMod(seconds, anHour)\n    if (add(h, 'h')) { return result }\n    [m, seconds] = timeMod(seconds, aMinute)\n    if (add(m, 'm')) { return result }\n    [s, seconds] = timeMod(seconds, 1000)\n    add(s, 's')\n    return result || '0 s'\n  }\n\n  /*\n   * disableMouseWheel can be used to disable the mouse wheel for any\n   * input. It is very easy to unknowingly scroll up on a number input\n   * and then submit an unexpected value. This function prevents the\n   * scroll increment/decrement behavior for a wheel action on a\n   * number input.\n   */\n  static disableMouseWheel (...inputFields: Element[]) {\n    for (const inputField of inputFields) {\n      inputField.addEventListener('wheel', (ev) => {\n        ev.preventDefault()\n      })\n    }\n  }\n}\n\n/* Easing algorithms for animations. */\nconst Easing: Record<string, (t: number) => number> = {\n  linear: t => t,\n  easeIn: t => t * t,\n  easeOut: t => t * (2 - t),\n  easeInHard: t => t * t * t,\n  easeOutHard: t => (--t) * t * t + 1\n}\n\n/* WalletIcons are used for controlling wallets in various places. */\nexport class WalletIcons {\n  icons: Record<string, HTMLElement>\n  status: Element\n\n  constructor (box: HTMLElement) {\n    const stateElement = (name: string) => box.querySelector(`[data-state=${name}]`) as HTMLElement\n    this.icons = {}\n    this.icons.sleeping = stateElement('sleeping')\n    this.icons.locked = stateElement('locked')\n    this.icons.unlocked = stateElement('unlocked')\n    this.icons.nowallet = stateElement('nowallet')\n    this.icons.syncing = stateElement('syncing')\n    this.icons.nopeers = stateElement('nopeers')\n    this.status = stateElement('status')\n  }\n\n  /* sleeping sets the icons to indicate that the wallet is not connected. */\n  sleeping () {\n    const i = this.icons\n    Doc.hide(i.locked, i.unlocked, i.nowallet, i.syncing)\n    Doc.show(i.sleeping)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_OFF)\n  }\n\n  /*\n   * locked sets the icons to indicate that the wallet is connected, but locked.\n   */\n  locked () {\n    const i = this.icons\n    Doc.hide(i.unlocked, i.nowallet, i.sleeping)\n    Doc.show(i.locked)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_LOCKED)\n  }\n\n  /*\n   * unlocked sets the icons to indicate that the wallet is connected and\n   * unlocked.\n   */\n  unlocked () {\n    const i = this.icons\n    Doc.hide(i.locked, i.nowallet, i.sleeping)\n    Doc.show(i.unlocked)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_READY)\n  }\n\n  /* sleeping sets the icons to indicate that no wallet exists. */\n  nowallet () {\n    const i = this.icons\n    Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing)\n    Doc.show(i.nowallet)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_NOWALLET)\n  }\n\n  setSyncing (wallet: WalletState | null) {\n    const syncIcon = this.icons.syncing\n    if (!wallet || !wallet.running) {\n      Doc.hide(syncIcon)\n      return\n    }\n\n    if (wallet.peerCount === 0) {\n      Doc.show(this.icons.nopeers)\n      Doc.hide(syncIcon) // potentially misleading with no peers\n      return\n    }\n    Doc.hide(this.icons.nopeers)\n\n    if (!wallet.synced) {\n      Doc.show(syncIcon)\n      syncIcon.dataset.tooltip = intl.prep(intl.ID_WALLET_SYNC_PROGRESS, { syncProgress: (wallet.syncProgress * 100).toFixed(1) })\n      return\n    }\n    Doc.hide(syncIcon)\n  }\n\n  /* reads the core.Wallet state and sets the icon visibility. */\n  readWallet (wallet: WalletState | null) {\n    this.setSyncing(wallet)\n    if (!wallet) return this.nowallet()\n    switch (true) {\n      case (!wallet.running):\n        this.sleeping()\n        break\n      case (!wallet.open):\n        this.locked()\n        break\n      case (wallet.open):\n        this.unlocked()\n        break\n      default:\n        console.error('wallet in unknown state', wallet)\n    }\n  }\n}\n\n/* sleep can be used by async functions to pause for a specified period. */\nfunction sleep (ms: number) {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n\nconst aYear = 31536000000\nconst aMonth = 2592000000\nconst aDay = 86400000\nconst anHour = 3600000\nconst aMinute = 60000\n\n/* timeMod returns the quotient and remainder of t / dur. */\nfunction timeMod (t: number, dur: number) {\n  const n = Math.floor(t / dur)\n  return [n, t - n * dur]\n}\n","const darkModeCK = 'darkMode'\nconst authCK = 'dexauth'\nconst popupsCK = 'popups'\nconst pwKeyCK = 'sessionkey'\n\n// State is a set of static methods for working with the user state. It has\n// utilities for setting and retrieving cookies and storing user configuration\n// to localStorage.\nexport default class State {\n  static setCookie (cname: string, cvalue: string) {\n    const d = new Date()\n    // Set cookie to expire in ten years.\n    d.setTime(d.getTime() + (86400 * 365 * 10 * 1000))\n    const expires = 'expires=' + d.toUTCString()\n    document.cookie = cname + '=' + cvalue + ';' + expires + ';path=/'\n  }\n\n  /*\n   * getCookie returns the value at the specified cookie name, otherwise null.\n   */\n  static getCookie (cname: string) {\n    for (const cstr of document.cookie.split(';')) {\n      const [k, v] = cstr.split('=')\n      if (k.trim() === cname) return v\n    }\n    return null\n  }\n\n  /* dark sets the dark-mode cookie. */\n  static dark (dark: boolean) {\n    this.setCookie(darkModeCK, dark ? '1' : '0')\n    if (dark) {\n      document.body.classList.add('dark')\n    } else {\n      document.body.classList.remove('dark')\n    }\n  }\n\n  /*\n   * isDark returns true if the dark-mode cookie is currently set to '1' = true.\n   */\n  static isDark () {\n    return document.cookie.split(';').filter((item) => item.includes(`${darkModeCK}=1`)).length\n  }\n\n  /* passwordIsCached returns whether or not there is a cached password in the cookies. */\n  static passwordIsCached () {\n    return !!this.getCookie(pwKeyCK)\n  }\n\n  /* store puts the key-value pair into Window.localStorage. */\n  static store (k: string, v: any) {\n    window.localStorage.setItem(k, JSON.stringify(v))\n  }\n\n  /* clearAllStore remove all the key-value pair in Window.localStorage. */\n  static clearAllStore () {\n    window.localStorage.clear()\n  }\n\n  static removeAuthCK () {\n    document.cookie = `${authCK}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;`\n  }\n\n  /*\n  * fetch fetches the value associated with the key in Window.localStorage, or\n  * null if the no value exists for the key.\n  */\n  static fetch (k: string) {\n    const v = window.localStorage.getItem(k)\n    if (v !== null) {\n      return JSON.parse(v)\n    }\n    return null\n  }\n}\n\n// If the dark-mode cookie is not set, set it to dark mode on.\nif (State.getCookie(darkModeCK) === null) State.setCookie(darkModeCK, '1')\nif (State.getCookie(popupsCK) === null) State.setCookie(popupsCK, '1')\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","declare global {\n  interface Window {\n    log: (...args: any) => void\n    enableLogger: (loggerID: string, enable: boolean) => void\n    recordLogger: (loggerID: string, enable: boolean) => void\n    dumpLogger: (loggerID: string) => void\n    localeDiscrepancies: () => void\n  }\n}\n\nexport enum ConnectionStatus {\n  Disconnected = 0,\n  Connected = 1,\n  InvalidCert = 2,\n}\n\nexport interface Exchange {\n  host: string\n  acctID: string\n  markets: Record<string, Market>\n  assets: Record<number, Asset>\n  connectionStatus: ConnectionStatus\n  feeAsset: FeeAsset // DEPRECATED. DCR.\n  regFees: Record<string, FeeAsset>\n  pendingFee: PendingFeeState | null\n  candleDurs: string[]\n}\n\nexport interface Candle {\n  startStamp: number\n  endStamp: number\n  matchVolume: number\n  quoteVolume: number\n  highRate: number\n  lowRate: number\n  startRate: number\n  endRate: number\n}\n\nexport interface CandlesPayload {\n  dur: string\n  ms: number\n  candles: Candle[]\n}\n\nexport interface Market {\n  name: string\n  baseid: number\n  basesymbol: string\n  quoteid: number\n  quotesymbol: string\n  lotsize: number\n  ratestep: number\n  epochlen: number\n  startepoch: number\n  buybuffer: number\n  orders: Order[]\n  spot: Spot\n}\n\nexport interface Order {\n  host: string\n  baseID: number\n  baseSymbol: string\n  quoteID: number\n  quoteSymbol: string\n  market: string\n  type: number\n  id: string\n  stamp: number\n  submitTime: number\n  sig: string\n  status: number\n  epoch: number\n  qty: number\n  sell: boolean\n  filled: number\n  matches: Match[]\n  cancelling: boolean\n  canceled: boolean\n  feesPaid: FeeBreakdown\n  fundingCoins: Coin[]\n  accelerationCoins: Coin[]\n  lockedamt: number\n  rate: number // limit only\n  tif: number // limit only\n  targetOrderID: string // cancel only\n}\n\nexport interface Match {\n  matchID: string\n  status: number\n  active: boolean\n  revoked: boolean\n  rate: number\n  qty: number\n  side: number\n  feeRate: number\n  swap: Coin\n  counterSwap: Coin\n  redeem: Coin\n  counterRedeem: Coin\n  refund: Coin\n  stamp: number\n  isCancel: boolean\n}\n\nexport interface Spot {\n  stamp: number\n  baseID: number\n  quoteID: number\n  rate: number\n  bookVolume: number\n  change24: number\n  vol24: number\n}\n\nexport interface Asset {\n  id: number\n  symbol: string\n  version: number\n  maxFeeRate: number\n  swapSize: number\n  swapSizeBase: number\n  redeemSize: number\n  swapConf: number\n  unitInfo: UnitInfo\n}\n\nexport interface FeeAsset {\n  id: number\n  confs: number\n  amount: number\n}\n\nexport interface PendingFeeState {\n  symbol: string\n  assetID: number\n  confs: number\n}\n\nexport interface FeeBreakdown {\n  swap: number\n  redemption: number\n}\n\nexport interface SupportedAsset {\n  id: number\n  symbol: string\n  wallet: WalletState\n  info: WalletInfo\n}\n\nexport interface WalletState {\n  symbol: string\n  assetID: number\n  version: number\n  type: string\n  traits: number\n  open: boolean\n  running: boolean\n  balance: WalletBalance\n  address: string\n  units: string\n  encrypted: boolean\n  peerCount: number\n  synced: boolean\n  syncProgress: number\n}\n\nexport interface WalletInfo {\n  name: string\n  version: number\n  availablewallets: WalletDefinition[]\n  emptyidx: number\n  unitinfo: UnitInfo\n}\n\nexport interface WalletBalance {\n  available: number\n  immature: number\n  locked: number\n  stamp: string // time.Time\n  orderlocked: number\n  contractlocked: number\n}\n\nexport interface WalletDefinition {\n  seeded: boolean\n  type: string\n  tab: string\n  description: string\n  configpath: string\n  configopts: ConfigOption[]\n  noauth: boolean\n}\n\nexport interface ConfigOption {\n  key: string\n  displayname: string\n  description: string\n  default: any\n  max: any\n  min: any\n  noecho: boolean\n  isboolean: boolean\n  isdate: boolean\n  disablewhenactive: boolean\n  isBirthdayConfig: boolean\n  noauth: boolean\n}\n\nexport interface Coin {\n  id: string\n  stringID: string\n  assetID: number\n  symbol: string\n  confs: Confirmations\n}\n\nexport interface Confirmations {\n  required: number\n  count: number\n}\n\nexport interface UnitInfo {\n  atomicUnit: string\n  conventional: Denomination\n  denominations: Denomination[]\n}\n\nexport interface Denomination {\n  unit: string\n  conversionFactor: number\n}\n\nexport interface User {\n  exchanges: Record<string, Exchange>\n  inited: boolean\n  seedgentime: number\n  assets: Record<number, SupportedAsset>\n  fiatRates: Record<number, number>\n  authed: boolean // added by webserver\n  ok: boolean // added by webserver\n}\n\nexport interface CoreNote {\n  type: string\n  topic: string\n  subject: string\n  details: string\n  severity: number\n  stamp: number\n  acked: boolean\n  id: string\n}\n\nexport interface FeePaymentNote extends CoreNote {\n  asset: number\n  confirmations: number\n  dex: string\n}\n\nexport interface BalanceNote extends CoreNote {\n  assetID: number\n  balance: WalletBalance\n}\n\nexport interface RateNote extends CoreNote {\n  fiatRates: Record<number, number>\n}\n\nexport interface WalletConfigNote extends CoreNote {\n  wallet: WalletState\n}\n\nexport type WalletStateNote = WalletConfigNote\n\nexport interface SpotPriceNote extends CoreNote {\n  host: string\n  spots: Record<string, Spot>\n}\n\nexport interface MatchNote extends CoreNote {\n  orderID: string\n  match: Match\n  host: string\n  marketID: string\n}\n\nexport interface ConnEventNote extends CoreNote {\n  host: string\n  connectionStatus: ConnectionStatus\n}\n\nexport interface OrderNote extends CoreNote {\n  order: Order\n}\n\nexport interface EpochNote extends CoreNote {\n  host: string\n  marketID: string\n  epoch: number\n}\n\nexport interface APIResponse {\n  requestSuccessful: boolean\n  ok: boolean\n  msg: string\n  err?: string\n}\n\nexport interface LogMessage {\n  time: string\n  msg: string\n}\n\nexport interface NoteElement extends HTMLElement {\n  note: CoreNote\n}\n\nexport interface BalanceResponse extends APIResponse {\n  balance: WalletBalance\n}\n\nexport interface LayoutMetrics {\n  bodyTop: number\n  bodyLeft: number\n  width: number\n  height: number\n  centerX: number\n  centerY: number\n}\n\nexport interface PasswordCache {\n  pw: string\n}\n\nexport interface PageElement extends HTMLElement {\n  value?: string\n  src?: string\n  files?: FileList\n  checked?: boolean\n  href?: string\n  htmlFor?: string\n}\n\nexport interface BooleanConfig {\n  reason: string\n}\n\nexport interface XYRangePoint {\n  label: string\n  x: number\n  y: number\n}\n\nexport interface XYRange {\n  start: XYRangePoint\n  end: XYRangePoint\n  xUnit: string\n  yUnit: string\n}\n\nexport interface OrderOption extends ConfigOption {\n  boolean: BooleanConfig\n  xyRange: XYRange\n}\n\nexport interface SwapEstimate {\n  lots: number\n  value: number\n  maxFees: number\n  realisticWorstCase: number\n  realisticBestCase: number\n}\n\nexport interface RedeemEstimate {\n  realisticBestCase: number\n  realisticWorstCase: number\n}\n\nexport interface PreSwap {\n  estimate: SwapEstimate\n  options: OrderOption[]\n}\n\nexport interface PreRedeem {\n  estimate: RedeemEstimate\n  options: OrderOption[]\n}\n\nexport interface OrderEstimate {\n  swap: PreSwap\n  redeem: PreRedeem\n}\n\nexport interface MaxOrderEstimate {\n  swap: SwapEstimate\n  redeem: RedeemEstimate\n}\n\nexport interface MaxSell {\n  maxSell: MaxOrderEstimate\n}\n\nexport interface MaxBuy {\n  maxBuy: MaxOrderEstimate\n}\n\nexport interface TradeForm {\n  host: string\n  isLimit: boolean\n  sell: boolean\n  base: number\n  quote: number\n  qty: number\n  rate: number\n  tifnow: boolean\n  options: Record<string, any>\n}\n\nexport interface BookUpdate {\n  action: string\n  host: string\n  marketID: string\n  payload: any\n}\n\nexport interface MiniOrder {\n  qty: number\n  qtyAtomic: number\n  rate: number\n  msgRate: number\n  epoch: number\n  sell: boolean\n  token: string\n}\n\nexport interface CoreOrderBook {\n  sells: MiniOrder[]\n  buys: MiniOrder[]\n  epoch: MiniOrder[]\n}\n\nexport interface MarketOrderBook {\n  base: number\n  quote: number\n  book: CoreOrderBook\n}\n\nexport interface RemainderUpdate {\n  token: string\n  qty: number\n  qtyAtomic: number\n}\n\nexport interface OrderFilter {\n  n?: number\n  offset?: string\n  hosts: string[]\n  assets: number[]\n  statuses: number[]\n}\n\nexport interface Application {\n  assets: Record<number, SupportedAsset>\n  seedGenTime: number\n  user: User\n  header: HTMLElement\n  walletMap: Record<number, WalletState>\n  exchanges: Record<string, Exchange>\n  fiatRatesMap: Record<number, number>\n  showPopups: boolean\n  commitHash: string\n  start (): Promise<void>\n  reconnected (): void\n  fetchUser (): Promise<User | void>\n  loadPage (page: string, data?: any, skipPush?: boolean): Promise<boolean>\n  attach (data: any): void\n  bindTooltips (ancestor: HTMLElement): void\n  attachHeader (): void\n  showDropdown (icon: HTMLElement, dialog: HTMLElement): void\n  ackNotes (): void\n  setNoteTimes (noteList: HTMLElement): void\n  bindInternalNavigation (ancestor: HTMLElement): void\n  storeNotes (): void\n  updateMenuItemsDisplay (): void\n  attachCommon (node: HTMLElement): void\n  updateExchangeRegistration (dexAddr: string, confs: number, assetID: number): void\n  handleFeePaymentNote (note: FeePaymentNote): void\n  setNotes (notes: CoreNote[]): void\n  notify (note: CoreNote): void\n  log (loggerID: string, ...msg: any): void\n  prependPokeElement (note: CoreNote): void\n  prependNoteElement (note: CoreNote, skipSave?: boolean): void\n  prependListElement (noteList: HTMLElement, note: CoreNote, el: NoteElement): void\n  loading (el: HTMLElement): () => void\n  orders (host: string, mktID: string): Order[]\n  haveAssetOrders (assetID: number): boolean\n  walletIsActive (assetID: number): boolean\n  order (oid: string): Order | null\n  canAccelerateOrder(order: Order): boolean\n  unitInfo (assetID: number, xc?: Exchange): UnitInfo\n  conventionalRate (baseID: number, quoteID: number, encRate: number): number\n  walletDefinition (assetID: number, walletType: string): WalletDefinition\n  currentWalletDefinition (assetID: number): WalletDefinition\n  fetchBalance (assetID: number): Promise<WalletBalance>\n  checkResponse (resp: APIResponse, skipNote?: boolean): boolean\n  signOut (): Promise<void>\n  registerNoteFeeder (receivers: Record<string, (n: CoreNote) => void>): void\n}\n\n// TODO: Define an interface for Application?\nlet application: Application\n\nexport function registerApplication (a: Application) {\n  application = a\n}\n\nexport function app (): Application {\n  return application\n}\n","export default class BasePage {\n  /* unload is called when the user navigates away from the page. */\n  unload () {\n    // should be implemented by inheriting class.\n  }\n}\n","/*\n * requestJSON encodes the object and sends the JSON to the specified address.\n */\nexport async function requestJSON (method: string, addr: string, reqBody?: any): Promise<any> {\n  try {\n    const response = await window.fetch(addr, {\n      method: method,\n      headers: new window.Headers({ 'content-type': 'application/json' }),\n      // credentials: \"same-origin\",\n      body: reqBody\n    })\n    if (response.status !== 200) { throw response }\n    const obj = await response.json()\n    obj.requestSuccessful = true\n    return obj\n  } catch (response) {\n    response.requestSuccessful = false\n    response.msg = await response.text()\n    return response\n  }\n}\n\n/*\n * postJSON sends a POST request with JSON-formatted data and returns the\n * response.\n */\nexport async function postJSON (addr: string, data?: any) {\n  return requestJSON('POST', addr, JSON.stringify(data))\n}\n\n/*\n * getJSON sends a GET request and returns the response.\n */\nexport async function getJSON (addr: string): Promise<any> {\n  return requestJSON('GET', addr)\n}\n","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import Doc from './doc'\nimport * as intl from './locales'\nimport {\n  app,\n  Order,\n  TradeForm,\n  PageElement,\n  OrderOption as OrderOpt,\n  Match,\n  XYRange\n} from './registry'\n\nexport const Limit = 1\nexport const Market = 2\nexport const CANCEL = 3\n\n/* The time-in-force specifiers are a mirror of dex/order.TimeInForce. */\nexport const ImmediateTiF = 0\nexport const StandingTiF = 1\n\n/* The order statuses are a mirror of dex/order.OrderStatus. */\nexport const StatusUnknown = 0\nexport const StatusEpoch = 1\nexport const StatusBooked = 2\nexport const StatusExecuted = 3\nexport const StatusCanceled = 4\nexport const StatusRevoked = 5\n\n/* The match statuses are a mirror of dex/order.MatchStatus. */\nexport const NewlyMatched = 0\nexport const MakerSwapCast = 1\nexport const TakerSwapCast = 2\nexport const MakerRedeemed = 3\nexport const MatchComplete = 4\n\n/* The match sides are a mirror of dex/order.MatchSide. */\nexport const Maker = 0\nexport const Taker = 1\n\n/*\n * RateEncodingFactor is used when encoding an atomic exchange rate as an\n * integer. See docs on message-rate encoding @\n * https://github.com/decred/dcrdex/blob/master/spec/comm.mediawiki#Rate_Encoding\n */\nexport const RateEncodingFactor = 1e8\n\nexport function sellString (ord: Order) { return ord.sell ? 'sell' : 'buy' }\nexport function typeString (ord: Order) { return ord.type === Limit ? (ord.tif === ImmediateTiF ? 'limit (i)' : 'limit') : 'market' }\n\n/* isMarketBuy will return true if the order is a market buy order. */\nexport function isMarketBuy (ord: Order) {\n  return ord.type === Market && !ord.sell\n}\n\n/*\n * hasLiveMatches returns true if the order has matches that have not completed\n * settlement yet.\n */\nexport function hasLiveMatches (order: Order) {\n  if (!order.matches) return false\n  for (const match of order.matches) {\n    if (!match.revoked && match.status < MakerRedeemed) return true\n  }\n  return false\n}\n\n/* statusString converts the order status to a string */\nexport function statusString (order: Order): string {\n  const isLive = hasLiveMatches(order)\n  switch (order.status) {\n    case StatusUnknown: return intl.prep(intl.ID_UNKNOWN)\n    case StatusEpoch: return intl.prep(intl.ID_EPOCH)\n    case StatusBooked:\n      if (order.cancelling) return intl.prep(intl.ID_CANCELING)\n      return isLive ? `${intl.prep(intl.ID_BOOKED)}/${intl.prep(intl.ID_SETTLING)}` : intl.prep(intl.ID_BOOKED)\n    case StatusExecuted:\n      if (isLive) return intl.prep(intl.ID_SETTLING)\n      return (order.filled === 0) ? intl.prep(intl.ID_NO_MATCH) : intl.prep(intl.ID_EXECUTED)\n    case StatusCanceled:\n      return isLive ? `${intl.prep(intl.ID_CANCELED)}/${intl.prep(intl.ID_SETTLING)}` : intl.prep(intl.ID_CANCELED)\n    case StatusRevoked:\n      return isLive ? `${intl.prep(intl.ID_REVOKED)}/${intl.prep(intl.ID_SETTLING)}` : intl.prep(intl.ID_REVOKED)\n  }\n  return ''\n}\n\n/* filled sums the quantities of non-cancel matches available. */\nexport function filled (order: Order) {\n  if (!order.matches) return 0\n  const qty = isMarketBuy(order) ? (m: Match) => m.qty * m.rate / RateEncodingFactor : (m: Match) => m.qty\n  return order.matches.reduce((filled, match) => {\n    if (match.isCancel) return filled\n    return filled + qty(match)\n  }, 0)\n}\n\n/* settled sums the quantities of the matches that have completed. */\nexport function settled (order: Order) {\n  if (!order.matches) return 0\n  const qty = isMarketBuy(order) ? (m: Match) => m.qty * m.rate / RateEncodingFactor : (m: Match) => m.qty\n  return order.matches.reduce((settled, match) => {\n    if (match.isCancel) return settled\n    const redeemed = (match.side === Maker && match.status >= MakerRedeemed) ||\n      (match.side === Taker && match.status >= MatchComplete)\n    return redeemed ? settled + qty(match) : settled\n  }, 0)\n}\n\n/*\n * matchStatusString is a string used to create a displayable string describing\n * describing the match status.\n */\nexport function matchStatusString (m: Match) {\n  if (m.revoked) {\n    // When revoked, match status is less important than pending action if still\n    // active, or the outcome if inactive.\n    if (m.active) {\n      return 'Revoked - Refund PENDING' // auto-redeem also possible, but action is pending\n    }\n    if (m.refund) {\n      return 'Revoked - Refunded'\n    }\n    if (m.redeem) {\n      return 'Revoked - Redeemed'\n    }\n    return 'Revoked - Complete'\n  }\n\n  switch (m.status) {\n    case NewlyMatched:\n      return '(0 / 4) Newly Matched'\n    case MakerSwapCast:\n      return '(1 / 4) First Swap Sent'\n    case TakerSwapCast:\n      return '(2 / 4) Second Swap Sent'\n    case MakerRedeemed:\n      if (m.side === Maker) {\n        return 'Match Complete'\n      }\n      return '(3 / 4) Maker Redeemed'\n    case MatchComplete:\n      return 'Match Complete'\n  }\n  return 'Unknown Match Status'\n}\n\n// Having the caller set these vars on load using an exported function makes\n// life easier.\nlet orderOptTmpl: HTMLElement, booleanOptTmpl: HTMLElement, rangeOptTmpl: HTMLElement\n\n// setOptionTemplates sets the package vars for the templates and application.\nexport function setOptionTemplates (page: Record<string, PageElement>) {\n  [booleanOptTmpl, rangeOptTmpl, orderOptTmpl] = [page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl]\n}\n\ninterface OptionsReporters {\n  enable: () => void\n  disable: () => void\n}\n\n/*\n * OrderOption is a base class for option elements. OrderOptions stores some\n * common parameters and monitors the toggle switch, calling the child class's\n * enable/disable methods when the user manually turns the option on or off.\n */\nclass OrderOption {\n  opt: OrderOpt\n  order: TradeForm\n  node: HTMLElement\n  tmpl: Record<string, PageElement>\n  on: boolean\n\n  constructor (opt: OrderOpt, order: TradeForm, isSwapOption: boolean, report: OptionsReporters) {\n    this.opt = opt\n    this.order = order\n    const node = this.node = orderOptTmpl.cloneNode(true) as HTMLElement\n    const tmpl = this.tmpl = Doc.parseTemplate(node)\n    tmpl.optName.textContent = opt.displayname\n    tmpl.tooltip.dataset.tooltip = opt.description\n\n    const isBaseChain = (isSwapOption && order.sell) || (!isSwapOption && !order.sell)\n    const symbol = isBaseChain ? this.baseSymbol() : this.quoteSymbol()\n    tmpl.chainIcon.src = Doc.logoPath(symbol)\n\n    this.on = false\n    Doc.bind(node, 'click', () => {\n      if (this.on) return\n      this.on = true\n      node.classList.add('selected')\n      report.enable()\n    })\n    Doc.bind(tmpl.toggle, 'click', e => {\n      if (!this.on) return\n      e.stopPropagation()\n      this.on = false\n      node.classList.remove('selected')\n      report.disable()\n    })\n  }\n\n  quoteSymbol () {\n    return dexAssetSymbol(this.order.host, this.order.quote)\n  }\n\n  baseSymbol () {\n    return dexAssetSymbol(this.order.host, this.order.base)\n  }\n}\n\n/*\n * BooleanOrderOption is a simple on/off option with a short summary of it's\n * effects. BooleanOrderOption is the handler for a *BooleanConfig from\n * client/asset.\n */\nclass BooleanOrderOption extends OrderOption {\n  control: HTMLElement\n  changed: () => void\n\n  constructor (opt: OrderOpt, order: TradeForm, changed: () => void, isSwapOption: boolean) {\n    super(opt, order, isSwapOption, {\n      enable: () => this.enable(),\n      disable: () => this.disable()\n    })\n    this.changed = () => changed()\n    const cfg = opt.boolean\n    const control = this.control = booleanOptTmpl.cloneNode(true) as HTMLElement\n    // Append to parent's options div.\n    this.tmpl.controls.appendChild(control)\n    const tmpl = Doc.parseTemplate(control)\n    tmpl.reason.textContent = cfg.reason\n    this.on = typeof order.options[opt.key] !== 'undefined' ? order.options[opt.key] : opt.default\n    if (this.on) this.node.classList.add('selected')\n  }\n\n  store () {\n    if (this.on === this.opt.default) delete this.order.options[this.opt.key]\n    else this.order.options[this.opt.key] = this.on\n    this.changed()\n  }\n\n  enable () {\n    this.store()\n  }\n\n  disable () {\n    this.store()\n  }\n}\n\n/*\n * XYRangeOrderOption is an order option that contains an XYRangeHandler.\n * The logic for handling the slider to is defined in XYRangeHandler so\n * that the slider can be used without being contained in an order option.\n */\nclass XYRangeOrderOption extends OrderOption {\n  handler: XYRangeHandler\n  x: number\n  changed: () => void\n\n  constructor (opt: OrderOpt, order: TradeForm, changed: () => void, isSwapOption: boolean) {\n    super(opt, order, isSwapOption, {\n      enable: () => this.enable(),\n      disable: () => this.disable()\n    })\n    this.changed = changed\n    const cfg = opt.xyRange\n    const setVal = order.options[opt.key]\n    this.on = typeof setVal !== 'undefined'\n    if (this.on) {\n      this.node.classList.add('selected')\n      this.x = setVal\n    } else {\n      this.x = opt.default\n    }\n    const onUpdate = (x: number) => {\n      this.x = x\n      this.order.options[this.opt.key] = x\n    }\n    const onChange = () => { this.changed() }\n    const selected = () => { this.node.classList.add('selected') }\n    this.handler = new XYRangeHandler(cfg, this.x, onUpdate, onChange, selected)\n    this.tmpl.controls.appendChild(this.handler.control)\n  }\n\n  enable () {\n    this.order.options[this.opt.key] = this.x\n    this.changed()\n  }\n\n  disable () {\n    delete this.order.options[this.opt.key]\n    this.changed()\n  }\n}\n\n/*\n * XYRangeHandler is the handler for an *XYRange from client/asset. XYRange\n * has a slider which allows adjusting the x and y, linearly between two limits.\n * The user can also manually enter values for x or y.\n */\nexport class XYRangeHandler {\n  control: HTMLElement\n  x: number\n  updated: (x:number, y:number) => void\n  changed: () => void\n  selected: () => void\n\n  constructor (cfg: XYRange, initVal: number, updated: (x:number, y:number) => void, changed: () => void, selected: () => void, roundY?: boolean) {\n    const control = this.control = rangeOptTmpl.cloneNode(true) as HTMLElement\n    const tmpl = Doc.parseTemplate(control)\n\n    this.changed = changed\n    this.selected = selected\n    this.updated = updated\n\n    const { slider, handle } = tmpl\n\n    const rangeX = cfg.end.x - cfg.start.x\n    const rangeY = cfg.end.y - cfg.start.y\n    const normalizeX = (x: number) => (x - cfg.start.x) / rangeX\n\n    // r, x, and y will be updated by the various input event handlers. r is\n    // x (or y) normalized on its range, e.g. [x_min, x_max] -> [0, 1]\n    let r = normalizeX(initVal)\n    let x = this.x = initVal\n    let y = r * rangeY + cfg.start.y\n\n    const number = new Intl.NumberFormat((navigator.languages as string[]), {\n      minimumSignificantDigits: 3,\n      maximumSignificantDigits: 3\n    })\n\n    // accept needs to be called anytime a handler updates x, y, and r.\n    const accept = (skipUpdate?: boolean) => {\n      if (roundY) y = Math.round(y)\n      tmpl.x.textContent = number.format(x)\n      tmpl.y.textContent = number.format(y)\n      if (roundY) tmpl.y.textContent = `${y}`\n      handle.style.left = `calc(${r * 100}% - ${r * 14}px)`\n      this.x = x\n      if (!skipUpdate) this.updated(x, y)\n    }\n\n    // Set up the handlers for the x and y text input fields.\n    const clickOutX = (e: MouseEvent) => {\n      if (e.type !== 'change' && e.target === tmpl.xInput) return\n      const s = tmpl.xInput.value\n      if (s) {\n        const xx = parseFloat(s)\n        if (!isNaN(xx)) {\n          x = clamp(xx, cfg.start.x, cfg.end.x)\n          r = normalizeX(x)\n          y = r * rangeY + cfg.start.y\n          accept()\n        }\n      }\n      Doc.hide(tmpl.xInput)\n      Doc.show(tmpl.x)\n      Doc.unbind(document, 'click', clickOutX)\n      this.changed()\n    }\n\n    Doc.bind(tmpl.x, 'click', e => {\n      Doc.hide(tmpl.x)\n      Doc.show(tmpl.xInput)\n      tmpl.xInput.focus()\n      tmpl.xInput.value = number.format(x)\n      Doc.bind(document, 'click', clickOutX)\n      e.stopPropagation()\n    })\n\n    Doc.bind(tmpl.xInput, 'change', clickOutX)\n\n    const clickOutY = (e: MouseEvent) => {\n      if (e.type !== 'change' && e.target === tmpl.yInput) return\n      const s = tmpl.yInput.value\n      if (s) {\n        const yy = parseFloat(s)\n        if (!isNaN(yy)) {\n          y = clamp(yy, cfg.start.y, cfg.end.y)\n          r = (y - cfg.start.y) / rangeY\n          x = cfg.start.x + r * rangeX\n          accept()\n        }\n      }\n      Doc.hide(tmpl.yInput)\n      Doc.show(tmpl.y)\n      Doc.unbind(document, 'click', clickOutY)\n      this.changed()\n    }\n\n    Doc.bind(tmpl.y, 'click', e => {\n      Doc.hide(tmpl.y)\n      Doc.show(tmpl.yInput)\n      tmpl.yInput.focus()\n      tmpl.yInput.value = number.format(y)\n      Doc.bind(document, 'click', clickOutY)\n      e.stopPropagation()\n    })\n\n    Doc.bind(tmpl.yInput, 'change', clickOutY)\n\n    // Read the slider.\n    Doc.bind(handle, 'mousedown', (e: MouseEvent) => {\n      if (e.button !== 0) return\n      e.preventDefault()\n      this.selected()\n      const startX = e.pageX\n      const w = slider.clientWidth - handle.offsetWidth\n      const startLeft = normalizeX(x) * w\n      const left = (ee: MouseEvent) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0)\n      const trackMouse = (ee: MouseEvent) => {\n        ee.preventDefault()\n        r = left(ee) / w\n        x = r * rangeX + cfg.start.x\n        y = r * rangeY + cfg.start.y\n        accept()\n      }\n      const mouseUp = (ee: MouseEvent) => {\n        trackMouse(ee)\n        Doc.unbind(document, 'mousemove', trackMouse)\n        Doc.unbind(document, 'mouseup', mouseUp)\n        this.changed()\n      }\n      Doc.bind(document, 'mousemove', trackMouse)\n      Doc.bind(document, 'mouseup', mouseUp)\n    })\n\n    tmpl.rangeLblStart.textContent = cfg.start.label\n    tmpl.rangeLblEnd.textContent = cfg.end.label\n    tmpl.xUnit.textContent = cfg.xUnit\n    tmpl.yUnit.textContent = cfg.yUnit\n    accept(true)\n  }\n}\n\n/*\n * optionElement is a getter for an element matching the *OrderOption from\n * client/asset. change is a function with no arguments that is called when the\n * returned option's value has changed.\n */\nexport function optionElement (opt: OrderOpt, order: TradeForm, change: () => void, isSwap: boolean): HTMLElement {\n  switch (true) {\n    case !!opt.boolean:\n      return new BooleanOrderOption(opt, order, change, isSwap).node\n    case !!opt.xyRange:\n      return new XYRangeOrderOption(opt, order, change, isSwap).node\n    default:\n      console.error('no option type specified', opt)\n  }\n  console.error('unknown option type', opt)\n  return document.createElement('div')\n}\n\nfunction dexAssetSymbol (host: string, assetID: number) {\n  return app().exchanges[host].assets[assetID].symbol\n}\n\nconst clamp = (v: number, min: number, max: number) => v < min ? min : v > max ? max : v\n","import Doc from './doc'\nimport { postJSON } from './http'\nimport State from './state'\nimport * as intl from './locales'\nimport * as OrderUtil from './orderutil'\nimport {\n  app,\n  PasswordCache,\n  SupportedAsset,\n  PageElement,\n  WalletDefinition,\n  ConfigOption,\n  Exchange,\n  Market,\n  UnitInfo,\n  FeeAsset,\n  WalletState,\n  WalletBalance,\n  BalanceNote,\n  Order,\n  XYRange,\n  WalletStateNote\n} from './registry'\n\ninterface ConfigOptionInput extends HTMLInputElement {\n  configOpt: ConfigOption\n}\n\ninterface ProgressPoint {\n  stamp: number\n  progress: number\n}\n\n/*\n * NewWalletForm should be used with the \"newWalletForm\" template. The enclosing\n * <form> element should be the second argument of the constructor.\n */\nexport class NewWalletForm {\n  page: Record<string, PageElement>\n  form: HTMLElement\n  pwCache: PasswordCache | null\n  success: (assetID: number) => void\n  currentAsset: SupportedAsset\n  pwHiders: HTMLElement[]\n  subform: WalletConfigForm\n  currentWalletType: string\n\n  constructor (form: HTMLElement, success: (assetID: number) => void, pwCache?: PasswordCache, backFunc?: () => void) {\n    this.form = form\n    this.success = success\n    this.pwCache = pwCache || null\n    const page = this.page = Doc.parseTemplate(form)\n    this.pwHiders = Array.from(form.querySelectorAll('.hide-pw'))\n    this.refresh()\n\n    if (backFunc) {\n      Doc.show(page.goBack)\n      Doc.bind(page.goBack, 'click', () => { backFunc() })\n    }\n\n    Doc.empty(page.walletTabTmpl)\n    page.walletTabTmpl.removeAttribute('id')\n\n    // WalletConfigForm will set the global app variable.\n    this.subform = new WalletConfigForm(page.walletSettings, true)\n\n    Doc.bind(this.subform.showOther, 'click', () => Doc.show(page.walletSettingsHeader))\n\n    bind(form, page.submitAdd, () => this.submit())\n    bind(form, page.oneBttn, () => this.submit())\n  }\n\n  refresh () {\n    const hidePWBox = State.passwordIsCached() || (this.pwCache && this.pwCache.pw)\n    if (hidePWBox) Doc.hide(...this.pwHiders)\n    else Doc.show(...this.pwHiders)\n  }\n\n  async submit () {\n    const page = this.page\n    const appPass = page.appPass as HTMLInputElement\n    const newWalletPass = page.newWalletPass as HTMLInputElement\n    const pw = appPass.value || (this.pwCache ? this.pwCache.pw : '')\n    if (!pw && !State.passwordIsCached()) {\n      page.newWalletErr.textContent = intl.prep(intl.ID_NO_APP_PASS_ERROR_MSG)\n      Doc.show(page.newWalletErr)\n      return\n    }\n    Doc.hide(page.newWalletErr)\n    const assetID = this.currentAsset.id\n    const createForm = {\n      assetID: assetID,\n      pass: newWalletPass.value || '',\n      config: this.subform.map(),\n      appPass: pw,\n      walletType: this.currentWalletType\n    }\n    appPass.value = ''\n    const loaded = app().loading(page.mainForm)\n    const res = await postJSON('/api/newwallet', createForm)\n    loaded()\n    if (!app().checkResponse(res)) {\n      this.setError(res.msg)\n      return\n    }\n    if (this.pwCache) this.pwCache.pw = pw\n    newWalletPass.value = ''\n    this.success(assetID)\n  }\n\n  async setAsset (assetID: number) {\n    const page = this.page\n    const asset = app().assets[assetID]\n    const tabs = page.walletTypeTabs\n    if (this.currentAsset && this.currentAsset.id === asset.id) return\n    this.currentAsset = asset\n    page.assetLogo.src = Doc.logoPath(asset.symbol)\n    page.assetName.textContent = asset.info.name\n    page.newWalletPass.value = ''\n\n    if (asset.info.availablewallets.length > 1) page.header.classList.add('bordertop')\n    else page.header.classList.remove('bordertop')\n\n    const walletDef = asset.info.availablewallets[0]\n    Doc.empty(tabs)\n    Doc.hide(tabs, page.newWalletErr)\n\n    if (asset.info.availablewallets.length > 1) {\n      Doc.show(tabs)\n      for (const wDef of asset.info.availablewallets) {\n        const tab = page.walletTabTmpl.cloneNode(true) as HTMLElement\n        tab.dataset.tooltip = wDef.description\n        tab.textContent = wDef.tab\n        tabs.appendChild(tab)\n        Doc.bind(tab, 'click', () => {\n          for (const t of Doc.kids(tabs)) t.classList.remove('selected')\n          tab.classList.add('selected')\n          this.update(wDef)\n        })\n      }\n      app().bindTooltips(tabs)\n      const first = tabs.firstChild as HTMLElement\n      first.classList.add('selected')\n    }\n\n    await this.update(walletDef)\n  }\n\n  async update (walletDef: WalletDefinition) {\n    const page = this.page\n    this.currentWalletType = walletDef.type\n    const appPwCached = State.passwordIsCached() || (this.pwCache && this.pwCache.pw)\n    Doc.hide(page.auth, page.oneBttnBox, page.newWalletPassBox)\n    const configOpts = walletDef.configopts || []\n    // If a config represents a wallet's birthday, we update the default\n    // selection to the current date if this installation of the client\n    // generated a seed.\n    configOpts.map((opt) => {\n      if (opt.isBirthdayConfig && app().seedGenTime > 0) {\n        opt.default = toUnixDate(new Date())\n      }\n      return opt\n    })\n    if (appPwCached && walletDef.seeded) {\n      Doc.show(page.oneBttnBox)\n    } else if (walletDef.seeded) {\n      Doc.show(page.auth)\n      page.newWalletPass.value = ''\n      page.submitAdd.textContent = intl.prep(intl.ID_CREATE)\n    } else {\n      Doc.show(page.auth)\n      if (!walletDef.noauth) Doc.show(page.newWalletPassBox)\n      page.submitAdd.textContent = intl.prep(intl.ID_ADD)\n    }\n\n    this.subform.update(configOpts)\n\n    if (this.subform.dynamicOpts.children.length) Doc.show(page.walletSettingsHeader)\n    else Doc.hide(page.walletSettingsHeader)\n\n    this.refresh()\n    await this.loadDefaults()\n  }\n\n  /* setError sets and shows the in-form error message. */\n  async setError (errMsg: string) {\n    this.page.newWalletErr.textContent = errMsg\n    Doc.show(this.page.newWalletErr)\n  }\n\n  /*\n   * loadDefaults attempts to load the ExchangeWallet configuration from the\n   * default wallet config path on the server and will auto-fill the page on\n   * the subform if settings are found.\n   */\n  async loadDefaults () {\n    // No default config files for seeded assets right now.\n    const walletDef = app().walletDefinition(this.currentAsset.id, this.currentWalletType)\n    if (walletDef.seeded) return\n    if (walletDef.configpath === '') return\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/defaultwalletcfg', {\n      assetID: this.currentAsset.id,\n      type: this.currentWalletType\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      this.setError(res.msg)\n      return\n    }\n    this.subform.setLoadedConfig(res.config)\n  }\n}\n\n/*\n * WalletConfigForm is a dynamically generated sub-form for setting\n * asset-specific wallet configuration options.\n*/\nexport class WalletConfigForm {\n  form: HTMLElement\n  configElements: Record<string, HTMLElement>\n  configOpts: ConfigOption[]\n  sectionize: boolean\n  allSettings: PageElement\n  dynamicOpts: PageElement\n  textInputTmpl: PageElement\n  dateInputTmpl: PageElement\n  checkboxTmpl: PageElement\n  fileSelector: PageElement\n  fileInput: PageElement\n  errMsg: PageElement\n  showOther: PageElement\n  showIcon: PageElement\n  hideIcon: PageElement\n  showHideMsg: PageElement\n  otherSettings: PageElement\n  loadedSettingsMsg: PageElement\n  loadedSettings: PageElement\n  defaultSettingsMsg: PageElement\n  defaultSettings: PageElement\n\n  constructor (form: HTMLElement, sectionize: boolean) {\n    this.form = form\n    // A configElement is a div containing an input and its label.\n    this.configElements = {}\n    // configOpts is the wallet options provided by core.\n    this.configOpts = []\n    this.sectionize = sectionize\n\n    // Get template elements\n    this.allSettings = Doc.tmplElement(form, 'allSettings')\n    this.dynamicOpts = Doc.tmplElement(form, 'dynamicOpts')\n    this.textInputTmpl = Doc.tmplElement(form, 'textInput')\n    this.textInputTmpl.remove()\n    this.dateInputTmpl = Doc.tmplElement(form, 'dateInput')\n    this.dateInputTmpl.remove()\n    this.checkboxTmpl = Doc.tmplElement(form, 'checkbox')\n    this.checkboxTmpl.remove()\n    this.fileSelector = Doc.tmplElement(form, 'fileSelector')\n    this.fileInput = Doc.tmplElement(form, 'fileInput')\n    this.errMsg = Doc.tmplElement(form, 'errMsg')\n    this.showOther = Doc.tmplElement(form, 'showOther')\n    this.showIcon = Doc.tmplElement(form, 'showIcon')\n    this.hideIcon = Doc.tmplElement(form, 'hideIcon')\n    this.showHideMsg = Doc.tmplElement(form, 'showHideMsg')\n    this.otherSettings = Doc.tmplElement(form, 'otherSettings')\n    this.loadedSettingsMsg = Doc.tmplElement(form, 'loadedSettingsMsg')\n    this.loadedSettings = Doc.tmplElement(form, 'loadedSettings')\n    this.defaultSettingsMsg = Doc.tmplElement(form, 'defaultSettingsMsg')\n    this.defaultSettings = Doc.tmplElement(form, 'defaultSettings')\n\n    if (!sectionize) Doc.hide(this.showOther)\n\n    Doc.bind(this.fileSelector, 'click', () => this.fileInput.click())\n\n    // config file upload\n    Doc.bind(this.fileInput, 'change', async () => this.fileInputChanged())\n\n    Doc.bind(this.showOther, 'click', () => {\n      this.setOtherSettingsViz(this.hideIcon.classList.contains('d-hide'))\n    })\n  }\n\n  /*\n   * fileInputChanged will read the selected file and attempt to load the\n   * configuration settings. All loaded settings will be made visible for\n   * inspection by the user.\n   */\n  async fileInputChanged () {\n    Doc.hide(this.errMsg)\n    if (!this.fileInput.value) return\n    const files = this.fileInput.files\n    if (!files || files.length === 0) return\n    const loaded = app().loading(this.form)\n    const config = await files[0].text()\n    if (!config) return\n    const res = await postJSON('/api/parseconfig', {\n      configtext: config\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      this.errMsg.textContent = res.msg\n      Doc.show(this.errMsg)\n      return\n    }\n    if (Object.keys(res.map).length === 0) return\n    this.dynamicOpts.append(...this.setConfig(res.map))\n    this.reorder(this.dynamicOpts)\n    const [loadedOpts, defaultOpts] = [this.loadedSettings.children.length, this.defaultSettings.children.length]\n    if (loadedOpts === 0) Doc.hide(this.loadedSettings, this.loadedSettingsMsg)\n    if (defaultOpts === 0) Doc.hide(this.defaultSettings, this.defaultSettingsMsg)\n    if (loadedOpts + defaultOpts === 0) Doc.hide(this.showOther, this.otherSettings)\n  }\n\n  /*\n   * update creates the dynamic form.\n   */\n  update (configOpts: ConfigOption[], walletIsActive?: boolean) {\n    this.configElements = {}\n    this.configOpts = configOpts\n    Doc.empty(this.dynamicOpts, this.defaultSettings, this.loadedSettings)\n\n    // If there are no options, just hide the entire form.\n    if (configOpts.length === 0) return Doc.hide(this.form)\n    Doc.show(this.form)\n\n    this.setOtherSettingsViz(false)\n    Doc.hide(\n      this.loadedSettingsMsg, this.loadedSettings, this.defaultSettingsMsg,\n      this.defaultSettings, this.errMsg\n    )\n    const defaultedOpts = []\n    const addOpt = (box: HTMLElement, opt: ConfigOption) => {\n      const elID = 'wcfg-' + opt.key\n      let el: HTMLElement\n      if (opt.isboolean) el = this.checkboxTmpl.cloneNode(true) as HTMLElement\n      else if (opt.isdate) el = this.dateInputTmpl.cloneNode(true) as HTMLElement\n      else el = this.textInputTmpl.cloneNode(true) as HTMLElement\n      this.configElements[opt.key] = el\n      const input = el.querySelector('input') as ConfigOptionInput\n      input.id = elID\n      input.configOpt = opt\n      const label = Doc.safeSelector(el, 'label')\n      label.htmlFor = elID // 'for' attribute, but 'for' is a keyword\n      label.prepend(opt.displayname)\n      box.appendChild(el)\n      if (opt.noecho) input.type = 'password'\n      if (opt.description) label.dataset.tooltip = opt.description\n      if (opt.isboolean) input.checked = opt.default\n      else if (opt.isdate) {\n        const getMinMaxVal = (minMax: string | number) => {\n          if (!minMax) return ''\n          if (minMax === 'now') return dateToString(new Date())\n          return dateToString(new Date((minMax as number) * 1000))\n        }\n        input.max = getMinMaxVal(opt.max)\n        input.min = getMinMaxVal(opt.min)\n        input.valueAsDate = opt.default ? new Date(opt.default * 1000) : new Date()\n      } else input.value = opt.default !== null ? opt.default : ''\n      input.disabled = Boolean(opt.disablewhenactive && walletIsActive)\n    }\n    for (const opt of this.configOpts) {\n      if (this.sectionize && opt.default !== null) defaultedOpts.push(opt)\n      else addOpt(this.dynamicOpts, opt)\n    }\n    if (defaultedOpts.length) {\n      for (const opt of defaultedOpts) {\n        addOpt(this.defaultSettings, opt)\n      }\n      Doc.show(this.showOther, this.defaultSettingsMsg, this.defaultSettings)\n    } else {\n      Doc.hide(this.showOther)\n    }\n    app().bindTooltips(this.allSettings)\n    if (this.dynamicOpts.children.length) Doc.show(this.dynamicOpts)\n    else Doc.hide(this.dynamicOpts)\n  }\n\n  /*\n   * setOtherSettingsViz sets the visibility of the additional settings section.\n   */\n  setOtherSettingsViz (visible: boolean) {\n    if (visible) {\n      Doc.hide(this.showIcon)\n      Doc.show(this.hideIcon, this.otherSettings)\n      this.showHideMsg.textContent = intl.prep(intl.ID_HIDE_ADDITIONAL_SETTINGS)\n      return\n    }\n    Doc.hide(this.hideIcon, this.otherSettings)\n    Doc.show(this.showIcon)\n    this.showHideMsg.textContent = intl.prep(intl.ID_SHOW_ADDITIONAL_SETTINGS)\n  }\n\n  /*\n   * setConfig looks for inputs with configOpt keys matching the cfg object, and\n   * sets the inputs value to the corresponding cfg value. A list of matching\n   * configElements is returned.\n   */\n  setConfig (cfg: Record<string, string>) {\n    const finds: HTMLElement[] = []\n    this.allSettings.querySelectorAll('input').forEach((input: ConfigOptionInput) => {\n      const k = input.configOpt.key\n      const v = cfg[k]\n      if (typeof v === 'undefined') return\n      finds.push(this.configElements[k])\n      if (input.configOpt.isboolean) input.checked = isTruthyString(v)\n      else if (input.configOpt.isdate) input.valueAsDate = new Date(parseInt(v) * 1000)\n      else input.value = v\n    })\n    return finds\n  }\n\n  /*\n   * setLoadedConfig sets the input values for the entries in cfg, and moves\n   * them to the loadedSettings box.\n   */\n  setLoadedConfig (cfg: Record<string, string>) {\n    const finds = this.setConfig(cfg)\n    if (!this.sectionize || finds.length === 0) return\n    this.loadedSettings.append(...finds)\n    this.reorder(this.loadedSettings)\n    Doc.show(this.loadedSettings, this.loadedSettingsMsg)\n    if (this.defaultSettings.children.length === 0) Doc.hide(this.defaultSettings, this.defaultSettingsMsg)\n  }\n\n  /*\n   * map reads all inputs and constructs an object from the configOpt keys and\n   * values.\n   */\n  map (): Record<string, string> {\n    const config: Record<string, string> = {}\n    this.allSettings.querySelectorAll('input').forEach((input: ConfigOptionInput) => {\n      if (input.configOpt.isboolean && input.configOpt.key) {\n        config[input.configOpt.key] = input.checked ? '1' : '0'\n      } else if (input.configOpt.isdate && input.configOpt.key) {\n        const minDate = input.min ? toUnixDate(new Date(input.min)) : Number.MIN_SAFE_INTEGER\n        const maxDate = input.max ? toUnixDate(new Date(input.max)) : Number.MAX_SAFE_INTEGER\n        let date = input.value ? toUnixDate(new Date(input.value)) : 0\n        if (date < minDate) date = minDate\n        else if (date > maxDate) date = maxDate\n        config[input.configOpt.key] = '' + date\n      } else if (input.value) {\n        config[input.configOpt.key] = input.value\n      }\n    })\n\n    return config\n  }\n\n  /*\n   * reorder sorts the configElements in the box by the order of the\n   * server-provided configOpts array.\n   */\n  reorder (box: HTMLElement) {\n    const inputs: Record<string, HTMLElement> = {}\n    box.querySelectorAll('input').forEach((input: ConfigOptionInput) => {\n      const k = input.configOpt.key\n      inputs[k] = this.configElements[k]\n    })\n    for (const opt of this.configOpts) {\n      const input = inputs[opt.key]\n      if (input) box.append(input)\n    }\n  }\n}\n\n/*\n * ConfirmRegistrationForm should be used with the \"confirmRegistrationForm\"\n * template.\n */\nexport class ConfirmRegistrationForm {\n  form: HTMLElement\n  success: () => void\n  page: Record<string, PageElement>\n  xc: Exchange\n  certFile: string\n  feeAssetID: number\n  pwCache: PasswordCache\n\n  constructor (form: HTMLElement, success: () => void, goBack: () => void, pwCache: PasswordCache) {\n    this.form = form\n    this.success = success\n    this.page = Doc.parseTemplate(form)\n    this.certFile = ''\n    this.pwCache = pwCache\n\n    Doc.bind(this.page.goBack, 'click', () => goBack())\n    bind(form, this.page.submit, () => this.submitForm())\n  }\n\n  setExchange (xc: Exchange, certFile: string) {\n    this.xc = xc\n    this.certFile = certFile\n    const page = this.page\n    if (State.passwordIsCached() || (this.pwCache && this.pwCache.pw)) Doc.hide(page.passBox)\n    else Doc.show(page.passBox)\n    page.host.textContent = xc.host\n  }\n\n  setAsset (assetID: number) {\n    const asset = app().assets[assetID]\n    const unitInfo = asset.info.unitinfo\n    this.feeAssetID = asset.id\n    const page = this.page\n    const regAsset = this.xc.regFees[asset.symbol]\n    page.fee.textContent = Doc.formatCoinValue(regAsset.amount, unitInfo)\n    page.feeUnit.textContent = unitInfo.conventional.unit.toUpperCase()\n    page.logo.src = Doc.logoPath(asset.symbol)\n  }\n\n  /* Form expands into its space quickly from the lower-right as it fades in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(400, prog => {\n      form.style.transform = `scale(${prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n      const offset = `${(1 - prog) * 500}px`\n      form.style.top = offset\n      form.style.left = offset\n    })\n  }\n\n  /*\n   * submitForm is called when the form is submitted.\n   */\n  async submitForm () {\n    const page = this.page\n    // if button is selected it can be clickable.\n    if (!page.submit.classList.contains('selected')) {\n      return\n    }\n    if (this.feeAssetID === null) {\n      page.regErr.innerText = 'You must select a valid wallet for the fee payment'\n      Doc.show(page.regErr)\n      return\n    }\n    const symbol = app().user.assets[this.feeAssetID].wallet.symbol\n    Doc.hide(page.regErr)\n    const feeAsset = this.xc.regFees[symbol]\n    const cert = await this.certFile\n    const dexAddr = this.xc.host\n    const pw = page.appPass.value || (this.pwCache ? this.pwCache.pw : '')\n    const registration = {\n      addr: dexAddr,\n      pass: pw,\n      fee: feeAsset.amount,\n      asset: feeAsset.id,\n      cert: cert\n    }\n    page.appPass.value = ''\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/register', registration)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.regErr.textContent = res.msg\n      Doc.show(page.regErr)\n      return\n    }\n    this.success()\n  }\n}\n\n/*\n * FeeAssetSelectionForm should be used with the \"regAssetForm\" template.\n */\nexport class FeeAssetSelectionForm {\n  form: HTMLElement\n  success: (assetID: number) => void\n  xc: Exchange\n  page: Record<string, PageElement>\n\n  constructor (form: HTMLElement, success: (assetID: number) => void) {\n    this.form = form\n    this.success = success\n    this.page = Doc.parseTemplate(form)\n    Doc.cleanTemplates(this.page.marketTmpl, this.page.assetTmpl)\n  }\n\n  setExchange (xc: Exchange) {\n    this.xc = xc\n    const page = this.page\n    Doc.empty(page.assets, page.allMarkets)\n\n    const cFactor = (ui: UnitInfo) => ui.conventional.conversionFactor\n\n    const marketNode = (mkt: Market, excludeIcon?: number) => {\n      const n = page.marketTmpl.cloneNode(true) as HTMLElement\n      const marketTmpl = Doc.parseTemplate(n)\n\n      const baseAsset = xc.assets[mkt.baseid]\n      const baseUnitInfo = app().unitInfo(mkt.baseid, xc)\n      const quoteAsset = xc.assets[mkt.quoteid]\n      const quoteUnitInfo = app().unitInfo(mkt.quoteid, xc)\n\n      if (cFactor(baseUnitInfo) === 0 || cFactor(quoteUnitInfo) === 0) return null\n\n      if (typeof excludeIcon !== 'undefined') {\n        const excludeBase = excludeIcon === mkt.baseid\n        const otherSymbol = xc.assets[excludeBase ? mkt.quoteid : mkt.baseid].symbol\n        marketTmpl.logo.src = Doc.logoPath(otherSymbol)\n      } else {\n        const otherLogo = marketTmpl.logo.cloneNode(true) as PageElement\n        marketTmpl.logo.src = Doc.logoPath(baseAsset.symbol)\n        otherLogo.src = Doc.logoPath(quoteAsset.symbol)\n        const parent = marketTmpl.logo.parentNode\n        if (parent) parent.insertBefore(otherLogo, marketTmpl.logo.nextSibling)\n      }\n\n      const baseSymbol = baseAsset.symbol.toUpperCase()\n      const quoteSymbol = quoteAsset.symbol.toUpperCase()\n\n      marketTmpl.name.textContent = `${baseSymbol}-${quoteSymbol}`\n      const s = Doc.formatCoinValue(mkt.lotsize, baseUnitInfo)\n      marketTmpl.lotSize.textContent = `${s} ${baseSymbol}`\n\n      if (mkt.spot) {\n        Doc.show(marketTmpl.quoteLotSize)\n        const r = cFactor(quoteUnitInfo) / cFactor(baseUnitInfo)\n        const quoteLot = mkt.lotsize * mkt.spot.rate / OrderUtil.RateEncodingFactor * r\n        const s = Doc.formatCoinValue(quoteLot, quoteUnitInfo)\n        marketTmpl.quoteLotSize.textContent = `(~${s} ${quoteSymbol})`\n      }\n      return n\n    }\n\n    for (const [symbol, feeAsset] of Object.entries(xc.regFees)) {\n      const asset = app().assets[feeAsset.id]\n      if (!asset) continue\n      const haveWallet = asset.wallet\n      const unitInfo = asset.info.unitinfo\n      const assetNode = page.assetTmpl.cloneNode(true) as HTMLElement\n      Doc.bind(assetNode, 'click', () => { this.success(feeAsset.id) })\n      const assetTmpl = Doc.parseTemplate(assetNode)\n      page.assets.appendChild(assetNode)\n      assetTmpl.logo.src = Doc.logoPath(symbol)\n      const fee = Doc.formatCoinValue(feeAsset.amount, unitInfo)\n      assetTmpl.fee.textContent = `${fee} ${unitInfo.conventional.unit}`\n      assetTmpl.confs.textContent = String(feeAsset.confs)\n      assetTmpl.ready.textContent = haveWallet ? intl.prep(intl.WALLET_READY) : intl.prep(intl.SETUP_NEEDED)\n      assetTmpl.ready.classList.add(haveWallet ? 'readygreen' : 'setuporange')\n\n      let count = 0\n      for (const mkt of Object.values(xc.markets)) {\n        if (mkt.baseid !== feeAsset.id && mkt.quoteid !== feeAsset.id) continue\n        const node = marketNode(mkt, feeAsset.id)\n        if (!node) continue\n        count++\n        assetTmpl.markets.appendChild(node)\n      }\n      if (count < 3) Doc.hide(assetTmpl.fader)\n    }\n\n    page.host.textContent = xc.host\n    for (const mkt of Object.values(xc.markets)) {\n      const node = marketNode(mkt)\n      if (!node) continue\n      page.allMarkets.appendChild(node)\n    }\n  }\n\n  refresh () {\n    this.setExchange(this.xc)\n  }\n\n  /*\n   * Animation to make the elements sort of expand into their space from the\n   * bottom as they fade in.\n   */\n  async animate () {\n    const { page, form } = this\n    const how = page.how\n    const extraMargin = 75\n    const extraTop = 50\n    const fontSize = 24\n    const regAssetElements = Array.from(page.assets.children) as PageElement[]\n    regAssetElements.push(page.allmkts)\n    form.style.opacity = '0'\n\n    const aniLen = 350\n    await Doc.animate(aniLen, prog => {\n      for (const el of regAssetElements) {\n        el.style.marginTop = `${(1 - prog) * extraMargin}px`\n        el.style.transform = `scale(${prog})`\n      }\n      form.style.opacity = Math.pow(prog, 4).toFixed(1)\n      form.style.paddingTop = `${(1 - prog) * extraTop}px`\n      how.style.fontSize = `${fontSize * prog}px`\n    }, 'easeOut')\n  }\n}\n\n/*\n * WalletWaitForm is a form used to track the wallet sync status and balance\n * in preparation for paying the registration fee.\n */\nexport class WalletWaitForm {\n  form: HTMLElement\n  success: () => void\n  goBack: () => void\n  page: Record<string, PageElement>\n  assetID: number\n  xc: Exchange\n  regFee: FeeAsset\n  progressCache: ProgressPoint[]\n  progressed: boolean\n  funded: boolean\n\n  constructor (form: HTMLElement, success: () => void, goBack: () => void) {\n    this.form = form\n    this.success = success\n    this.page = Doc.parseTemplate(form)\n    this.assetID = -1\n    this.progressCache = []\n    this.progressed = false\n    this.funded = false\n\n    Doc.bind(this.page.goBack, 'click', () => {\n      this.assetID = -1\n      goBack()\n    })\n\n    app().registerNoteFeeder({\n      walletstate: (note: WalletStateNote) => this.reportWalletState(note.wallet),\n      balance: (note: BalanceNote) => this.reportBalance(note.balance, note.assetID)\n    })\n  }\n\n  /* setExchange sets the exchange for which the fee is being paid. */\n  setExchange (xc: Exchange) {\n    this.xc = xc\n  }\n\n  /* setWallet must be called before showing the form. */\n  setWallet (wallet: WalletState, txFee: number) {\n    this.assetID = wallet.assetID\n    this.progressCache = []\n    this.progressed = false\n    this.funded = false\n    const page = this.page\n    const asset = app().assets[wallet.assetID]\n    const fee = this.regFee = this.xc.regFees[asset.symbol]\n\n    for (const span of Doc.applySelector(this.form, '.unit')) span.textContent = asset.symbol.toUpperCase()\n    page.logo.src = Doc.logoPath(asset.symbol)\n    page.depoAddr.textContent = wallet.address\n    page.fee.textContent = Doc.formatCoinValue(fee.amount, asset.info.unitinfo)\n\n    Doc.hide(page.syncUncheck, page.syncCheck, page.balUncheck, page.balCheck, page.syncRemainBox)\n    Doc.show(page.balanceBox)\n\n    if (txFee > 0) {\n      page.totalFees.textContent = Doc.formatCoinValue(fee.amount + txFee, asset.info.unitinfo)\n      Doc.show(page.sendEnoughWithEst)\n      Doc.hide(page.sendEnough)\n    } else {\n      Doc.show(page.sendEnough)\n      Doc.hide(page.sendEnoughWithEst)\n    }\n\n    Doc.show(wallet.synced ? page.syncCheck : wallet.syncProgress >= 1 ? page.syncSpinner : page.syncUncheck)\n    Doc.show(wallet.balance.available > fee.amount ? page.balCheck : page.balUncheck)\n\n    page.progress.textContent = String(Math.round(wallet.syncProgress * 100))\n\n    if (wallet.synced) {\n      this.progressed = true\n    }\n    this.reportBalance(wallet.balance, wallet.assetID)\n  }\n\n  /*\n   * reportWalletState sets the progress and balance, ultimately calling the\n   * success function if conditions are met.\n   */\n  reportWalletState (wallet: WalletState) {\n    if (wallet.assetID !== this.assetID) return\n    if (this.progressed && this.funded) return\n    this.reportProgress(wallet.synced, wallet.syncProgress)\n    this.reportBalance(wallet.balance, wallet.assetID)\n  }\n\n  /*\n   * reportBalance sets the balance display and calls success if we go over the\n   * threshold.\n   */\n  reportBalance (bal: WalletBalance, assetID: number) {\n    if (this.funded || this.assetID === -1 || this.assetID !== assetID) return\n    const page = this.page\n    const asset = app().assets[this.assetID]\n\n    if (bal.available <= this.regFee.amount) {\n      page.balance.textContent = Doc.formatCoinValue(bal.available, asset.info.unitinfo)\n      return\n    }\n\n    Doc.show(page.balCheck)\n    Doc.hide(page.balUncheck, page.balanceBox, page.sendEnough)\n    this.funded = true\n\n    if (this.progressed) this.success()\n  }\n\n  /*\n   * reportProgress sets the progress display and calls success if we are fully\n   * synced.\n   */\n  reportProgress (synced: boolean, prog: number) {\n    const page = this.page\n    if (synced) {\n      page.progress.textContent = '100'\n      Doc.hide(page.syncUncheck, page.syncRemainBox, page.syncSpinner)\n      Doc.show(page.syncCheck)\n      this.progressed = true\n      if (this.funded) this.success()\n      return\n    } else if (prog === 1) {\n      Doc.hide(page.syncUncheck)\n      Doc.show(page.syncSpinner)\n    } else {\n      Doc.hide(page.syncSpinner)\n      Doc.show(page.syncUncheck)\n    }\n    page.progress.textContent = String(Math.round(prog * 100))\n\n    // The remaining time estimate must be based on more than one progress\n    // report. We'll cache up to the last 20 and look at the difference between\n    // the first and last to make the estimate.\n    const cacheSize = 20\n    const cache = this.progressCache\n    cache.push({\n      stamp: new Date().getTime(),\n      progress: prog\n    })\n    while (cache.length > cacheSize) cache.shift()\n    if (cache.length === 1) return\n    Doc.show(page.syncRemainBox)\n    const [first, last] = [cache[0], cache[cache.length - 1]]\n    const progDelta = last.progress - first.progress\n    if (progDelta === 0) {\n      page.syncRemain.textContent = '> 1 day'\n      return\n    }\n    const timeDelta = last.stamp - first.stamp\n    const progRate = progDelta / timeDelta\n    const toGoProg = 1 - last.progress\n    const toGoTime = toGoProg / progRate\n    page.syncRemain.textContent = Doc.formatDuration(toGoTime)\n  }\n}\n\nexport class UnlockWalletForm {\n  form: HTMLElement\n  success: () => void\n  pwCache: PasswordCache | null\n  page: Record<string, PageElement>\n  currentAsset: SupportedAsset\n\n  constructor (form: HTMLElement, success: () => void, pwCache?: PasswordCache) {\n    this.page = Doc.idDescendants(form)\n    this.form = form\n    this.pwCache = pwCache || null\n    this.success = success\n    bind(form, this.page.submitUnlock, () => this.submit())\n  }\n\n  refresh (asset: SupportedAsset) {\n    const page = this.page\n    this.currentAsset = asset\n    page.uwAssetLogo.src = Doc.logoPath(asset.symbol)\n    page.uwAssetName.textContent = asset.info.name\n    page.uwAppPass.value = ''\n    page.unlockErr.textContent = ''\n    Doc.hide(page.unlockErr)\n    const hidePWBox = State.passwordIsCached() || (this.pwCache && this.pwCache.pw)\n    if (hidePWBox) Doc.hide(page.uwAppPassBox)\n    else Doc.show(page.uwAppPassBox)\n  }\n\n  /*\n   * setError displays an error on the form.\n   */\n  setError (msg: string) {\n    this.page.unlockErr.textContent = msg\n    Doc.show(this.page.unlockErr)\n  }\n\n  /*\n   * showErrorOnly displays only an error on the form. Hides the\n   * app pass field and the submit button.\n   */\n  showErrorOnly (msg: string) {\n    this.setError(msg)\n    Doc.hide(this.page.uwAppPassBox)\n    Doc.hide(this.page.submitUnlockDiv)\n  }\n\n  async submit () {\n    const page = this.page\n    const pw = page.uwAppPass.value || (this.pwCache ? this.pwCache.pw : '')\n    if (!pw && !State.passwordIsCached()) {\n      page.unlockErr.textContent = intl.prep(intl.ID_NO_APP_PASS_ERROR_MSG)\n      Doc.show(page.unlockErr)\n      return\n    }\n    Doc.hide(this.page.unlockErr)\n    const open = {\n      assetID: this.currentAsset.id,\n      pass: pw\n    }\n    page.uwAppPass.value = ''\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/openwallet', open)\n    loaded()\n    if (!app().checkResponse(res)) {\n      this.setError(res.msg)\n      return\n    }\n    if (this.pwCache) this.pwCache.pw = pw\n    this.success()\n  }\n}\n\ninterface EarlyAcceleration {\n  timePast: number,\n  wasAcceleration: boolean\n}\n\ninterface PreAccelerate {\n  swapRate: number\n  suggestedRate: number\n  suggestedRange: XYRange\n  earlyAcceleration?: EarlyAcceleration\n}\n\n/*\n * AccelerateOrderForm is used to submit an acceleration request for an order.\n */\nexport class AccelerateOrderForm {\n  form: HTMLElement\n  page: Record<string, PageElement>\n  order: Order\n  acceleratedRate: number\n  earlyAcceleration?: EarlyAcceleration\n  currencyUnit: string\n  success: () => void\n\n  constructor (form: HTMLElement, success: () => void) {\n    this.form = form\n    this.success = success\n    const page = this.page = Doc.idDescendants(form)\n\n    Doc.bind(page.accelerateSubmit, 'click', () => {\n      this.submit()\n    })\n    Doc.bind(page.submitEarlyConfirm, 'click', () => {\n      this.sendAccelerateRequest()\n    })\n  }\n\n  /*\n   * displayEarlyAccelerationMsg displays a message asking for confirmation\n   * when the user tries to submit an acceleration transaction very soon after\n   * the swap transaction was broadcast, or very soon after a previous\n   * acceleration.\n   */\n  displayEarlyAccelerationMsg () {\n    const page = this.page\n    // this is checked in submit, but another check is needed for ts compiler\n    if (!this.earlyAcceleration) return\n    page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    if (this.earlyAcceleration.wasAcceleration) {\n      Doc.show(page.recentAccelerationMsg)\n      Doc.hide(page.recentSwapMsg)\n      page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    } else {\n      Doc.show(page.recentSwapMsg)\n      Doc.hide(page.recentAccelerationMsg)\n      page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    }\n    Doc.hide(page.configureAccelerationDiv, page.accelerateErr)\n    Doc.show(page.earlyAccelerationDiv)\n  }\n\n  // sendAccelerateRequest makes an accelerateorder request to the client\n  // backend.\n  async sendAccelerateRequest () {\n    const order = this.order\n    const page = this.page\n    const req = {\n      pw: page.acceleratePass.value,\n      orderID: order.id,\n      newRate: this.acceleratedRate\n    }\n    page.acceleratePass.value = ''\n    const loaded = app().loading(page.accelerateMainDiv)\n    const res = await postJSON('/api/accelerateorder', req)\n    loaded()\n    if (app().checkResponse(res)) {\n      page.accelerateTxID.textContent = res.txID\n      Doc.hide(page.accelerateMainDiv, page.preAccelerateErr, page.accelerateErr)\n      Doc.show(page.accelerateMsgDiv, page.accelerateSuccess)\n      this.success()\n    } else {\n      page.accelerateErr.textContent = `Error accelerating order: ${res.msg}`\n      Doc.hide(page.earlyAccelerationDiv)\n      Doc.show(page.accelerateErr, page.configureAccelerationDiv)\n    }\n  }\n\n  // submit is called when the submit button is clicked.\n  async submit () {\n    if (this.earlyAcceleration) {\n      this.displayEarlyAccelerationMsg()\n    } else {\n      this.sendAccelerateRequest()\n    }\n  }\n\n  // refresh should be called before the form is displayed. It makes a\n  // preaccelerate request to the client backend and sets up the form\n  // based on the results.\n  async refresh (order: Order) {\n    const page = this.page\n    this.order = order\n    const res = await postJSON('/api/preaccelerate', order.id)\n    if (!app().checkResponse(res)) {\n      page.preAccelerateErr.textContent = `Error accelerating order: ${res.msg}`\n      Doc.hide(page.accelerateMainDiv, page.accelerateSuccess)\n      Doc.show(page.accelerateMsgDiv, page.preAccelerateErr)\n      return\n    }\n    Doc.hide(page.accelerateMsgDiv, page.preAccelerateErr, page.accelerateErr, page.feeEstimateDiv, page.earlyAccelerationDiv)\n    Doc.show(page.accelerateMainDiv, page.accelerateSuccess, page.configureAccelerationDiv)\n    const preAccelerate: PreAccelerate = res.preAccelerate\n    this.earlyAcceleration = preAccelerate.earlyAcceleration\n    this.currencyUnit = preAccelerate.suggestedRange.yUnit\n    page.accelerateAvgFeeRate.textContent = `${preAccelerate.swapRate} ${preAccelerate.suggestedRange.yUnit}`\n    page.accelerateCurrentFeeRate.textContent = `${preAccelerate.suggestedRate} ${preAccelerate.suggestedRange.yUnit}`\n    this.acceleratedRate = preAccelerate.suggestedRange.start.y\n    const selected = () => { /* do nothing */ }\n    const roundY = true\n    const updateRate = (_: number, newY: number) => { this.acceleratedRate = newY }\n    const rangeHandler = new OrderUtil.XYRangeHandler(preAccelerate.suggestedRange,\n      preAccelerate.suggestedRange.start.x, updateRate, () => this.updateAccelerationEstimate(), selected, roundY)\n    Doc.empty(page.sliderContainer)\n    page.sliderContainer.appendChild(rangeHandler.control)\n    this.updateAccelerationEstimate()\n  }\n\n  // updateAccelerationEstimate makes an accelerateestimate request to the\n  // client backend using the curretly selected rate on the slider, and\n  // displays the results.\n  async updateAccelerationEstimate () {\n    const page = this.page\n    const order = this.order\n    const req = {\n      orderID: order.id,\n      newRate: this.acceleratedRate\n    }\n    const loaded = app().loading(page.sliderContainer)\n    const res = await postJSON('/api/accelerationestimate', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.accelerateErr.textContent = `Error estimating acceleration fee: ${res.msg}`\n      Doc.show(page.accelerateErr)\n      return\n    }\n    page.feeRateEstimate.textContent = `${this.acceleratedRate} ${this.currencyUnit}`\n    let assetID\n    let assetSymbol\n    if (order.sell) {\n      assetID = order.baseID\n      assetSymbol = order.baseSymbol\n    } else {\n      assetID = order.quoteID\n      assetSymbol = order.quoteSymbol\n    }\n    const unitInfo = app().unitInfo(assetID)\n    page.feeEstimate.textContent = `${res.fee / unitInfo.conventional.conversionFactor} ${assetSymbol}`\n    Doc.show(page.feeEstimateDiv)\n  }\n}\n\n/* DEXAddressForm accepts a DEX address and performs account discovery. */\nexport class DEXAddressForm {\n  form: HTMLElement\n  success: (xc: Exchange, cert: string) => void\n  pwCache: PasswordCache | null\n  defaultTLSText: string\n  page: Record<string, PageElement>\n  knownExchanges: HTMLElement[]\n  dexToUpdate?: string\n\n  constructor (form: HTMLElement, success: (xc: Exchange, cert: string) => void, pwCache?: PasswordCache, dexToUpdate?: string) {\n    this.form = form\n    this.success = success\n    this.pwCache = pwCache || null\n    this.defaultTLSText = 'none selected'\n\n    const page = this.page = Doc.parseTemplate(form)\n\n    page.selectedCert.textContent = this.defaultTLSText\n    Doc.bind(page.certFile, 'change', () => this.onCertFileChange())\n    Doc.bind(page.removeCert, 'click', () => this.clearCertFile())\n    Doc.bind(page.addCert, 'click', () => page.certFile.click())\n    Doc.bind(page.showCustom, 'click', () => {\n      Doc.hide(page.showCustom)\n      Doc.show(page.customBox, page.auth)\n    })\n\n    this.knownExchanges = Array.from(page.knownXCs.querySelectorAll('.known-exchange'))\n    for (const div of this.knownExchanges) {\n      Doc.bind(div, 'click', () => {\n        const host = div.dataset.host\n        for (const d of this.knownExchanges) d.classList.remove('selected')\n        // If we have the password cached, we're good to go.\n        if (State.passwordIsCached() || (pwCache && pwCache.pw)) return this.checkDEX(host)\n        // Highlight the entry, but the user will have to enter their password\n        // and click submit.\n        div.classList.add('selected')\n        page.appPW.focus()\n        page.addr.value = host\n      })\n    }\n\n    bind(form, page.submit, () => this.checkDEX())\n\n    if (dexToUpdate) {\n      Doc.hide(page.addDexHdr)\n      Doc.show(page.updateDexHdr)\n      this.dexToUpdate = dexToUpdate\n    }\n\n    this.refresh()\n  }\n\n  refresh () {\n    const page = this.page\n    page.addr.value = ''\n    page.appPW.value = ''\n    this.clearCertFile()\n    Doc.hide(page.err)\n    const hidePWBox = State.passwordIsCached() || (this.pwCache && this.pwCache.pw)\n    if (hidePWBox) Doc.hide(page.appPWBox, page.auth)\n    else Doc.show(page.appPWBox, page.auth)\n    if (this.knownExchanges.length === 0 || this.dexToUpdate) {\n      Doc.show(page.customBox, page.auth)\n      Doc.hide(page.showCustom, page.knownXCs, page.pickServerMsg, page.addCustomMsg)\n    } else {\n      Doc.hide(page.customBox)\n      Doc.show(page.showCustom)\n    }\n    for (const div of this.knownExchanges) div.classList.remove('selected')\n  }\n\n  /* Just a small size tweak and fade-in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(550, prog => {\n      form.style.transform = `scale(${0.9 + 0.1 * prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n    }, 'easeOut')\n  }\n\n  async checkDEX (addr?: string) {\n    const page = this.page\n    Doc.hide(page.err)\n    addr = addr || page.addr.value\n    if (addr === '') {\n      page.err.textContent = 'DEX address cannot be empty'\n      Doc.show(page.err)\n      return\n    }\n    let cert = ''\n    if (page.certFile.value) {\n      const files = page.certFile.files\n      if (files && files.length) {\n        cert = await files[0].text()\n      }\n    }\n    let pw = ''\n    if (!State.passwordIsCached()) {\n      pw = page.appPW.value || (this.pwCache ? this.pwCache.pw : '')\n    }\n    let endpoint : string, req: any\n    if (this.dexToUpdate) {\n      endpoint = '/api/updatedexhost'\n      req = {\n        newHost: addr,\n        cert: cert,\n        pw: pw,\n        oldHost: this.dexToUpdate\n      }\n    } else {\n      endpoint = '/api/discoveracct'\n      req = {\n        addr: addr,\n        cert: cert,\n        pass: pw\n      }\n    }\n    const loaded = app().loading(this.form)\n    const res = await postJSON(endpoint, req)\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      if (res.msg === 'certificate required') {\n        Doc.show(page.needCert)\n      } else {\n        page.err.textContent = res.msg\n        Doc.show(page.err)\n      }\n      return\n    }\n    if (!this.dexToUpdate && res.paid) {\n      await app().fetchUser()\n      app().loadPage('markets')\n      return\n    }\n    if (this.pwCache) this.pwCache.pw = pw\n    this.success(res.xc, cert)\n  }\n\n  /**\n   * onCertFileChange when the input certFile changed, read the file\n   * and setting cert name into text of selectedCert to display on the view\n   */\n  async onCertFileChange () {\n    const page = this.page\n    const files = page.certFile.files\n    if (!files || !files.length) return\n    page.selectedCert.textContent = files[0].name\n    Doc.show(page.removeCert)\n    Doc.hide(page.addCert)\n  }\n\n  /* clearCertFile cleanup certFile value and selectedCert text */\n  clearCertFile () {\n    const page = this.page\n    page.certFile.value = ''\n    page.selectedCert.textContent = this.defaultTLSText\n    Doc.hide(page.removeCert)\n    Doc.show(page.addCert)\n  }\n}\n\n/* LoginForm is used to sign into the app. */\nexport class LoginForm {\n  form: HTMLElement\n  success: () => void\n  pwCache: PasswordCache | null\n  headerTxt: string\n  page: Record<string, PageElement>\n\n  constructor (form: HTMLElement, success: () => void, pwCache?: PasswordCache) {\n    this.success = success\n    this.form = form\n    this.pwCache = pwCache || null\n    const page = this.page = Doc.parseTemplate(form)\n    this.headerTxt = page.header.textContent || ''\n\n    bind(form, page.submit, () => { this.submit() })\n  }\n\n  focus () {\n    this.page.pw.focus()\n  }\n\n  async submit () {\n    const page = this.page\n    Doc.hide(page.errMsg)\n    const pw = page.pw.value || ''\n    page.pw.value = ''\n    const rememberPass = page.rememberPass.checked\n    if (pw === '') {\n      page.errMsg.textContent = intl.prep(intl.ID_NO_PASS_ERROR_MSG)\n      Doc.show(page.errMsg)\n      return\n    }\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/login', { pass: pw, rememberPass })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.errMsg.textContent = res.msg\n      Doc.show(page.errMsg)\n      return\n    }\n    if (res.notes) {\n      res.notes.reverse()\n    }\n    app().setNotes(res.notes || [])\n    if (this.pwCache) this.pwCache.pw = pw\n    this.success()\n  }\n\n  /* Just a small size tweak and fade-in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(550, prog => {\n      form.style.transform = `scale(${0.9 + 0.1 * prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n    }, 'easeOut')\n  }\n}\n\nconst animationLength = 300\n\n/* Swap form1 for form2 with an animation. */\nexport async function slideSwap (form1: HTMLElement, form2: HTMLElement) {\n  const shift = document.body.offsetWidth / 2\n  await Doc.animate(animationLength, progress => {\n    form1.style.right = `${progress * shift}px`\n  }, 'easeInHard')\n  Doc.hide(form1)\n  form1.style.right = '0'\n  form2.style.right = String(-shift)\n  Doc.show(form2)\n  if (form2.querySelector('input')) {\n    Doc.safeSelector(form2, 'input').focus()\n  }\n  await Doc.animate(animationLength, progress => {\n    form2.style.right = `${-shift + progress * shift}px`\n  }, 'easeOutHard')\n  form2.style.right = '0'\n}\n\n/*\n * bind binds the click and submit events and prevents page reloading on\n * submission.\n */\nexport function bind (form: HTMLElement, submitBttn: HTMLElement, handler: (e: Event) => void) {\n  const wrapper = (e: Event) => {\n    if (e.preventDefault) e.preventDefault()\n    handler(e)\n  }\n  Doc.bind(submitBttn, 'click', wrapper)\n  Doc.bind(form, 'submit', wrapper)\n}\n\n// isTruthyString will be true if the provided string is recognized as a\n// value representing true.\nfunction isTruthyString (s: string) {\n  return s === '1' || s.toLowerCase() === 'true'\n}\n\n// toUnixDate converts a javscript date object to a unix date, which is\n// the number of *seconds* since the start of the epoch.\nfunction toUnixDate (date: Date) {\n  return Math.floor(date.getTime() / 1000)\n}\n\n// dateToString converts a javascript date object to a YYYY-MM-DD format string.\nfunction dateToString (date: Date) {\n  return date.toISOString().split('T')[0]\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport { postJSON } from './http'\nimport {\n  NewWalletForm,\n  DEXAddressForm,\n  LoginForm,\n  ConfirmRegistrationForm,\n  FeeAssetSelectionForm,\n  WalletWaitForm,\n  slideSwap,\n  bind as bindForm\n} from './forms'\nimport * as intl from './locales'\nimport {\n  app,\n  PasswordCache,\n  Exchange,\n  PageElement\n} from './registry'\n\nexport default class RegistrationPage extends BasePage {\n  body: HTMLElement\n  pwCache: PasswordCache\n  currentDEX: Exchange\n  page: Record<string, PageElement>\n  loginForm: LoginForm\n  dexAddrForm: DEXAddressForm\n  newWalletForm: NewWalletForm\n  regAssetForm: FeeAssetSelectionForm\n  walletWaitForm: WalletWaitForm\n  confirmRegisterForm: ConfirmRegistrationForm\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    this.pwCache = { pw: '' }\n    const page = this.page = Doc.idDescendants(body)\n\n    // Hide the form closers for the registration process.\n    body.querySelectorAll('.form-closer').forEach(el => Doc.hide(el))\n\n    // SET APP PASSWORD\n    bindForm(page.appPWForm, page.appPWSubmit, () => this.setAppPass())\n    Doc.bind(page.showSeedRestore, 'click', () => {\n      Doc.show(page.seedRestore)\n      Doc.hide(page.showSeedRestore)\n    })\n\n    this.loginForm = new LoginForm(page.loginForm, async () => {\n      await app().fetchUser()\n      this.dexAddrForm.refresh()\n      slideSwap(page.loginForm, page.dexAddrForm)\n    }, this.pwCache)\n\n    this.newWalletForm = new NewWalletForm(\n      page.newWalletForm,\n      assetID => this.newWalletCreated(assetID),\n      this.pwCache,\n      () => this.animateRegAsset(page.newWalletForm)\n    )\n\n    // ADD DEX\n    this.dexAddrForm = new DEXAddressForm(page.dexAddrForm, async (xc, certFile) => {\n      this.currentDEX = xc\n      this.confirmRegisterForm.setExchange(xc, certFile)\n      this.walletWaitForm.setExchange(xc)\n      this.regAssetForm.setExchange(xc)\n      this.animateRegAsset(page.dexAddrForm)\n    }, this.pwCache)\n\n    // SELECT REG ASSET\n    this.regAssetForm = new FeeAssetSelectionForm(page.regAssetForm, async assetID => {\n      this.confirmRegisterForm.setAsset(assetID)\n\n      const asset = app().assets[assetID]\n      const wallet = asset.wallet\n      if (wallet) {\n        const fee = this.currentDEX.regFees[asset.symbol]\n        if (wallet.synced && wallet.balance.available > fee.amount) {\n          this.animateConfirmForm(page.regAssetForm)\n          return\n        }\n        const txFee = await this.getRegistrationTxFeeEstimate(assetID, page.regAssetForm)\n        this.walletWaitForm.setWallet(wallet, txFee)\n        slideSwap(page.regAssetForm, page.walletWait)\n        return\n      }\n\n      this.newWalletForm.setAsset(assetID)\n      this.newWalletForm.loadDefaults()\n      slideSwap(page.regAssetForm, page.newWalletForm)\n    })\n\n    this.walletWaitForm = new WalletWaitForm(page.walletWait, () => {\n      this.animateConfirmForm(page.walletWait)\n    }, () => { this.animateRegAsset(page.walletWait) })\n\n    // SUBMIT DEX REGISTRATION\n    this.confirmRegisterForm = new ConfirmRegistrationForm(page.confirmRegForm, () => {\n      this.registerDEXSuccess()\n    }, () => {\n      this.animateRegAsset(page.confirmRegForm)\n    }, this.pwCache)\n\n    const currentForm = Doc.safeSelector(page.forms, ':scope > form.selected')\n    currentForm.classList.remove('selected')\n    switch (currentForm) {\n      case page.loginForm:\n        this.loginForm.animate()\n        break\n      case page.dexAddrForm:\n        this.dexAddrForm.animate()\n    }\n    Doc.show(currentForm)\n\n    // Attempt to load the dcrwallet configuration from the default location.\n    if (app().user.authed) this.auth()\n  }\n\n  unload () {\n    this.pwCache.pw = ''\n  }\n\n  // auth should be called once user is known to be authed with the server.\n  async auth () {\n    await app().fetchUser()\n  }\n\n  /* Swap in the asset selection form and run the animation. */\n  async animateRegAsset (oldForm: HTMLElement) {\n    Doc.hide(oldForm)\n    this.regAssetForm.animate()\n    Doc.show(this.page.regAssetForm)\n  }\n\n  /* Swap in the confirmation form and run the animation. */\n  async animateConfirmForm (oldForm: HTMLElement) {\n    this.confirmRegisterForm.animate()\n    Doc.hide(oldForm)\n    Doc.show(this.page.confirmRegForm)\n  }\n\n  // Retrieve an estimate for the tx fee needed to pay the registration fee.\n  async getRegistrationTxFeeEstimate (assetID: number, form: HTMLElement) {\n    const cert = await this.getCertFile()\n    const loaded = app().loading(form)\n    const res = await postJSON('/api/regtxfee', {\n      addr: this.currentDEX.host,\n      cert: cert,\n      asset: assetID\n    })\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      return 0\n    }\n    return res.txfee\n  }\n\n  /* Set the application password. Attached to form submission. */\n  async setAppPass () {\n    const page = this.page\n    Doc.hide(page.appPWErrMsg)\n    const pw = page.appPW.value || ''\n    const pwAgain = page.appPWAgain.value\n    if (pw === '') {\n      page.appPWErrMsg.textContent = intl.prep(intl.ID_NO_PASS_ERROR_MSG)\n      Doc.show(page.appPWErrMsg)\n      return\n    }\n    if (pw !== pwAgain) {\n      page.appPWErrMsg.textContent = intl.prep(intl.ID_PASSWORD_NOT_MATCH)\n      Doc.show(page.appPWErrMsg)\n      return\n    }\n\n    // Clear the notification cache. Useful for development purposes, since\n    // the Application will only clear them on login, which would leave old\n    // browser-cached notifications in place after registering even if the\n    // client db is wiped.\n    app().setNotes([])\n    page.appPW.value = ''\n    page.appPWAgain.value = ''\n    const loaded = app().loading(page.appPWForm)\n    const seed = page.seedInput.value\n    const rememberPass = page.rememberPass.checked\n    const res = await postJSON('/api/init', {\n      pass: pw,\n      seed,\n      rememberPass\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.appPWErrMsg.textContent = res.msg\n      Doc.show(page.appPWErrMsg)\n      return\n    }\n    this.pwCache.pw = pw\n    this.auth()\n    app().updateMenuItemsDisplay()\n    this.newWalletForm.refresh()\n    this.dexAddrForm.refresh()\n    await slideSwap(page.appPWForm, page.dexAddrForm)\n  }\n\n  /* gets the contents of the cert file */\n  async getCertFile () {\n    let cert = ''\n    if (this.dexAddrForm.page.certFile.value) {\n      const files = this.dexAddrForm.page.certFile.files\n      if (files && files.length) cert = await files[0].text()\n    }\n    return cert\n  }\n\n  /* Called after successful registration to a DEX. */\n  async registerDEXSuccess () {\n    await app().fetchUser()\n    app().loadPage('markets')\n  }\n\n  async newWalletCreated (assetID: number) {\n    this.regAssetForm.refresh()\n    const user = await app().fetchUser()\n    if (!user) return\n    const page = this.page\n    const asset = user.assets[assetID]\n    const wallet = asset.wallet\n    const feeAmt = this.currentDEX.regFees[asset.symbol].amount\n\n    if (wallet.synced && wallet.balance.available > feeAmt) {\n      await this.animateConfirmForm(page.newWalletForm)\n      return\n    }\n\n    const txFee = await this.getRegistrationTxFeeEstimate(assetID, page.newWalletForm)\n    this.walletWaitForm.setWallet(wallet, txFee)\n    await slideSwap(page.newWalletForm, page.walletWait)\n  }\n}\n","import { app } from './registry'\nimport Doc from './doc'\nimport BasePage from './basepage'\nimport { LoginForm } from './forms'\n\nexport default class LoginPage extends BasePage {\n  form: HTMLElement\n  loginForm: LoginForm\n\n  constructor (body: HTMLElement) {\n    super()\n    this.form = Doc.idel(body, 'loginForm')\n    Doc.show(this.form)\n    this.loginForm = new LoginForm(this.form, () => { this.loggedIn() })\n    this.loginForm.focus()\n  }\n\n  /* login submits the sign-in form and parses the result. */\n  async loggedIn () {\n    await app().fetchUser()\n    app().loadPage('markets')\n  }\n}\n","import { CoreNote } from './registry'\n\nexport const IGNORE = 0\nexport const DATA = 1\nexport const POKE = 2\nexport const SUCCESS = 3\nexport const WARNING = 4\nexport const ERROR = 5\n\n/*\n * make constructs a new notification. The notification structure is a mirror of\n * the structure of notifications sent from the web server.\n * NOTE: I'm hoping to make this function obsolete, since errors generated in\n * javascript should usually be displayed/cached somewhere better. For example,\n * if the error is generated during submission of a form, the error should be\n * displayed on or near the form itself, not in the notifications.\n */\nexport function make (subject: string, details: string, severity: number): CoreNote {\n  return {\n    subject: subject,\n    details: details,\n    severity: severity,\n    stamp: new Date().getTime(),\n    acked: false,\n    type: 'internal',\n    topic: 'internal',\n    id: ''\n  }\n}\n","import Doc, { WalletIcons } from './doc'\nimport BasePage from './basepage'\nimport { postJSON } from './http'\nimport { NewWalletForm, WalletConfigForm, UnlockWalletForm, bind as bindForm } from './forms'\nimport * as ntfn from './notifications'\nimport State from './state'\nimport * as intl from './locales'\nimport {\n  app,\n  PageElement,\n  SupportedAsset,\n  WalletDefinition,\n  BalanceNote,\n  WalletStateNote,\n  Market,\n  RateNote,\n  WalletState\n} from './registry'\n\nconst bind = Doc.bind\nconst animationLength = 300\nconst traitNewAddresser = 1 << 1\nconst traitLogFiler = 1 << 2\nconst traitRecoverer = 1 << 5\nconst traitWithdrawer = 1 << 6\nconst traitRestorer = 1 << 8\n\nconst activeOrdersErrCode = 35\n\ninterface Actions {\n  connect: HTMLElement\n  unlock: HTMLElement\n  send: HTMLElement\n  deposit: HTMLElement\n  create: HTMLElement\n  rescan: HTMLElement\n  lock: HTMLElement\n  settings: HTMLElement\n}\n\ninterface RowInfo {\n  assetID: number\n  tr: HTMLElement\n  symbol: string\n  name: string\n  stateIcons: WalletIcons\n  actions: Actions\n}\n\ninterface ReconfigRequest {\n  assetID: number\n  walletType: string\n  config: Record<string, string>\n  newWalletPW?: string\n  appPW: string\n}\n\ninterface RescanRecoveryRequest {\n  assetID: number\n  appPW?: string\n  force?: boolean\n}\n\ninterface WalletRestoration {\n  target: string\n  seed: string\n  seedName: string\n  instructions: string\n}\n\nexport default class WalletsPage extends BasePage {\n  body: HTMLElement\n  page: Record<string, PageElement>\n  rowInfos: Record<string, RowInfo>\n  sendAsset: SupportedAsset\n  newWalletForm: NewWalletForm\n  reconfigForm: WalletConfigForm\n  unlockForm: UnlockWalletForm\n  lastFormAsset: number\n  keyup: (e: KeyboardEvent) => void\n  changeWalletPW: boolean\n  depositAsset: number\n  // Methods to switch the item displayed on the right side, with a little\n  // fade-in animation.\n  displayed: HTMLElement\n  animation: Promise<void>\n  openAsset: number\n  walletAsset: number\n  reconfigAsset: number\n  forms: PageElement[]\n  forceReq: RescanRecoveryRequest\n  forceUrl: string\n  currentForm: PageElement\n  restoreInfoCard: HTMLElement\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    const page = this.page = Doc.idDescendants(body)\n\n    Doc.cleanTemplates(page.restoreInfoCard)\n    this.restoreInfoCard = page.restoreInfoCard.cloneNode(true) as HTMLElement\n\n    this.forms = Doc.applySelector(page.forms, ':scope > form')\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { this.closePopups() })\n    })\n    Doc.bind(page.cancelForce, 'click', () => { this.closePopups() })\n    Doc.bind(page.copyAddressBtn, 'click', () => { this.copyAddress() })\n\n    // Read the document, storing some info about each asset's row.\n    const getAction = (row: HTMLElement, name: string) => row.querySelector(`[data-action=${name}]`) as HTMLElement\n    const rowInfos: Record<string, RowInfo> = this.rowInfos = {}\n    const rows = Doc.applySelector(page.walletTable, 'tr')\n    let firstRow\n    for (const tr of rows) {\n      const assetID = parseInt(tr.dataset.assetID || '')\n      rowInfos[assetID] = {\n        assetID: assetID,\n        tr: tr,\n        symbol: tr.dataset.symbol || '',\n        name: tr.dataset.name || '',\n        stateIcons: new WalletIcons(tr),\n        actions: {\n          connect: getAction(tr, 'connect'),\n          unlock: getAction(tr, 'unlock'),\n          send: getAction(tr, 'send'),\n          deposit: getAction(tr, 'deposit'),\n          create: getAction(tr, 'create'),\n          rescan: getAction(tr, 'rescan'),\n          lock: getAction(tr, 'lock'),\n          settings: getAction(tr, 'settings')\n        }\n      }\n      if (!firstRow) firstRow = rowInfos[assetID]\n    }\n\n    // Prepare templates\n    page.marketCard.removeAttribute('id')\n    page.marketCard.remove()\n    page.oneMarket.removeAttribute('id')\n    page.oneMarket.remove()\n\n    // Bind the new wallet form.\n    this.newWalletForm = new NewWalletForm(page.newWalletForm, () => { this.createWalletSuccess() })\n\n    // Bind the wallet reconfig form.\n    this.reconfigForm = new WalletConfigForm(page.reconfigInputs, false)\n\n    // Bind the wallet unlock form.\n    this.unlockForm = new UnlockWalletForm(page.unlockWalletForm, () => { this.openWalletSuccess() })\n\n    // Bind the Send form.\n    bindForm(page.sendForm, page.submitSendForm, () => { this.send() })\n\n    // Bind the wallet reconfiguration submission.\n    bindForm(page.reconfigForm, page.submitReconfig, () => this.reconfig())\n\n    // Bind the row clicks, which shows the available markets for the asset.\n    for (const rowInfo of Object.values(rowInfos)) {\n      bind(rowInfo.tr, 'click', () => {\n        this.showMarkets(rowInfo.assetID)\n      })\n    }\n\n    page.rightBox.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => {\n        this.showMarkets(this.lastFormAsset)\n      })\n    })\n\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) { this.closePopups() }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        if (Doc.isDisplayed(this.page.forms)) {\n          this.closePopups()\n        } else {\n          this.showMarkets(this.lastFormAsset)\n        }\n      }\n    }\n    bind(document, 'keyup', this.keyup)\n\n    bind(page.downloadLogs, 'click', async () => { this.downloadLogs() })\n    bind(page.exportWallet, 'click', async () => { this.displayExportWalletAuth() })\n    bind(page.recoverWallet, 'click', async () => { this.showRecoverWallet() })\n    bindForm(page.exportWalletAuth, page.exportWalletAuthSubmit, async () => { this.exportWalletAuthSubmit() })\n    bindForm(page.recoverWalletConfirm, page.recoverWalletSubmit, () => { this.recoverWallet() })\n    bindForm(page.confirmForce, page.confirmForceSubmit, async () => { this.confirmForceSubmit() })\n\n    // Bind buttons\n    for (const [k, asset] of Object.entries(rowInfos)) {\n      const assetID = parseInt(k) // keys are string asset ID.\n      const a = asset.actions\n      const run = (e: Event, f: (assetID: number, asset: RowInfo) => void) => {\n        e.stopPropagation()\n        f(assetID, asset)\n      }\n      bind(a.connect, 'click', e => { run(e, this.doConnect.bind(this)) })\n      bind(a.send, 'click', e => { run(e, this.showSendForm.bind(this)) })\n      bind(a.deposit, 'click', e => { run(e, this.showDeposit.bind(this)) })\n      bind(a.create, 'click', e => { run(e, this.showNewWallet.bind(this)) })\n      bind(a.rescan, 'click', e => { run(e, this.rescanWallet.bind(this)) })\n      bind(a.unlock, 'click', e => { run(e, this.openWallet.bind(this)) })\n      bind(a.lock, 'click', async e => { run(e, this.lock.bind(this)) })\n      bind(a.settings, 'click', e => { run(e, this.showReconfig.bind(this)) })\n    }\n\n    // New deposit address button.\n    bind(page.newDepAddrBttn, 'click', async () => { this.newDepositAddress() })\n\n    // Clicking on the available amount on the Send form populates the\n    // amount field.\n    bind(page.sendAvail, 'click', () => {\n      const asset = this.sendAsset\n      const bal = asset.wallet.balance.available\n      page.sendAmt.value = String(bal / asset.info.unitinfo.conventional.conversionFactor)\n      this.showFiatValue(asset.id, bal, page.sendValue)\n      // Ensure we don't check subtract checkbox for assets that don't have a\n      // withdraw method.\n      if ((asset.wallet.traits & traitWithdrawer) === 0) page.subtractCheckBox.checked = false\n      else page.subtractCheckBox.checked = true\n    })\n\n    for (const [assetID, wallet] of (Object.entries(app().walletMap) as [any, WalletState][])) {\n      if (!wallet) continue\n      const fiatDisplay = this.page.walletTable.querySelector(`[data-conversion-target=\"${assetID}\"]`) as PageElement\n      if (!fiatDisplay) continue\n      this.showFiatValue(assetID, wallet.balance.available, fiatDisplay)\n    }\n\n    // Display fiat value for current send amount.\n    bind(page.sendAmt, 'input', () => {\n      const asset = this.sendAsset\n      if (!asset) return\n      const amt = parseFloat(page.sendAmt.value || '0')\n      const conversionFactor = asset.info.unitinfo.conventional.conversionFactor\n      this.showFiatValue(asset.id, amt * conversionFactor, page.sendValue)\n    })\n\n    // A link on the wallet reconfiguration form to show/hide the password field.\n    bind(page.showChangePW, 'click', () => {\n      this.changeWalletPW = !this.changeWalletPW\n      this.setPWSettingViz(this.changeWalletPW)\n    })\n\n    // Changing the type of wallet.\n    bind(page.changeWalletTypeSelect, 'change', () => {\n      this.changeWalletType()\n    })\n    bind(page.showChangeType, 'click', () => {\n      if (Doc.isHidden(page.changeWalletType)) {\n        Doc.show(page.changeWalletType, page.changeTypeHideIcon)\n        Doc.hide(page.changeTypeShowIcon)\n        page.changeTypeMsg.textContent = intl.prep(intl.ID_KEEP_WALLET_TYPE)\n      } else this.showReconfig(this.reconfigAsset)\n    })\n\n    if (!firstRow) return\n    this.showMarkets(firstRow.assetID)\n\n    app().registerNoteFeeder({\n      fiatrateupdate: (note: RateNote) => { this.handleRatesNote(note) },\n      balance: (note: BalanceNote) => { this.handleBalanceNote(note) },\n      walletstate: (note: WalletStateNote) => { this.handleWalletStateNote(note) },\n      walletconfig: (note: WalletStateNote) => { this.handleWalletStateNote(note) }\n    })\n  }\n\n  closePopups () {\n    Doc.hide(this.page.forms)\n  }\n\n  async copyAddress () {\n    const page = this.page\n    navigator.clipboard.writeText(page.depositAddress.textContent || '')\n      .then(() => {\n        Doc.show(page.copyAlert)\n        setTimeout(() => {\n          Doc.hide(page.copyAlert)\n        }, 800)\n      })\n      .catch((reason) => {\n        console.error('Unable to copy: ', reason)\n      })\n  }\n\n  /*\n   * setPWSettingViz sets the visibility of the password field section.\n   */\n  setPWSettingViz (visible: boolean) {\n    if (visible) {\n      Doc.hide(this.page.showIcon)\n      Doc.show(this.page.hideIcon, this.page.changePW)\n      this.page.switchPWMsg.textContent = intl.prep(intl.ID_KEEP_WALLET_PASS)\n      return\n    }\n    Doc.hide(this.page.hideIcon, this.page.changePW)\n    Doc.show(this.page.showIcon)\n    this.page.switchPWMsg.textContent = intl.prep(intl.ID_NEW_WALLET_PASS)\n  }\n\n  /*\n   * hideBox hides the displayed box after waiting for the currently running\n   * animation to complete.\n   */\n  async hideBox () {\n    if (this.animation) await this.animation\n    if (!this.displayed) return\n    Doc.hide(this.displayed)\n  }\n\n  /*\n   * showBox shows the box with a fade-in animation.\n   */\n  async showBox (box: HTMLElement, focuser?: PageElement) {\n    box.style.opacity = '0'\n    Doc.show(box)\n    if (focuser) focuser.focus()\n    await Doc.animate(animationLength, progress => {\n      box.style.opacity = `${progress}`\n    }, 'easeOut')\n    box.style.opacity = '1'\n    this.displayed = box\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: PageElement) {\n    const page = this.page\n    this.currentForm = form\n    this.forms.forEach(form => Doc.hide(form))\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  /*\n   * Show the markets box, which lists the markets available for a selected\n   * asset.\n   */\n  async showMarkets (assetID: number) {\n    const page = this.page\n    const box = page.marketsBox\n    const card = page.marketsCard\n    const rowInfo = this.rowInfos[assetID]\n    await this.hideBox()\n    Doc.empty(card)\n    page.marketsFor.textContent = rowInfo.name\n    page.marketsForLogo.src = Doc.logoPath(app().assets[assetID].symbol)\n    for (const [host, xc] of Object.entries(app().user.exchanges)) {\n      let count = 0\n      if (!xc.markets) continue\n      for (const market of Object.values(xc.markets)) {\n        if (market.baseid === assetID || market.quoteid === assetID) count++\n      }\n      if (count === 0) continue\n      const marketBox = page.marketCard.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(marketBox)\n      tmpl.dexTitle.textContent = host\n      card.appendChild(marketBox)\n      if (!xc.markets) continue\n      for (const market of Object.values(xc.markets)) {\n        // Only show markets where this is the base or quote asset.\n        if (market.baseid !== assetID && market.quoteid !== assetID) continue\n        const mBox = page.oneMarket.cloneNode(true) as HTMLElement\n        Doc.safeSelector(mBox, 'span').textContent = prettyMarketName(market)\n        let counterSymbol = market.basesymbol\n        if (market.baseid === assetID) counterSymbol = market.quotesymbol\n        Doc.safeSelector(mBox, 'img').src = Doc.logoPath(counterSymbol)\n        // Bind the click to a load of the markets page.\n        const pageData = { host: host, base: market.baseid, quote: market.quoteid }\n        bind(mBox, 'click', () => { app().loadPage('markets', pageData) })\n        tmpl.markets.appendChild(mBox)\n      }\n    }\n    this.animation = this.showBox(box)\n  }\n\n  /* Show the new wallet form. */\n  async showNewWallet (assetID: number) {\n    const page = this.page\n    const box = page.newWalletForm\n    await this.hideBox()\n    this.walletAsset = this.lastFormAsset = assetID\n    this.newWalletForm.setAsset(assetID)\n    this.animation = this.showBox(box)\n    await this.newWalletForm.loadDefaults()\n  }\n\n  async rescanWallet (assetID: number) {\n    const loaded = app().loading(this.body)\n    const url = '/api/rescanwallet'\n    const req = { assetID: assetID }\n    const res = await postJSON(url, req)\n    loaded()\n    if (res.code === activeOrdersErrCode) {\n      this.forceUrl = url\n      this.forceReq = req\n      this.showConfirmForce()\n      return\n    }\n    app().checkResponse(res)\n  }\n\n  showConfirmForce () {\n    Doc.hide(this.page.confirmForceErr)\n    this.showForm(this.page.confirmForce)\n  }\n\n  showRecoverWallet () {\n    Doc.hide(this.page.recoverWalletErr)\n    this.showForm(this.page.recoverWalletConfirm)\n  }\n\n  /* Show the open wallet form if the password is not cached, and otherwise\n   * attempt to open the wallet.\n   */\n  async openWallet (assetID: number) {\n    if (!State.passwordIsCached()) {\n      this.showOpen(assetID)\n    } else {\n      this.openAsset = assetID\n      const open = {\n        assetID: assetID\n      }\n      const res = await postJSON('/api/openwallet', open)\n      if (app().checkResponse(res)) {\n        this.openWalletSuccess.bind(this)()\n      } else {\n        this.showOpen(assetID, `Error opening wallet: ${res.msg}`)\n      }\n    }\n  }\n\n  /* Show the form used to unlock a wallet. */\n  async showOpen (assetID: number, errorMsg?: string) {\n    const page = this.page\n    this.openAsset = this.lastFormAsset = assetID\n    await this.hideBox()\n    this.unlockForm.refresh(app().assets[assetID])\n    if (errorMsg) this.unlockForm.showErrorOnly(errorMsg)\n    this.animation = this.showBox(page.unlockWalletForm, page.walletPass)\n  }\n\n  /* Show the form used to change wallet configuration settings. */\n  async showReconfig (assetID: number) {\n    const page = this.page\n    Doc.hide(page.changeWalletType, page.changeTypeHideIcon, page.reconfigErr, page.showChangeType, page.changeTypeHideIcon)\n    Doc.hide(page.reconfigErr)\n    // Hide update password section by default\n    this.reconfigAsset = this.lastFormAsset = assetID\n    this.changeWalletPW = false\n    this.setPWSettingViz(this.changeWalletPW)\n    const asset = app().assets[assetID]\n\n    const currentDef = app().currentWalletDefinition(assetID)\n\n    if (asset.info.availablewallets.length > 1) {\n      Doc.empty(page.changeWalletTypeSelect)\n      Doc.show(page.showChangeType, page.changeTypeShowIcon)\n      page.changeTypeMsg.textContent = intl.prep(intl.ID_CHANGE_WALLET_TYPE)\n      for (const wDef of asset.info.availablewallets) {\n        const option = document.createElement('option') as HTMLOptionElement\n        if (wDef.type === currentDef.type) option.selected = true\n        option.value = option.textContent = wDef.type\n        page.changeWalletTypeSelect.appendChild(option)\n      }\n    } else {\n      Doc.hide(page.showChangeType)\n    }\n\n    const wallet = app().walletMap[assetID]\n    if ((wallet.traits & traitLogFiler) !== 0) Doc.show(page.downloadLogs)\n    else Doc.hide(page.downloadLogs)\n    if ((wallet.traits & traitRecoverer) !== 0) Doc.show(page.recoverWallet)\n    else Doc.hide(page.recoverWallet)\n    if ((wallet.traits & traitRestorer)) Doc.show(page.exportWallet)\n    else Doc.hide(page.exportWallet)\n\n    page.recfgAssetLogo.src = Doc.logoPath(asset.symbol)\n    page.recfgAssetName.textContent = asset.info.name\n    await this.hideBox()\n    this.animation = this.showBox(page.reconfigForm)\n    const loaded = app().loading(page.reconfigForm)\n    const res = await postJSON('/api/walletsettings', {\n      assetID: assetID\n    })\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.reconfigErr.textContent = res.msg\n      Doc.show(page.reconfigErr)\n      return\n    }\n    const walletIsActive = app().walletIsActive(assetID)\n    this.reconfigForm.update(currentDef.configopts || [], walletIsActive)\n    this.reconfigForm.setConfig(res.map)\n    this.updateDisplayedReconfigFields(currentDef)\n  }\n\n  changeWalletType () {\n    const page = this.page\n    const walletType = page.changeWalletTypeSelect.value || ''\n    const walletDef = app().walletDefinition(this.reconfigAsset, walletType)\n    this.reconfigForm.update(walletDef.configopts || [])\n    this.updateDisplayedReconfigFields(walletDef)\n  }\n\n  updateDisplayedReconfigFields (walletDef: WalletDefinition) {\n    if (walletDef.seeded) {\n      Doc.hide(this.page.showChangePW)\n      this.changeWalletPW = false\n      this.setPWSettingViz(false)\n    } else Doc.show(this.page.showChangePW)\n  }\n\n  /* Display a deposit address. */\n  async showDeposit (assetID: number) {\n    const page = this.page\n    Doc.hide(page.depositErr)\n    const box = page.deposit\n    const asset = app().assets[assetID]\n    page.depositLogo.src = Doc.logoPath(asset.symbol)\n    const wallet = app().walletMap[assetID]\n    this.depositAsset = this.lastFormAsset = assetID\n    if (!wallet) {\n      app().notify(ntfn.make('Cannot retrieve deposit address.', `No wallet found for ${asset.info.name}`, ntfn.ERROR)) // TODO: translate\n      return\n    }\n    await this.hideBox()\n    page.depositName.textContent = asset.info.name\n    page.depositAddress.textContent = wallet.address\n    page.qrcode.src = `/generateqrcode?address=${wallet.address}`\n    if ((wallet.traits & traitNewAddresser) !== 0) Doc.show(page.newDepAddrBttn)\n    else Doc.hide(page.newDepAddrBttn)\n    this.animation = this.showBox(box)\n  }\n\n  /* Fetch a new address from the wallet. */\n  async newDepositAddress () {\n    const page = this.page\n    Doc.hide(page.depositErr)\n    const loaded = app().loading(page.deposit)\n    const res = await postJSON('/api/depositaddress', {\n      assetID: this.depositAsset\n    })\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.depositErr.textContent = res.msg\n      Doc.show(page.depositErr)\n      return\n    }\n    page.depositAddress.textContent = res.address\n    page.qrcode.src = `/generateqrcode?address=${res.address}`\n  }\n\n  /* Show the form to either send or withdraw funds. */\n  async showSendForm (assetID: number) {\n    const page = this.page\n    const box = page.sendForm\n    const asset = this.sendAsset = app().assets[assetID]\n    this.lastFormAsset = assetID\n    const wallet = app().walletMap[assetID]\n    if (!wallet) {\n      app().notify(ntfn.make('Cannot send/withdraw.', `No wallet found for ${asset.info.name}`, ntfn.ERROR))\n    }\n    await this.hideBox()\n\n    Doc.hide(page.senderOnlyHelpText)\n    Doc.hide(page.toggleSubtract)\n    page.subtractCheckBox.checked = false\n\n    const isWithdrawer = (wallet.traits & traitWithdrawer) !== 0\n    if (!isWithdrawer) {\n      Doc.show(page.senderOnlyHelpText)\n      page.subtractCheckBox.checked = false\n    } else {\n      Doc.show(page.toggleSubtract)\n    }\n\n    page.sendAddr.value = ''\n    page.sendAmt.value = ''\n    page.sendPW.value = ''\n    page.sendErr.textContent = ''\n\n    this.showFiatValue(asset.id, 0, page.sendValue)\n    page.sendAvail.textContent = Doc.formatFullPrecision(wallet.balance.available, asset.info.unitinfo)\n    page.sendLogo.src = Doc.logoPath(asset.symbol)\n    page.sendName.textContent = asset.info.name\n    // page.sendFee.textContent = wallet.feerate\n    // page.sendUnit.textContent = wallet.units\n    box.dataset.assetID = String(assetID)\n    this.animation = this.showBox(box, page.walletPass)\n  }\n\n  /* doConnect connects to a wallet via the connectwallet API route. */\n  async doConnect (assetID: number) {\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/connectwallet', {\n      assetID: assetID\n    })\n    loaded()\n    if (!app().checkResponse(res)) return\n    const rowInfo = this.rowInfos[assetID]\n    Doc.hide(rowInfo.actions.connect)\n  }\n\n  /* createWalletSuccess is the success callback for wallet creation. */\n  async createWalletSuccess () {\n    const rowInfo = this.rowInfos[this.walletAsset]\n    this.showMarkets(rowInfo.assetID)\n    await app().fetchUser()\n    await app().loadPage('wallets')\n  }\n\n  /* openWalletSuccess is the success callback for wallet unlocking. */\n  async openWalletSuccess () {\n    const rowInfo = this.rowInfos[this.openAsset]\n    const a = rowInfo.actions\n    Doc.show(a.send, a.deposit)\n    Doc.hide(a.unlock, a.connect)\n    if (app().walletMap[rowInfo.assetID].encrypted) {\n      Doc.show(a.lock)\n    }\n    this.showMarkets(this.openAsset)\n  }\n\n  /* send submits the send form to the API. */\n  async send () {\n    const page = this.page\n    Doc.hide(page.sendErr)\n    const assetID = parseInt(page.sendForm.dataset.assetID || '')\n    const subtract = page.subtractCheckBox.checked || false\n    const conversionFactor = app().unitInfo(assetID).conventional.conversionFactor\n    const open = {\n      assetID: assetID,\n      address: page.sendAddr.value,\n      subtract: subtract,\n      value: Math.round(parseFloat(page.sendAmt.value || '') * conversionFactor),\n      pw: page.sendPW.value\n    }\n    const loaded = app().loading(page.sendForm)\n    const res = await postJSON('/api/send', open)\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.sendErr.textContent = res.msg\n      Doc.show(page.sendErr)\n      return\n    }\n    this.showMarkets(assetID)\n  }\n\n  /* update wallet configuration */\n  async reconfig () {\n    const page = this.page\n    Doc.hide(page.reconfigErr)\n    if (!page.appPW.value && !State.passwordIsCached()) {\n      page.reconfigErr.textContent = intl.prep(intl.ID_NO_APP_PASS_ERROR_MSG)\n      Doc.show(page.reconfigErr)\n      return\n    }\n\n    let walletType = app().currentWalletDefinition(this.reconfigAsset).type\n    if (!Doc.isHidden(page.changeWalletType)) {\n      walletType = page.changeWalletTypeSelect.value || ''\n    }\n\n    const loaded = app().loading(page.reconfigForm)\n    const req: ReconfigRequest = {\n      assetID: this.reconfigAsset,\n      config: this.reconfigForm.map(),\n      appPW: page.appPW.value || '',\n      walletType: walletType\n    }\n    if (this.changeWalletPW) req.newWalletPW = page.newPW.value\n    const res = await postJSON('/api/reconfigurewallet', req)\n    page.appPW.value = ''\n    page.newPW.value = ''\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.reconfigErr.textContent = res.msg\n      Doc.show(page.reconfigErr)\n      return\n    }\n    this.showMarkets(this.reconfigAsset)\n  }\n\n  /* lock instructs the API to lock the wallet. */\n  async lock (assetID: number, asset: RowInfo) {\n    const page = this.page\n    const loaded = app().loading(page.newWalletForm)\n    const res = await postJSON('/api/closewallet', { assetID: assetID })\n    loaded()\n    if (!app().checkResponse(res)) return\n    const a = asset.actions\n    Doc.hide(a.send, a.lock, a.deposit)\n    Doc.show(a.unlock)\n  }\n\n  async downloadLogs () {\n    const search = new URLSearchParams('')\n    search.append('assetid', `${this.reconfigAsset}`)\n    const url = new URL(window.location.href)\n    url.search = search.toString()\n    url.pathname = '/wallets/logfile'\n    window.open(url.toString())\n  }\n\n  // displayExportWalletAuth displays a form to warn the user about the\n  // dangers of exporting a wallet, and asks them to enter their password.\n  async displayExportWalletAuth () {\n    const page = this.page\n    Doc.hide(page.exportWalletErr)\n    page.exportWalletPW.value = ''\n    this.showForm(page.exportWalletAuth)\n  }\n\n  // exportWalletAuthSubmit is called after the user enters their password to\n  // authorize looking up the information to restore their wallet in an\n  // external wallet.\n  async exportWalletAuthSubmit () {\n    const page = this.page\n    const req = {\n      assetID: this.reconfigAsset,\n      pass: page.exportWalletPW.value\n    }\n    const url = '/api/restorewalletinfo'\n    const loaded = app().loading(page.forms)\n    const res = await postJSON(url, req)\n    loaded()\n    if (app().checkResponse(res)) {\n      page.exportWalletPW.value = ''\n      this.displayRestoreWalletInfo(res.restorationinfo)\n    } else {\n      page.exportWalletErr.textContent = res.msg\n      Doc.show(page.exportWalletErr)\n    }\n  }\n\n  // displayRestoreWalletInfo displays the information needed to restore a\n  // wallet in external wallets.\n  async displayRestoreWalletInfo (info: WalletRestoration[]) {\n    const page = this.page\n    Doc.empty(page.restoreInfoCardsList)\n    for (const wr of info) {\n      const card = this.restoreInfoCard.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(card)\n      tmpl.name.textContent = wr.target\n      tmpl.seed.textContent = wr.seed\n      tmpl.seedName.textContent = `${wr.seedName}:`\n      tmpl.instructions.textContent = wr.instructions\n      page.restoreInfoCardsList.appendChild(card)\n    }\n    this.showForm(page.restoreWalletInfo)\n  }\n\n  async recoverWallet () {\n    const page = this.page\n    Doc.hide(page.recoverWalletErr)\n    const req = {\n      assetID: this.reconfigAsset,\n      appPW: page.recoverWalletPW.value\n    }\n    page.recoverWalletPW.value = ''\n    const url = '/api/recoverwallet'\n    const loaded = app().loading(page.forms)\n    const res = await postJSON(url, req)\n    loaded()\n    if (res.code === activeOrdersErrCode) {\n      this.forceUrl = url\n      this.forceReq = req\n      this.showConfirmForce()\n    } else if (app().checkResponse(res)) {\n      this.closePopups()\n    } else {\n      page.recoverWalletErr.textContent = res.msg\n      Doc.show(page.recoverWalletErr)\n    }\n  }\n\n  /*\n   * confirmForceSubmit resubmits either the recover or rescan requests with\n   * force set to true. These two requests require force to be set to true if\n   * they are called while the wallet is managing active orders.\n   */\n  async confirmForceSubmit () {\n    const page = this.page\n    this.forceReq.force = true\n    const loaded = app().loading(page.forms)\n    const res = await postJSON(this.forceUrl, this.forceReq)\n    loaded()\n    if (app().checkResponse(res)) this.closePopups()\n    else {\n      page.confirmForceErr.textContent = res.msg\n      Doc.show(page.confirmForceErr)\n    }\n  }\n\n  /* handleBalance handles notifications updating a wallet's balance and assets'\n     value in default fiat rate.\n  . */\n  handleBalanceNote (note: BalanceNote) {\n    const td = Doc.safeSelector(this.page.walletTable, `[data-balance-target=\"${note.assetID}\"]`)\n    td.textContent = Doc.formatFullPrecision(note.balance.available, app().unitInfo(note.assetID))\n    const fiatDisplay = Doc.safeSelector(this.page.walletTable, `[data-conversion-target=\"${note.assetID}\"]`)\n    if (!fiatDisplay) return\n    this.showFiatValue(note.assetID, note.balance.available, fiatDisplay)\n  }\n\n  /* handleRatesNote handles fiat rate notifications, updating the fiat value of\n   *  all supported assets.\n   */\n  handleRatesNote (note: RateNote) {\n    app().fiatRatesMap = note.fiatRates\n    for (const [assetID, wallet] of (Object.entries(app().walletMap) as [any, WalletState][])) {\n      if (!wallet) continue\n      const fiatDisplay = this.page.walletTable.querySelector(`[data-conversion-target=\"${assetID}\"]`) as PageElement\n      if (!fiatDisplay) continue\n      this.showFiatValue(assetID, wallet.balance.available, fiatDisplay)\n    }\n  }\n\n  // showFiatValue displays the fiat equivalent for the provided amount.\n  showFiatValue (assetID: number, amount: number, display: PageElement) {\n    if (display) {\n      const rate = app().fiatRatesMap[assetID]\n      display.textContent = Doc.formatFiatConversion(amount, rate, app().unitInfo(assetID))\n      if (rate) Doc.show(display.parentElement as Element)\n      else Doc.hide(display.parentElement as Element)\n    }\n  }\n\n  /*\n   * handleWalletStateNote is a handler for both the 'walletstate' and\n   * 'walletconfig' notifications.\n   */\n  handleWalletStateNote (note: WalletStateNote) {\n    this.rowInfos[note.wallet.assetID].stateIcons.readWallet(note.wallet)\n    const fiatDisplay = this.page.walletTable.querySelector(`[data-conversion-target=\"${note.wallet.assetID}\"]`) as PageElement\n    if (!fiatDisplay) return\n    this.showFiatValue(note.wallet.assetID, note.wallet.balance.available, fiatDisplay)\n  }\n\n  /*\n   * unload is called by the Application when the user navigates away from\n   * the /wallets page.\n   */\n  unload () {\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n}\n\n/*\n * Given a market object as created with makeMarket, prettyMarketName will\n * create a string ABC-XYZ, where ABC and XYZ are the upper-case ticker symbols\n * for the base and quote assets respectively.\n */\nfunction prettyMarketName (market: Market) {\n  return `${market.basesymbol.toUpperCase()}-${market.quotesymbol.toUpperCase()}`\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport State from './state'\nimport { postJSON } from './http'\nimport * as forms from './forms'\nimport * as intl from './locales'\nimport {\n  app,\n  Exchange,\n  PageElement,\n  PasswordCache\n} from './registry'\n\nconst animationLength = 300\n\nexport default class SettingsPage extends BasePage {\n  body: HTMLElement\n  currentDEX: Exchange\n  page: Record<string, PageElement>\n  forms: PageElement[]\n  fiatRateSources: PageElement[]\n  regAssetForm: forms.FeeAssetSelectionForm\n  confirmRegisterForm: forms.ConfirmRegistrationForm\n  newWalletForm: forms.NewWalletForm\n  walletWaitForm: forms.WalletWaitForm\n  dexAddrForm: forms.DEXAddressForm\n  currentForm: PageElement\n  pwCache: PasswordCache\n  defaultTLSText: string\n  keyup: (e: KeyboardEvent) => void\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    this.defaultTLSText = 'none selected'\n    const page = this.page = Doc.idDescendants(body)\n\n    this.forms = Doc.applySelector(page.forms, ':scope > form')\n    this.fiatRateSources = Doc.applySelector(page.fiatRateSources, 'input[type=checkbox]')\n\n    Doc.bind(page.darkMode, 'click', () => {\n      State.dark(page.darkMode.checked || false)\n      if (page.darkMode.checked) {\n        document.body.classList.add('dark')\n      } else {\n        document.body.classList.remove('dark')\n      }\n    })\n\n    Doc.bind(page.showPokes, 'click', () => {\n      const show = page.showPokes.checked || false\n      State.setCookie('popups', show ? '1' : '0')\n      app().showPopups = show\n    })\n\n    page.commitHash.textContent = app().commitHash.substring(0, 7)\n    Doc.bind(page.addADex, 'click', () => {\n      this.dexAddrForm.refresh()\n      this.showForm(page.dexAddrForm)\n    })\n\n    this.fiatRateSources.forEach(src => {\n      Doc.bind(src, 'change', async () => {\n        const res = await postJSON('/api/toggleratesource', {\n          disable: !src.checked,\n          source: src.value\n        })\n        if (!app().checkResponse(res)) {\n          src.checked = !src.checked\n        }\n        // Update asset rate values and disable conversion status.\n        await app().fetchUser()\n      })\n    })\n\n    // Asset selection\n    this.regAssetForm = new forms.FeeAssetSelectionForm(page.regAssetForm, async assetID => {\n      this.confirmRegisterForm.setAsset(assetID)\n\n      const asset = app().assets[assetID]\n      const wallet = asset.wallet\n      if (wallet) {\n        const fee = this.currentDEX.regFees[asset.symbol]\n        if (wallet.synced && wallet.balance.available > fee.amount) {\n          this.animateConfirmForm(page.regAssetForm)\n          return\n        }\n        const txFee = await this.getRegistrationTxFeeEstimate(assetID, page.regAssetForm)\n        this.walletWaitForm.setWallet(wallet, txFee)\n        forms.slideSwap(page.regAssetForm, page.walletWait)\n        return\n      }\n\n      this.newWalletForm.setAsset(assetID)\n      this.newWalletForm.loadDefaults()\n      this.currentForm = page.newWalletForm\n      forms.slideSwap(page.regAssetForm, page.newWalletForm)\n    })\n\n    // Approve fee payment\n    this.confirmRegisterForm = new forms.ConfirmRegistrationForm(page.confirmRegForm, () => {\n      this.registerDEXSuccess()\n    }, () => {\n      this.animateRegAsset(page.confirmRegForm)\n    }, this.pwCache)\n\n    // Create a new wallet\n    this.newWalletForm = new forms.NewWalletForm(\n      page.newWalletForm,\n      assetID => this.newWalletCreated(assetID),\n      this.pwCache,\n      () => this.animateRegAsset(page.newWalletForm)\n    )\n\n    this.walletWaitForm = new forms.WalletWaitForm(page.walletWait, () => {\n      this.animateConfirmForm(page.walletWait)\n    }, () => { this.animateRegAsset(page.walletWait) })\n\n    // Enter an address for a new DEX\n    this.dexAddrForm = new forms.DEXAddressForm(page.dexAddrForm, async (xc: Exchange, certFile: string) => {\n      this.currentDEX = xc\n      this.confirmRegisterForm.setExchange(xc, certFile)\n      this.walletWaitForm.setExchange(xc)\n      this.regAssetForm.setExchange(xc)\n      this.animateRegAsset(page.dexAddrForm)\n    })\n\n    Doc.bind(page.importAccount, 'click', () => this.prepareAccountImport(page.authorizeAccountImportForm))\n    forms.bind(page.authorizeAccountImportForm, page.authorizeImportAccountConfirm, () => this.importAccount())\n\n    Doc.bind(page.changeAppPW, 'click', () => this.showForm(page.changeAppPWForm))\n    forms.bind(page.changeAppPWForm, page.submitNewPW, () => this.changeAppPW())\n\n    Doc.bind(page.accountFile, 'change', () => this.onAccountFileChange())\n    Doc.bind(page.removeAccount, 'click', () => this.clearAccountFile())\n    Doc.bind(page.addAccount, 'click', () => page.accountFile.click())\n\n    Doc.bind(page.exportSeed, 'click', () => this.showForm(page.exportSeedAuth))\n    forms.bind(page.exportSeedAuth, page.exportSeedSubmit, () => this.submitExportSeedReq())\n\n    const closePopups = () => {\n      Doc.hide(page.forms)\n      page.exportSeedPW.value = ''\n      page.seedDiv.textContent = ''\n    }\n\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) { closePopups() }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        closePopups()\n      }\n    }\n    Doc.bind(document, 'keyup', this.keyup)\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { closePopups() })\n    })\n  }\n\n  // Retrieve an estimate for the tx fee needed to pay the registration fee.\n  async getRegistrationTxFeeEstimate (assetID: number, form: HTMLElement) {\n    const cert = await this.getCertFile()\n    const loaded = app().loading(form)\n    const res = await postJSON('/api/regtxfee', {\n      addr: this.currentDEX.host,\n      cert: cert,\n      asset: assetID\n    })\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      return 0\n    }\n    return res.txfee\n  }\n\n  async newWalletCreated (assetID: number) {\n    const user = await app().fetchUser()\n    if (!user) return\n    const page = this.page\n    const asset = user.assets[assetID]\n    const wallet = asset.wallet\n    const feeAmt = this.currentDEX.regFees[asset.symbol].amount\n\n    if (wallet.synced && wallet.balance.available > feeAmt) {\n      await this.animateConfirmForm(page.newWalletForm)\n      return\n    }\n\n    const txFee = await this.getRegistrationTxFeeEstimate(assetID, page.newWalletForm)\n    this.walletWaitForm.setWallet(wallet, txFee)\n    this.currentForm = page.walletWait\n    await forms.slideSwap(page.newWalletForm, page.walletWait)\n  }\n\n  async onAccountFileChange () {\n    const page = this.page\n    const files = page.accountFile.files\n    if (!files || !files.length) return\n    page.selectedAccount.textContent = files[0].name\n    Doc.show(page.removeAccount)\n    Doc.hide(page.addAccount)\n  }\n\n  /* clearAccountFile cleanup accountFile value and selectedAccount text */\n  clearAccountFile () {\n    const page = this.page\n    page.accountFile.value = ''\n    page.selectedAccount.textContent = 'none selected'\n    Doc.hide(page.removeAccount)\n    Doc.show(page.addAccount)\n  }\n\n  async prepareAccountImport (authorizeAccountImportForm: HTMLElement) {\n    const page = this.page\n    page.importAccountErr.textContent = ''\n    this.showForm(authorizeAccountImportForm)\n  }\n\n  // importAccount imports the account\n  async importAccount () {\n    const page = this.page\n    const pw = page.importAccountAppPass.value\n    page.importAccountAppPass.value = ''\n    let accountString = ''\n    if (page.accountFile.value) {\n      const files = page.accountFile.files\n      if (!files || !files.length) {\n        console.error('importAccount: no file specified')\n        return\n      }\n      accountString = await files[0].text()\n    }\n    let account\n    try {\n      account = JSON.parse(accountString)\n    } catch (e) {\n      page.importAccountErr.textContent = e.message\n      Doc.show(page.importAccountErr)\n      return\n    }\n    if (typeof account === 'undefined') {\n      page.importAccountErr.textContent = intl.prep(intl.ID_ACCT_UNDEFINED)\n      Doc.show(page.importAccountErr)\n      return\n    }\n    const req = {\n      pw: pw,\n      account: account\n    }\n    const loaded = app().loading(this.body)\n    const importResponse = await postJSON('/api/importaccount', req)\n    loaded()\n    if (!app().checkResponse(importResponse)) {\n      page.importAccountErr.textContent = importResponse.msg\n      Doc.show(page.importAccountErr)\n      return\n    }\n    const loginResponse = await postJSON('/api/login', { pass: pw })\n    if (!app().checkResponse(loginResponse)) {\n      page.importAccountErr.textContent = loginResponse.msg\n      Doc.show(page.importAccountErr)\n      return\n    }\n    await app().fetchUser()\n    Doc.hide(page.forms)\n    // Initial method of displaying imported account.\n    window.location.reload()\n  }\n\n  async submitExportSeedReq () {\n    const page = this.page\n    const pw = page.exportSeedPW.value\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/exportseed', { pass: pw })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.exportAccountErr.textContent = res.msg\n      Doc.show(page.exportSeedE)\n      return\n    }\n    page.exportSeedPW.value = ''\n    page.seedDiv.textContent = res.seed\n    this.showForm(page.authorizeSeedDisplay)\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    const page = this.page\n    this.currentForm = form\n    this.forms.forEach(form => Doc.hide(form))\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  /* gets the contents of the cert file */\n  async getCertFile () {\n    let cert = ''\n    if (this.dexAddrForm.page.certFile.value) {\n      const files = this.dexAddrForm.page.certFile.files\n      if (files && files.length) cert = await files[0].text()\n    }\n    return cert\n  }\n\n  /* Called after successful registration to a DEX. */\n  async registerDEXSuccess () {\n    const page = this.page\n    Doc.hide(page.forms)\n    await app().fetchUser()\n    // Initial method of displaying added dex.\n    window.location.reload()\n  }\n\n  /* Change application password  */\n  async changeAppPW () {\n    const page = this.page\n    Doc.hide(page.changePWErrMsg)\n\n    const clearValues = () => {\n      page.appPW.value = ''\n      page.newAppPW.value = ''\n      page.confirmNewPW.value = ''\n    }\n    // Ensure password fields are nonempty.\n    if (!page.appPW.value || !page.newAppPW.value || !page.confirmNewPW.value) {\n      page.changePWErrMsg.textContent = intl.prep(intl.ID_NO_APP_PASS_ERROR_MSG)\n      Doc.show(page.changePWErrMsg)\n      clearValues()\n      return\n    }\n    // Ensure password confirmation matches.\n    if (page.newAppPW.value !== page.confirmNewPW.value) {\n      page.changePWErrMsg.textContent = intl.prep(intl.ID_PASSWORD_NOT_MATCH)\n      Doc.show(page.changePWErrMsg)\n      clearValues()\n      return\n    }\n    const loaded = app().loading(page.changeAppPW)\n    const req = {\n      appPW: page.appPW.value,\n      newAppPW: page.newAppPW.value\n    }\n    clearValues()\n    const res = await postJSON('/api/changeapppass', req)\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.changePWErrMsg.textContent = res.msg\n      Doc.show(page.changePWErrMsg)\n      return\n    }\n    Doc.hide(page.forms)\n  }\n\n  /*\n   * unload is called by the Application when the user navigates away from\n   * the /settings page.\n   */\n  unload () {\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n\n  /* Swap in the asset selection form and run the animation. */\n  async animateRegAsset (oldForm: HTMLElement) {\n    Doc.hide(oldForm)\n    const form = this.page.regAssetForm\n    this.currentForm = form\n    this.regAssetForm.animate()\n    Doc.show(form)\n  }\n\n  /* Swap in the confirmation form and run the animation. */\n  async animateConfirmForm (oldForm: HTMLElement) {\n    this.confirmRegisterForm.animate()\n    const form = this.page.confirmRegForm\n    this.currentForm = form\n    Doc.hide(oldForm)\n    Doc.show(form)\n  }\n}\n","import {\n  MarketOrderBook,\n  MiniOrder\n} from './registry'\n\nexport default class OrderBook {\n  base: number\n  baseSymbol: string\n  quote: number\n  quoteSymbol: string\n  buys: MiniOrder[]\n  sells: MiniOrder[]\n\n  constructor (mktBook: MarketOrderBook, baseSymbol: string, quoteSymbol: string) {\n    this.base = mktBook.base\n    this.baseSymbol = baseSymbol\n    this.quote = mktBook.quote\n    this.quoteSymbol = quoteSymbol\n    // Books are sorted mid-gap first.\n    this.buys = mktBook.book.buys || []\n    this.sells = mktBook.book.sells || []\n  }\n\n  /* add adds an order to the order book. */\n  add (ord: MiniOrder) {\n    if (ord.qtyAtomic === 0) {\n      // TODO: Somebody, for the love of god, figure out why the hell this helps\n      // with the ghost orders problem. As far as I know, this order is a booked\n      // order that had more than one match in an epoch and completely filled.\n      // Because the first match didn't exhaust the order, there would be a\n      // 'update_remaining' notification scheduled for the order. But by the\n      // time OrderRouter generates the notification long after matching, the\n      // order has zero qty left to fill. It's all good though, kinda, because\n      // the notification is quickly followed with an 'unbook_order'\n      // notification. I have tried my damnedest to catch an update_remaining\n      // note without an accompanying unbook_order note, and have thus failed.\n      // Yet, this fix somehow seems to work. It's infuriating, tbh.\n      window.log('zeroqty', 'zero quantity order encountered', ord)\n      return\n    }\n    const side = ord.sell ? this.sells : this.buys\n    side.splice(findIdx(side, ord.rate, !ord.sell), 0, ord)\n  }\n\n  /* remove removes an order from the order book. */\n  remove (token: string) {\n    if (this.removeFromSide(this.sells, token)) return\n    this.removeFromSide(this.buys, token)\n  }\n\n  /* removeFromSide removes an order from the list of orders. */\n  removeFromSide (side: MiniOrder[], token: string) {\n    const [ord, i] = this.findOrder(side, token)\n    if (ord) {\n      side.splice(i, 1)\n      return true\n    }\n    return false\n  }\n\n  /* findOrder finds an order in a specified side */\n  findOrder (side: MiniOrder[], token: string): [MiniOrder | null, number] {\n    for (let i = 0; i < side.length; i++) {\n      if (side[i].token === token) {\n        return [side[i], i]\n      }\n    }\n    return [null, -1]\n  }\n\n  /* updates the remaining quantity of an order. */\n  updateRemaining (token: string, qty: number, qtyAtomic: number) {\n    if (this.updateRemainingSide(this.sells, token, qty, qtyAtomic)) return\n    this.updateRemainingSide(this.buys, token, qty, qtyAtomic)\n  }\n\n  /*\n   * updateRemainingSide looks for the order in the side and updates the\n   * quantity, returning true on success, false if order not found.\n   */\n  updateRemainingSide (side: MiniOrder[], token: string, qty: number, qtyAtomic: number) {\n    const ord = this.findOrder(side, token)[0]\n    if (ord) {\n      ord.qty = qty\n      ord.qtyAtomic = qtyAtomic\n      return true\n    }\n    return false\n  }\n\n  /*\n   * setEpoch sets the current epoch and clear any orders from previous epochs.\n   */\n  setEpoch (epochIdx: number) {\n    const approve = (ord: MiniOrder) => ord.epoch === undefined || ord.epoch === 0 || ord.epoch === epochIdx\n    this.sells = this.sells.filter(approve)\n    this.buys = this.buys.filter(approve)\n  }\n\n  /* empty will return true if both the buys and sells lists are empty. */\n  empty () {\n    return !this.sells.length && !this.buys.length\n  }\n\n  /* count is the total count of both buy and sell orders. */\n  count () {\n    return this.sells.length + this.buys.length\n  }\n\n  /* bestGapOrder will return the best non-epoch order if one exists, or the\n   * best epoch order if there are only epoch orders, or null if there are no\n   * orders.\n   */\n  bestGapOrder (side: MiniOrder[]) {\n    let best = null\n    for (const ord of side) {\n      if (!ord.epoch) return ord\n      if (!best) {\n        best = ord\n      }\n    }\n    return best\n  }\n\n  bestGapBuy () {\n    return this.bestGapOrder(this.buys)\n  }\n\n  bestGapSell () {\n    return this.bestGapOrder(this.sells)\n  }\n}\n\n/*\n * findIdx find the index at which to insert the order into the list of orders.\n */\nfunction findIdx (side: MiniOrder[], rate: number, less: boolean): number {\n  for (let i = 0; i < side.length; i++) {\n    if ((side[i].rate < rate) === less) return i\n  }\n  return side.length\n}\n","import Doc from './doc'\nimport { RateEncodingFactor } from './orderutil'\nimport OrderBook from './orderbook'\nimport State from './state'\nimport { UnitInfo, Market, Candle, CandlesPayload } from './registry'\n\nconst bind = Doc.bind\nconst unbind = Doc.unbind\nconst PIPI = 2 * Math.PI\nconst plusChar = String.fromCharCode(59914)\nconst minusChar = String.fromCharCode(59915)\n\ninterface Point {\n  x: number\n  y: number\n}\n\ninterface MinMax {\n  min: number\n  max: number\n}\n\ninterface Label {\n  val: number\n  txt: string\n}\n\ninterface LabelSet {\n  widest?: number\n  lbls: Label[]\n}\n\ninterface Translator {\n    x: (x: number) => number\n    y: (y: number) => number\n    unx: (x: number) => number\n    uny: (y: number) => number\n    w: (w: number) => number\n    h: (h: number) => number\n    dataCoords: (f: () => void) => void\n}\n\nexport interface MouseReport {\n  rate: number\n  depth: number\n  dotColor: string\n  hoverMarkers: number[]\n}\n\nexport interface VolumeReport {\n  buyBase: number\n  buyQuote: number\n  sellBase: number\n  sellQuote: number\n}\n\nexport interface DepthReporters {\n  mouse: (r: MouseReport | null) => void\n  click: (x: number) => void\n  volume: (r: VolumeReport) => void\n  zoom: (z: number) => void\n}\n\nexport interface CandleReporters {\n  mouse: (r: Candle | null) => void\n}\n\nexport interface ChartReporters {\n  resize: () => void,\n  click: (e: MouseEvent) => void,\n  zoom: (bigger: boolean) => void\n}\n\nexport interface DepthLine {\n  rate: number\n  color: string\n}\n\nexport interface DepthMarker {\n  rate: number\n  active: boolean\n}\n\ninterface DepthMark extends DepthMarker {\n  qty: number\n  sell: boolean\n}\n\ninterface Theme {\n  axisLabel: string\n  gridBorder: string\n  gridLines: string\n  gapLine: string\n  value: string\n  zoom: string\n  zoomHover: string\n  sellLine: string\n  buyLine: string\n  sellFill: string\n  buyFill: string\n  crosshairs: string\n  legendFill: string\n  legendText: string\n}\n\nconst darkTheme: Theme = {\n  axisLabel: '#b1b1b1',\n  gridBorder: '#3a3a3a',\n  gridLines: '#2a2a2a',\n  gapLine: '#6b6b6b',\n  value: '#9a9a9a',\n  zoom: '#5b5b5b',\n  zoomHover: '#aaa',\n  sellLine: '#ae3333',\n  buyLine: '#05a35a',\n  sellFill: '#591a1a',\n  buyFill: '#02572f',\n  crosshairs: '#888',\n  legendFill: 'black',\n  legendText: '#d5d5d5'\n}\n\nconst lightTheme: Theme = {\n  axisLabel: '#1b1b1b',\n  gridBorder: '#3a3a3a',\n  gridLines: '#dadada',\n  gapLine: '#595959',\n  value: '#4d4d4d',\n  zoom: '#777',\n  zoomHover: '#333',\n  sellLine: '#99302b',\n  buyLine: '#207a46',\n  sellFill: '#bd5959',\n  buyFill: '#4cad75',\n  crosshairs: '#595959',\n  legendFill: '#e6e6e6',\n  legendText: '#1b1b1b'\n}\n\n// Chart is the base class for charts.\nclass Chart {\n  parent: HTMLElement\n  report: ChartReporters\n  theme: Theme\n  canvas: HTMLCanvasElement\n  visible: boolean\n  ctx: CanvasRenderingContext2D\n  mousePos: Point | null\n  rect: DOMRect\n  wheelLimiter: number | null\n  boundResizer: () => void\n  plotRegion: Region\n  xRegion: Region\n  yRegion: Region\n  dataExtents: Extents\n\n  constructor (parent: HTMLElement, reporters: ChartReporters) {\n    this.parent = parent\n    this.report = reporters\n    this.theme = State.isDark() ? darkTheme : lightTheme\n    this.canvas = document.createElement('canvas')\n    this.visible = true\n    parent.appendChild(this.canvas)\n    const ctx = this.canvas.getContext('2d')\n    if (!ctx) {\n      console.error('error getting canvas context')\n      return\n    }\n    this.ctx = ctx\n    this.ctx.textAlign = 'center'\n    this.ctx.textBaseline = 'middle'\n    this.setZoomBttns()\n    // Mouse handling\n    this.mousePos = null\n    bind(this.canvas, 'mousemove', (e: MouseEvent) => {\n      // this.rect will be set in resize().\n      this.mousePos = {\n        x: e.clientX - this.rect.left,\n        y: e.clientY - this.rect.y\n      }\n      this.draw()\n    })\n    bind(this.canvas, 'mouseleave', () => {\n      this.mousePos = null\n      this.draw()\n    })\n    // Scrolling by wheel is smoother when the rate is slightly limited.\n    this.wheelLimiter = null\n    bind(this.canvas, 'wheel', (e: WheelEvent) => { this.wheel(e) })\n    this.boundResizer = () => { this.resize(parent.clientHeight) }\n    bind(window, 'resize', this.boundResizer)\n    bind(this.canvas, 'click', (e: MouseEvent) => { this.click(e) })\n  }\n\n  wheeled () {\n    this.wheelLimiter = window.setTimeout(() => { this.wheelLimiter = null }, 100)\n  }\n\n  /* clear the canvas. */\n  clear () {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n  }\n\n  /* draw calls the child class's render method. */\n  draw () {\n    this.render()\n  }\n\n  // setZoomBttns is run before drawing and should be used for setup of zoom\n  // buttons.\n  setZoomBttns () {\n    // should be implemented by inheriting class.\n  }\n\n  /* click is the handler for a click event on the canvas. */\n  click (e: MouseEvent) {\n    this.report.click(e)\n  }\n\n  /* wheel is a mousewheel event handler. */\n  wheel (e: WheelEvent) {\n    this.zoom(e.deltaY < 0)\n    e.preventDefault()\n  }\n\n  /*\n   * resize updates the chart size. The parentHeight is an argument to support\n   * updating the height programatically after the caller sets a style.height\n   * but before the clientHeight has been updated.\n   */\n  resize (parentHeight: number) {\n    this.canvas.width = this.parent.clientWidth\n    this.canvas.height = parentHeight - 20 // magic number derived from a soup of css values.\n    const xLblHeight = 30\n    const yGuess = 40 // y label width guess. Will be adjusted when drawn.\n    const plotExtents = new Extents(yGuess, this.canvas.width, 10, this.canvas.height - xLblHeight)\n    const xLblExtents = new Extents(yGuess, this.canvas.width, this.canvas.height - xLblHeight, this.canvas.height)\n    const yLblExtents = new Extents(0, yGuess, 10, this.canvas.height - xLblHeight)\n    this.plotRegion = new Region(this.ctx, plotExtents)\n    this.xRegion = new Region(this.ctx, xLblExtents)\n    this.yRegion = new Region(this.ctx, yLblExtents)\n    // After changing the visibility, this.canvas.getBoundingClientRect will\n    // return nonsense until a render.\n    window.requestAnimationFrame(() => {\n      this.rect = this.canvas.getBoundingClientRect()\n      this.report.resize()\n    })\n  }\n\n  /* zoom is called when the user scrolls the mouse wheel on the canvas. */\n  zoom (bigger: boolean) {\n    if (this.wheelLimiter) return\n    this.report.zoom(bigger)\n  }\n\n  /* hide hides the canvas */\n  hide () {\n    this.visible = false\n    Doc.hide(this.canvas)\n  }\n\n  /* show shows the canvas */\n  show () {\n    this.visible = true\n    Doc.show(this.canvas)\n    this.resize(this.parent.clientHeight)\n  }\n\n  /* The market handler will call unattach when the markets page is unloaded. */\n  unattach () {\n    unbind(window, 'resize', this.boundResizer)\n  }\n\n  /* render must be implemented by the child class. */\n  render () {\n    console.error('child class must override render method')\n  }\n\n  /* applyLabelStyle applies the style used for axis tick labels. */\n  applyLabelStyle () {\n    this.ctx.textAlign = 'center'\n    this.ctx.textBaseline = 'middle'\n    this.ctx.font = '12px \\'sans\\', sans-serif'\n    this.ctx.fillStyle = this.theme.axisLabel\n  }\n\n  /* plotXLabels applies the provided labels to the x axis and draws the grid. */\n  plotXLabels (labels: LabelSet, minX: number, maxX: number, unitLines: string[]) {\n    const extents = new Extents(minX, maxX, 0, 1)\n    this.xRegion.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      this.applyLabelStyle()\n      const centerX = (maxX + minX) / 2\n      let lastX = minX\n      let unitCenter = centerX\n      labels.lbls.forEach(lbl => {\n        ctx.fillText(lbl.txt, tools.x(lbl.val), tools.y(0.5))\n        if (centerX >= lastX && centerX < lbl.val) {\n          unitCenter = (lastX + lbl.val) / 2\n        }\n        lastX = lbl.val\n      })\n      ctx.font = '11px \\'sans\\', sans-serif'\n      if (unitLines.length === 2) {\n        ctx.fillText(unitLines[0], tools.x(unitCenter), tools.y(0.63))\n        ctx.fillText(unitLines[1], tools.x(unitCenter), tools.y(0.23))\n      } else if (unitLines.length === 1) {\n        ctx.fillText(unitLines[0], tools.x(unitCenter), tools.y(0.5))\n      }\n    }, true)\n    this.plotRegion.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      ctx.lineWidth = 1\n      ctx.strokeStyle = this.theme.gridLines\n      labels.lbls.forEach(lbl => {\n        line(ctx, tools.x(lbl.val), tools.y(0), tools.x(lbl.val), tools.y(1))\n      })\n    }, true)\n  }\n\n  /*\n   * plotYLabels applies the y labels based on the provided plot region, and\n   * draws the grid.\n   */\n  plotYLabels (region: Region, labels: LabelSet, minY: number, maxY: number, unit: string) {\n    const extents = new Extents(0, 1, minY, maxY)\n    this.yRegion.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      this.applyLabelStyle()\n      const centerY = maxY / 2\n      let lastY = 0\n      let unitCenter = centerY\n      labels.lbls.forEach(lbl => {\n        ctx.fillText(lbl.txt, tools.x(0.5), tools.y(lbl.val))\n        if (centerY >= lastY && centerY < lbl.val) {\n          unitCenter = (lastY + lbl.val) / 2\n        }\n        lastY = lbl.val\n      })\n      ctx.fillText(unit, tools.x(0.5), tools.y(unitCenter))\n    }, true)\n    region.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      ctx.lineWidth = 1\n      ctx.strokeStyle = this.theme.gridLines\n      labels.lbls.forEach(lbl => {\n        line(ctx, tools.x(0), tools.y(lbl.val), tools.x(1), tools.y(lbl.val))\n      })\n    }, true)\n  }\n\n  /*\n   * doYLabels generates and applies the y-axis labels, based upon the\n   * provided plot region.\n   */\n  doYLabels (region: Region, step: number, unit: string, valFmt?: (v: number) => string) {\n    const yLabels = makeLabels(this.ctx, region.height(), this.dataExtents.y.min,\n      this.dataExtents.y.max, 50, step, unit, valFmt)\n\n    // Reassign the width of the y-label column to accommodate the widest text.\n    const yAxisWidth = (yLabels.widest || 0) * 1.5\n    this.yRegion.extents.x.max = yAxisWidth\n    this.yRegion.extents.y.max = region.extents.y.max\n\n    this.plotRegion.extents.x.min = yAxisWidth\n    this.xRegion.extents.x.min = yAxisWidth\n    // Print the y labels.\n    this.plotYLabels(region, yLabels, this.dataExtents.y.min, this.dataExtents.y.max, unit)\n    return yLabels\n  }\n\n  // drawFrame draws an outline around the plotRegion.\n  drawFrame () {\n    this.plotRegion.plot(new Extents(0, 1, 0, 1), (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      ctx.lineWidth = 1\n      ctx.strokeStyle = this.theme.gridBorder\n      ctx.beginPath()\n      tools.dataCoords(() => {\n        ctx.moveTo(0, 0)\n        ctx.lineTo(0, 1)\n        ctx.lineTo(1, 1)\n        ctx.lineTo(1, 0)\n        ctx.lineTo(0, 0)\n      })\n      ctx.stroke()\n    })\n  }\n}\n\n/* DepthChart is a javascript Canvas-based depth chart renderer. */\nexport class DepthChart extends Chart {\n  reporters: DepthReporters\n  book: OrderBook\n  zoomLevel: number\n  lotSize: number\n  rateStep: number\n  lines: DepthLine[]\n  markers: Record<string, DepthMarker[]>\n  zoomInBttn: Region\n  zoomOutBttn: Region\n  baseUnit: string\n  quoteUnit: string\n\n  constructor (parent: HTMLElement, reporters: DepthReporters, zoom: number) {\n    super(parent, {\n      resize: () => this.resized(),\n      click: (e: MouseEvent) => this.clicked(e),\n      zoom: (bigger: boolean) => this.zoomed(bigger)\n    })\n    this.reporters = reporters\n    this.zoomLevel = zoom\n    this.lines = []\n    this.markers = {\n      buys: [],\n      sells: []\n    }\n    this.resize(parent.clientHeight)\n  }\n\n  // setZoomBttns creates new regions for zoom in and zoom out buttons. It is\n  // used in initiation of the buttons and resizing.\n  setZoomBttns () {\n    this.zoomInBttn = new Region(this.ctx, new Extents(0, 0, 0, 0))\n    this.zoomOutBttn = new Region(this.ctx, new Extents(0, 0, 0, 0))\n  }\n\n  /* resized is called when the window or parent element are resized. */\n  resized () {\n    // The button region extents are set during drawing.\n    this.setZoomBttns()\n    if (this.book) this.draw()\n  }\n\n  /* zoomed zooms the current view in or out. bigger=true is zoom in. */\n  zoomed (bigger: boolean) {\n    if (!this.zoomLevel) return\n    if (!this.book.buys || !this.book.sells) return\n    this.wheeled()\n    // Zoom in to 66%, but out to 150% = 1 / (2/3) so that the same zoom levels\n    // are hit when reversing direction.\n    this.zoomLevel *= bigger ? 2 / 3 : 3 / 2\n    this.zoomLevel = clamp(this.zoomLevel, 0.005, 2)\n    this.draw()\n    this.reporters.zoom(this.zoomLevel)\n  }\n\n  /* clicked is the canvas 'click' event handler. */\n  clicked (e: MouseEvent) {\n    if (!this.dataExtents) return\n    const x = e.clientX - this.rect.left\n    const y = e.clientY - this.rect.y\n    if (this.zoomInBttn.contains(x, y)) { this.zoom(true); return }\n    if (this.zoomOutBttn.contains(x, y)) { this.zoom(false); return }\n    const translator = this.plotRegion.translator(this.dataExtents)\n    this.reporters.click(translator.unx(x))\n  }\n\n  // clear the canvas.\n  clear () {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n  }\n\n  // set sets the current data set and draws.\n  set (book: OrderBook, lotSize: number, rateStep: number, baseUnitInfo: UnitInfo, quoteUnitInfo: UnitInfo) {\n    this.book = book\n    this.lotSize = lotSize / baseUnitInfo.conventional.conversionFactor\n    const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor]\n    this.rateStep = rateStep / RateEncodingFactor * qFactor / bFactor\n    this.baseUnit = baseUnitInfo.conventional.unit\n    this.quoteUnit = quoteUnitInfo.conventional.unit\n    if (!this.zoomLevel) {\n      const [midGap, gapWidth] = this.gap()\n      // Default to 5% zoom, but with a minimum of 5 * midGap, but still observing\n      // the hard cap of 200%.\n      const minZoom = Math.max(gapWidth / midGap * 5, 0.05)\n      this.zoomLevel = Math.min(minZoom, 2)\n    }\n    this.draw()\n  }\n\n  /*\n   * render draws the chart.\n   * 1. Calculate the data extents and translate the order book data to a\n   *    cumulative form.\n   * 2. Draw axis ticks and grid, mid-gap line and value, zoom buttons, mouse\n   *    position indicator...\n   * 4. Tick labels.\n   * 5. Data.\n   * 6. Epoch line legend.\n   * 7. Hover legend.\n   */\n  render () {\n    // if connection fails it is not possible to get book.\n    if (!this.book || !this.visible) return\n\n    this.clear()\n    // if (!this.book || this.book.empty()) return\n\n    const ctx = this.ctx\n    const mousePos = this.mousePos\n    const buys = this.book.buys\n    const sells = this.book.sells\n    const [midGap, gapWidth] = this.gap()\n\n    const halfWindow = this.zoomLevel * midGap / 2\n    const high = midGap + halfWindow\n    const low = midGap - halfWindow\n\n    // Get a sorted copy of the markers list.\n    const buyMarkers = [...this.markers.buys]\n    const sellMarkers = [...this.markers.sells]\n    buyMarkers.sort((a, b) => b.rate - a.rate)\n    sellMarkers.sort((a, b) => a.rate - b.rate)\n    const markers: DepthMark[] = []\n\n    const buyDepth: [number, number][] = []\n    const buyEpoch: [number, number][] = []\n    const sellDepth: [number, number][] = []\n    const sellEpoch: [number, number][] = []\n    const volumeReport = {\n      buyBase: 0,\n      buyQuote: 0,\n      sellBase: 0,\n      sellQuote: 0\n    }\n    let sum = 0\n    // The epoch line is above the non-epoch region, so the epochSum y value\n    // must account for non-epoch orders too.\n    let epochSum = 0\n\n    for (let i = 0; i < buys.length; i++) {\n      const ord = buys[i]\n      epochSum += ord.qty\n      if (ord.rate >= low) buyEpoch.push([ord.rate, epochSum])\n      if (ord.epoch) continue\n      sum += ord.qty\n      buyDepth.push([ord.rate, sum])\n      volumeReport.buyBase += ord.qty\n      volumeReport.buyQuote += ord.qty * ord.rate\n      while (buyMarkers.length && floatCompare(buyMarkers[0].rate, ord.rate)) {\n        const mark = buyMarkers.shift()\n        if (!mark) continue\n        markers.push({\n          rate: mark.rate,\n          qty: ord.epoch ? epochSum : sum,\n          sell: ord.sell,\n          active: mark.active\n        })\n      }\n    }\n    const buySum = buyDepth.length ? last(buyDepth)[1] : 0\n    buyDepth.push([low, buySum])\n    const epochBuySum = buyEpoch.length ? last(buyEpoch)[1] : 0\n    buyEpoch.push([low, epochBuySum])\n\n    epochSum = sum = 0\n    for (let i = 0; i < sells.length; i++) {\n      const ord = sells[i]\n      epochSum += ord.qty\n      if (ord.rate <= high) sellEpoch.push([ord.rate, epochSum])\n      if (ord.epoch) continue\n      sum += ord.qty\n      sellDepth.push([ord.rate, sum])\n      volumeReport.sellBase += ord.qty\n      volumeReport.sellQuote += ord.qty * ord.rate\n      while (sellMarkers.length && floatCompare(sellMarkers[0].rate, ord.rate)) {\n        const mark = sellMarkers.shift()\n        if (!mark) continue\n        markers.push({\n          rate: mark.rate,\n          qty: ord.epoch ? epochSum : sum,\n          sell: ord.sell,\n          active: mark.active\n        })\n      }\n    }\n    // Add a data point going to the left so that the data doesn't end with a\n    // vertical line.\n    const sellSum = sellDepth.length ? last(sellDepth)[1] : 0\n    sellDepth.push([high, sellSum])\n    const epochSellSum = sellEpoch.length ? last(sellEpoch)[1] : 0\n    sellEpoch.push([high, epochSellSum])\n\n    // Add ~30px padding to the top of the chart.\n    const h = this.xRegion.extents.y.min\n    const growthFactor = (h + 30) / h\n    const maxY = (epochSellSum && epochBuySum ? Math.max(epochBuySum, epochSellSum) : epochSellSum || epochBuySum || 1) * growthFactor\n\n    const dataExtents = new Extents(low, high, 0, maxY)\n    this.dataExtents = dataExtents\n\n    this.doYLabels(this.plotRegion, this.lotSize, this.baseUnit)\n\n    // Print the x labels\n    const xLabels = makeLabels(ctx, this.plotRegion.width(), dataExtents.x.min,\n      dataExtents.x.max, 100, this.rateStep, '')\n\n    this.plotXLabels(xLabels, low, high, [`${this.quoteUnit}/`, this.baseUnit])\n\n    // A function to be run at the end if there is legend data to display.\n    let mouseData: MouseReport | null = null\n\n    // Draw the grid.\n    this.drawFrame()\n    this.plotRegion.plot(dataExtents, (ctx, tools) => {\n      ctx.lineWidth = 1\n      // first, a square around the plot area.\n      ctx.strokeStyle = this.theme.gridBorder\n      // draw a line to indicate mid-gap\n      ctx.lineWidth = 2.5\n      ctx.strokeStyle = this.theme.gapLine\n      line(ctx, tools.x(midGap), tools.y(0), tools.x(midGap), tools.y(0.3 * dataExtents.y.max))\n\n      ctx.font = '30px \\'demi-sans\\', sans-serif'\n      ctx.textAlign = 'center'\n      ctx.textBaseline = 'middle'\n      ctx.fillStyle = this.theme.value\n      const y = 0.5 * dataExtents.y.max\n      ctx.fillText(formatLabelValue(midGap), tools.x(midGap), tools.y(y))\n      ctx.font = '12px \\'sans\\', sans-serif'\n      // ctx.fillText('mid-market price', tools.x(midGap), tools.y(y) + 24)\n      ctx.fillText(`${(gapWidth / midGap * 100).toFixed(2)}% spread`,\n        tools.x(midGap), tools.y(y) + 24)\n\n      // Draw zoom buttons.\n      ctx.textAlign = 'center'\n      ctx.textBaseline = 'middle'\n      const topCenterX = this.plotRegion.extents.midX\n      const topCenterY = tools.y(maxY * 0.9)\n      const zoomPct = dataExtents.xRange / midGap * 100\n      const zoomText = `${zoomPct.toFixed(1)}%`\n      const w = ctx.measureText(zoomText).width\n      ctx.font = '13px \\'sans\\', sans-serif'\n      ctx.fillText(zoomText, topCenterX, topCenterY + 1)\n      // define the region for the zoom button\n      const bttnSize = 20\n      const xPad = 10\n      let bttnLeft = topCenterX - w / 2 - xPad - bttnSize\n      const bttnTop = topCenterY - bttnSize / 2\n      this.zoomOutBttn.setExtents(\n        bttnLeft,\n        bttnLeft + bttnSize,\n        bttnTop,\n        bttnTop + bttnSize\n      )\n      let hover = mousePos && this.zoomOutBttn.contains(mousePos.x, mousePos.y)\n      this.zoomOutBttn.plot(new Extents(0, 1, 0, 1), ctx => {\n        ctx.font = '12px \\'icomoon\\''\n        ctx.fillStyle = this.theme.zoom\n        if (hover) {\n          ctx.fillStyle = this.theme.zoomHover\n          ctx.font = '13px \\'icomoon\\''\n        }\n        ctx.fillText(minusChar, this.zoomOutBttn.extents.midX, this.zoomOutBttn.extents.midY)\n      })\n      bttnLeft = topCenterX + w / 2 + xPad\n      this.zoomInBttn.setExtents(\n        bttnLeft,\n        bttnLeft + bttnSize,\n        bttnTop,\n        bttnTop + bttnSize\n      )\n      hover = mousePos && this.zoomInBttn.contains(mousePos.x, mousePos.y)\n      this.zoomInBttn.plot(new Extents(0, 1, 0, 1), ctx => {\n        ctx.font = '12px \\'icomoon\\''\n        ctx.fillStyle = this.theme.zoom\n        if (hover) {\n          ctx.fillStyle = this.theme.zoomHover\n          ctx.font = '14px \\'icomoon\\''\n        }\n        ctx.fillText(plusChar, this.zoomInBttn.extents.midX, this.zoomInBttn.extents.midY)\n      })\n\n      // Draw a dotted vertical line where the mouse is, and a dot at the level\n      // of the depth line.\n      const drawLine = (x: number, color: string) => {\n        if (x > high || x < low) return\n        ctx.save()\n        ctx.setLineDash([3, 5])\n        ctx.lineWidth = 1.5\n        ctx.strokeStyle = color\n        line(ctx, tools.x(x), tools.y(0), tools.x(x), tools.y(maxY))\n        ctx.restore()\n      }\n\n      for (const line of this.lines || []) {\n        drawLine(line.rate, line.color)\n      }\n\n      const tolerance = (high - low) * 0.005\n      const hoverMarkers = []\n      for (const marker of markers || []) {\n        const hovered = (mousePos && withinTolerance(marker.rate, tools.unx(mousePos.x), tolerance))\n        if (hovered) hoverMarkers.push(marker.rate)\n        ctx.save()\n        ctx.lineWidth = (hovered || marker.active) ? 5 : 3\n        ctx.strokeStyle = marker.sell ? this.theme.sellLine : this.theme.buyLine\n        ctx.fillStyle = marker.sell ? this.theme.sellFill : this.theme.buyFill\n        const size = (hovered || marker.active) ? 10 : 8\n        ctx.beginPath()\n        const tip = {\n          x: tools.x(marker.rate),\n          y: tools.y(marker.qty) - 8\n        }\n        const top = tip.y - (Math.sqrt(3) * size / 2) // cos(30)\n        ctx.moveTo(tip.x, tip.y)\n        ctx.lineTo(tip.x - size / 2, top)\n        ctx.lineTo(tip.x + size / 2, top)\n        ctx.closePath()\n        ctx.stroke()\n        ctx.fill()\n        ctx.restore()\n      }\n\n      // If the mouse is in the chart area, draw the crosshairs.\n      if (!mousePos) return\n      if (!this.plotRegion.contains(mousePos.x, mousePos.y)) return\n      // The mouse is in the plot region. Get the data coordinates and find the\n      // side and depth for the x value.\n      const dataX = tools.unx(mousePos.x)\n      let evalSide = sellDepth\n      let trigger = (ptX: number) => ptX >= dataX\n      let dotColor = this.theme.sellLine\n      if (dataX < midGap) {\n        evalSide = buyDepth\n        trigger = (ptX) => ptX <= dataX\n        dotColor = this.theme.buyLine\n      }\n      let bestDepth = evalSide[0]\n      for (let i = 0; i < evalSide.length; i++) {\n        const pt = evalSide[i]\n        if (trigger(pt[0])) break\n        bestDepth = pt\n      }\n      drawLine(dataX, this.theme.crosshairs)\n      mouseData = {\n        rate: dataX,\n        depth: bestDepth[1],\n        dotColor: dotColor,\n        hoverMarkers: hoverMarkers\n      }\n    })\n\n    // Draw the epoch lines\n    ctx.lineWidth = 1.5\n    ctx.setLineDash([3, 3])\n    // epoch sells\n    ctx.fillStyle = this.theme.sellFill\n    ctx.strokeStyle = this.theme.sellLine\n    this.drawDepth(sellEpoch)\n    // epoch buys\n    ctx.fillStyle = this.theme.buyFill\n    ctx.strokeStyle = this.theme.buyLine\n    this.drawDepth(buyEpoch)\n\n    // Draw the book depth.\n    ctx.lineWidth = 2.5\n    ctx.setLineDash([])\n    // book sells\n    ctx.fillStyle = this.theme.sellFill\n    ctx.strokeStyle = this.theme.sellLine\n    this.drawDepth(sellDepth)\n    // book buys\n    ctx.fillStyle = this.theme.buyFill\n    ctx.strokeStyle = this.theme.buyLine\n    this.drawDepth(buyDepth)\n\n    // Display the dot at the intersection of the mouse hover line and the depth\n    // line. This should be drawn after the depths.\n    if (mouseData) {\n      this.plotRegion.plot(dataExtents, (ctx, tools) => {\n        if (!mouseData) return // For TypeScript. Duh.\n        dot(ctx, tools.x(mouseData.rate), tools.y(mouseData.depth), mouseData.dotColor, 5)\n      })\n    }\n\n    // Report the book volumes.\n    this.reporters.volume(volumeReport)\n    this.reporters.mouse(mouseData)\n  }\n\n  /* drawDepth draws a single side's depth chart data. */\n  drawDepth (depth: [number, number][]) {\n    const firstPt = depth[0]\n    let y = firstPt[1]\n    let x: number\n    this.plotRegion.plot(this.dataExtents, (ctx, tools) => {\n      tools.dataCoords(() => {\n        ctx.beginPath()\n        ctx.moveTo(firstPt[0], firstPt[1])\n        for (let i = 0; i < depth.length; i++) {\n          // Set x, but don't set y until we draw the horizontal line.\n          x = depth[i][0]\n          ctx.lineTo(x, y)\n          // If this is past the render edge, quit drawing.\n          y = depth[i][1]\n          ctx.lineTo(x, y)\n        }\n      })\n      ctx.stroke()\n      tools.dataCoords(() => {\n        ctx.lineTo(x, 0)\n        ctx.lineTo(firstPt[0], 0)\n      })\n      ctx.closePath()\n      ctx.globalAlpha = 0.25\n      ctx.fill()\n    })\n  }\n\n  /* returns the mid-gap rate and gap width as a tuple. */\n  gap () {\n    const [b, s] = [this.book.bestGapBuy(), this.book.bestGapSell()]\n    if (!b) {\n      if (!s) return [1, 0]\n      return [s.rate, 0]\n    } else if (!s) return [b.rate, 0]\n    return [(s.rate + b.rate) / 2, s.rate - b.rate]\n  }\n\n  /* setLines stores the indicator lines to draw. */\n  setLines (lines: DepthLine[]) {\n    this.lines = lines\n  }\n\n  /* setMarkers sets the indicator markers to draw. */\n  setMarkers (markers: Record<string, DepthMarker[]>) {\n    this.markers = markers\n  }\n}\n\n/* CandleChart is a candlestick data renderer. */\nexport class CandleChart extends Chart {\n  reporters: CandleReporters\n  data: CandlesPayload\n  zoomLevel: number\n  numToShow: number\n  candleRegion: Region\n  volumeRegion: Region\n  resizeTimer: number\n  zoomLevels: number[]\n  market: Market\n  rateConversionFactor: number\n\n  constructor (parent: HTMLElement, reporters: CandleReporters) {\n    super(parent, {\n      resize: () => this.resized(),\n      click: (/* e: MouseEvent */) => { this.clicked() },\n      zoom: (bigger: boolean) => this.zoomed(bigger)\n    })\n    this.reporters = reporters\n    this.zoomLevel = 1\n    this.numToShow = 100\n    this.resize(parent.clientHeight)\n  }\n\n  /* resized is called when the window or parent element are resized. */\n  resized () {\n    const ext = this.plotRegion.extents\n    const candleExtents = new Extents(ext.x.min, ext.x.max, ext.y.min, ext.y.min + ext.yRange * 0.85)\n    this.candleRegion = new Region(this.ctx, candleExtents)\n    const volumeExtents = new Extents(ext.x.min, ext.x.max, ext.y.min + 0.85 * ext.yRange, ext.y.max)\n    this.volumeRegion = new Region(this.ctx, volumeExtents)\n    // Set a delay on the render to prevent lag.\n    if (this.resizeTimer) clearTimeout(this.resizeTimer)\n    this.resizeTimer = window.setTimeout(() => this.draw(), 100)\n  }\n\n  clicked (/* e: MouseEvent */) {\n    // handle clicks\n  }\n\n  /* zoomed zooms the current view in or out. bigger=true is zoom in. */\n  zoomed (bigger: boolean) {\n    // bigger actually means fewer candles -> reduce zoomLevels index.\n    const idx = this.zoomLevels.indexOf(this.numToShow)\n    if (bigger) {\n      if (idx === 0) return\n      this.numToShow = this.zoomLevels[idx - 1]\n    } else {\n      if (this.zoomLevels.length <= idx + 1 || this.numToShow > this.data.candles.length) return\n      this.numToShow = this.zoomLevels[idx + 1]\n    }\n    this.draw()\n  }\n\n  /* render draws the chart */\n  render () {\n    const data = this.data\n    if (!data || !this.visible) return\n    const candleWidth = data.ms\n    const mousePos = this.mousePos\n    const allCandles = data.candles || []\n\n    const n = Math.min(this.numToShow, allCandles.length)\n    const candles = allCandles.slice(allCandles.length - n)\n\n    this.clear()\n\n    // If there are no candles. just don't draw anything.\n    if (n === 0) return\n\n    // padding definition and some helper functions to parse candles.\n    const candleWidthPadding = 0.2\n    const start = (c: Candle) => truncate(c.endStamp, candleWidth)\n    const end = (c: Candle) => start(c) + candleWidth\n    const paddedStart = (c: Candle) => start(c) + candleWidthPadding * candleWidth\n    const paddedWidth = (1 - 2 * candleWidthPadding) * candleWidth\n\n    const first = candles[0]\n    const last = candles[n - 1]\n\n    let [high, low, highVol] = [first.highRate, first.lowRate, first.matchVolume]\n    for (const c of candles) {\n      if (c.highRate > high) high = c.highRate\n      if (c.lowRate < low) low = c.lowRate\n      if (c.matchVolume > highVol) highVol = c.matchVolume\n    }\n\n    // Calculate data extents and store them. They are used to apply labels.\n    const rateStep = this.market.ratestep\n    const dataExtents = new Extents(start(first), end(last), low, high)\n    if (low === high) {\n      // If there is no price movement at all in the window, show a little more\n      // top and bottom so things render nicely.\n      dataExtents.y.min -= rateStep\n      dataExtents.y.max += rateStep\n    }\n    this.dataExtents = dataExtents\n\n    // Apply labels.\n    const rFactor = this.rateConversionFactor\n    this.doYLabels(this.candleRegion, rateStep, this.market.quotesymbol, v => formatLabelValue(v / rFactor))\n    this.candleRegion.extents.x.min = this.yRegion.extents.x.max\n    this.volumeRegion.extents.x.min = this.yRegion.extents.x.max\n\n    const xLabels = makeCandleTimeLabels(candles, candleWidth, this.plotRegion.width(), 100)\n\n    this.plotXLabels(xLabels, start(first), end(last), [])\n\n    this.drawFrame()\n\n    // Highlight the candle if the user mouse is over the canvas.\n    let mouseCandle: Candle | null = null\n    if (mousePos) {\n      this.plotRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, 0, 1), (ctx, tools) => {\n        const selectedStartStamp = truncate(tools.unx(mousePos.x), candleWidth)\n        for (const c of candles) {\n          if (start(c) === selectedStartStamp) {\n            mouseCandle = c\n            ctx.fillStyle = this.theme.gridLines\n            ctx.fillRect(tools.x(start(c)), tools.y(0), tools.w(candleWidth), tools.h(1))\n            break\n          }\n        }\n      })\n      if (mouseCandle) {\n        const yExt = this.xRegion.extents.y\n        this.xRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, yExt.min, yExt.max), (ctx, tools) => {\n          if (!mouseCandle) return // For TypeScript. Duh.\n          this.applyLabelStyle()\n          const rangeTxt = `${new Date(start(mouseCandle)).toLocaleString()} - ${new Date(end(mouseCandle)).toLocaleString()}`\n          const [xPad, yPad] = [25, 2]\n          const rangeWidth = ctx.measureText(rangeTxt).width + 2 * xPad\n          const rangeHeight = 16\n          let centerX = tools.x((start(mouseCandle) + end(mouseCandle)) / 2)\n          let left = centerX - rangeWidth / 2\n          const xExt = this.xRegion.extents.x\n          if (left < xExt.min) left = xExt.min\n          else if (left + rangeWidth > xExt.max) left = xExt.max - rangeWidth\n          centerX = left + rangeWidth / 2\n          const top = yExt.min + (this.xRegion.height() - rangeHeight) / 2\n          ctx.fillStyle = this.theme.legendFill\n          ctx.strokeStyle = this.theme.gridBorder\n          const rectArgs: [number, number, number, number] = [left - xPad, top - yPad, rangeWidth + 2 * xPad, rangeHeight + 2 * yPad]\n          ctx.fillRect(...rectArgs)\n          ctx.strokeRect(...rectArgs)\n          this.applyLabelStyle()\n          ctx.fillText(rangeTxt, centerX, this.xRegion.extents.midY, rangeWidth)\n        })\n      }\n    }\n\n    // Draw the volume bars.\n    const volDataExtents = new Extents(start(first), end(last), 0, highVol)\n    this.volumeRegion.plot(volDataExtents, (ctx, tools) => {\n      ctx.fillStyle = this.theme.gridBorder\n      for (const c of candles) {\n        ctx.fillRect(tools.x(paddedStart(c)), tools.y(0), tools.w(paddedWidth), tools.h(c.matchVolume))\n      }\n    })\n\n    // Draw the candles.\n    this.candleRegion.plot(dataExtents, (ctx, tools) => {\n      ctx.lineWidth = 1\n      for (const c of candles) {\n        const desc = c.startRate > c.endRate\n        const [x, y, w, h] = [tools.x(paddedStart(c)), tools.y(c.startRate), tools.w(paddedWidth), tools.h(c.endRate - c.startRate)]\n        const [high, low, cx] = [tools.y(c.highRate), tools.y(c.lowRate), w / 2 + x]\n        ctx.strokeStyle = desc ? this.theme.sellLine : this.theme.buyLine\n        ctx.fillStyle = desc ? this.theme.sellFill : this.theme.buyFill\n\n        ctx.beginPath()\n        ctx.moveTo(cx, high)\n        ctx.lineTo(cx, low)\n        ctx.stroke()\n\n        ctx.fillRect(x, y, w, h)\n        ctx.strokeRect(x, y, w, h)\n      }\n    })\n\n    // Report the mouse candle.\n    this.reporters.mouse(mouseCandle)\n  }\n\n  /* setCandles sets the candle data and redraws the chart. */\n  setCandles (data: CandlesPayload, market: Market, baseUnitInfo: UnitInfo, quoteUnitInfo: UnitInfo) {\n    this.data = data\n    if (!data.candles) return\n    this.market = market\n    const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor]\n    this.rateConversionFactor = RateEncodingFactor * bFactor / qFactor\n    let n = 25\n    this.zoomLevels = []\n    const maxCandles = Math.max(data.candles.length, 1000)\n    while (n < maxCandles) {\n      this.zoomLevels.push(n)\n      n *= 2\n    }\n    this.numToShow = 100\n    this.draw()\n  }\n}\n\n/*\n * Extents holds a min and max in both the x and y directions, and provides\n * getters for related data.\n */\nclass Extents {\n  x: MinMax\n  y: MinMax\n\n  constructor (xMin: number, xMax: number, yMin: number, yMax: number) {\n    this.setExtents(xMin, xMax, yMin, yMax)\n  }\n\n  setExtents (xMin: number, xMax: number, yMin: number, yMax: number) {\n    this.x = {\n      min: xMin,\n      max: xMax\n    }\n    this.y = {\n      min: yMin,\n      max: yMax\n    }\n  }\n\n  get xRange (): number {\n    return this.x.max - this.x.min\n  }\n\n  get midX (): number {\n    return (this.x.max + this.x.min) / 2\n  }\n\n  get yRange (): number {\n    return this.y.max - this.y.min\n  }\n\n  get midY (): number {\n    return (this.y.max + this.y.min) / 2\n  }\n}\n\n/*\n * Region applies an Extents to the canvas, providing utilities for coordinate\n * transformations and restricting drawing to a specified region of the canvas.\n */\nclass Region {\n  context: CanvasRenderingContext2D\n  extents: Extents\n\n  constructor (context: CanvasRenderingContext2D, extents: Extents) {\n    this.context = context\n    this.extents = extents\n  }\n\n  setExtents (xMin: number, xMax: number, yMin: number, yMax: number) {\n    this.extents.setExtents(xMin, xMax, yMin, yMax)\n  }\n\n  width (): number {\n    return this.extents.xRange\n  }\n\n  height (): number {\n    return this.extents.yRange\n  }\n\n  contains (x: number, y: number): boolean {\n    const ext = this.extents\n    return (x < ext.x.max && x > ext.x.min &&\n      y < ext.y.max && y > ext.y.min)\n  }\n\n  /*\n   * A translator provides 4 function for coordinate transformations. x and y\n   * translate data coordinates to canvas coordinates for the specified data\n   * Extents. unx and uny translate canvas coordinates to data coordinates.\n   */\n  translator (dataExtents: Extents): Translator {\n    const region = this.extents\n    const xMin = dataExtents.x.min\n    // const xMax = dataExtents.x.max\n    const yMin = dataExtents.y.min\n    // const yMax = dataExtents.y.max\n    const yRange = dataExtents.yRange\n    const xRange = dataExtents.xRange\n    const screenMinX = region.x.min\n    const screenW = region.x.max - screenMinX\n    const screenMaxY = region.y.max\n    const screenH = screenMaxY - region.y.min\n    const xFactor = screenW / xRange\n    const yFactor = screenH / yRange\n    return {\n      x: (x: number) => (x - xMin) * xFactor + screenMinX,\n      y: (y: number) => screenMaxY - (y - yMin) * yFactor,\n      unx: (x: number) => (x - screenMinX) / xFactor + xMin,\n      uny: (y: number) => yMin - (y - screenMaxY) / yFactor,\n      w: (w: number) => w / xRange * screenW,\n      h: (h: number) => -h / yRange * screenH,\n      dataCoords: () => { /* Added when using plot() */ }\n    }\n  }\n\n  /* clear clears the region. */\n  clear () {\n    const ext = this.extents\n    this.context.clearRect(ext.x.min, ext.y.min, ext.xRange, ext.yRange)\n  }\n\n  /* plot prepares tools for drawing using data coordinates. */\n  plot (dataExtents: Extents, drawFunc: (ctx: CanvasRenderingContext2D, tools: Translator) => void, skipMask?: boolean) {\n    const ctx = this.context\n    const region = this.extents\n    ctx.save() // Save the original state\n    if (!skipMask) {\n      ctx.beginPath()\n      ctx.rect(region.x.min, region.y.min, region.xRange, region.yRange)\n      ctx.clip()\n    }\n\n    // The drawFunc will be passed a set of tool that can be used to assist\n    // drawing. The tools start with the transformation functions.\n    const tools = this.translator(dataExtents)\n\n    // Create a transformation that allows drawing in data coordinates. It's\n    // not advisable to stroke or add text with this transform in place, as the\n    // result will be distorted. You can however use ctx.moveTo and ctx.lineTo\n    // with this transform in place using data coordinates, and remove the\n    // transform before stroking. The dataCoords method of the supplied tool\n    // provides this functionality.\n    const yRange = dataExtents.yRange\n    const xFactor = region.xRange / dataExtents.xRange\n    const yFactor = region.yRange / yRange\n    const xMin = dataExtents.x.min\n    const yMin = dataExtents.y.min\n    // These translation factors are complicated because the (0, 0) of the\n    // region is not necessarily the (0, 0) of the canvas.\n    const tx = (region.x.min + xMin) - xMin * xFactor\n    const ty = -region.y.min - (yRange - yMin) * yFactor\n    const setTransform = () => {\n      // Data coordinates are flipped about y. Flip the coordinates and\n      // translate top left corner to canvas (0, 0).\n      ctx.transform(1, 0, 0, -1, -xMin, yMin)\n      // Scale to data coordinates and shift into place for the region's offset\n      // on the canvas.\n      ctx.transform(xFactor, 0, 0, yFactor, tx, ty)\n    }\n    // dataCoords allows some drawing to be performed directly in data\n    // coordinates. Most actual drawing functions like ctx.stroke and\n    // ctx.fillRect should not be called from inside dataCoords, but\n    // ctx.moveTo and ctx.LineTo are fine.\n    tools.dataCoords = f => {\n      ctx.save()\n      setTransform()\n      f()\n      ctx.restore()\n    }\n\n    drawFunc(this.context, tools)\n    ctx.restore()\n  }\n}\n\n/*\n * makeLabels attempts to create the appropriate labels for the specified\n * screen size, context, and label spacing.\n */\nfunction makeLabels (\n  ctx: CanvasRenderingContext2D,\n  screenW: number,\n  min: number,\n  max: number,\n  spacingGuess: number,\n  step: number,\n  unit: string,\n  valFmt?: (v: number) => string\n): LabelSet {\n  valFmt = valFmt || formatLabelValue\n  const n = screenW / spacingGuess\n  const diff = max - min\n  const tickGuess = diff / n\n  // make the tick spacing a multiple of the step\n  const tick = tickGuess + step - (tickGuess % step)\n  let x = min + tick - (min % tick)\n  const absMax = Math.max(Math.abs(max), Math.abs(min))\n  // The Math.round part is the minimum precision required to see the change in the numbers.\n  // The 2 accounts for the precision of the tick.\n  const sigFigs = Math.round(Math.log10(absMax / tick)) + 2\n  const pts: Label[] = []\n  let widest = 0\n  while (x < max) {\n    x = Number(x.toPrecision(sigFigs))\n    const lbl = valFmt(x)\n    widest = Math.max(widest, ctx.measureText(lbl).width)\n    pts.push({\n      val: x,\n      txt: lbl\n    })\n    x += tick\n  }\n  const unitW = ctx.measureText(unit).width\n  if (unitW > widest) widest = unitW\n  return {\n    widest: widest,\n    lbls: pts\n  }\n}\n\nconst months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec']\n\n/* makeCandleTimeLabels prepares labels for candlestick data. */\nfunction makeCandleTimeLabels (candles: Candle[], dur: number, screenW: number, spacingGuess: number): LabelSet {\n  const first = candles[0]\n  const last = candles[candles.length - 1]\n  const start = truncate(first.endStamp, dur)\n  const end = truncate(last.endStamp, dur) + dur\n  const diff = end - start\n  const n = Math.min(candles.length, screenW / spacingGuess)\n  const tick = truncate(diff / n, dur)\n  if (tick === 0) {\n    console.error('zero tick', dur, diff, n) // probably won't happen, but it'd suck if it did\n    return { lbls: [] }\n  }\n  let x = start\n  const zoneOffset = new Date().getTimezoneOffset()\n  const dayStamp = (x: number) => {\n    x = x - zoneOffset * 60000\n    return x - (x % 86400000)\n  }\n  let lastDay = dayStamp(start)\n  let lastYear = 0 // new Date(start).getFullYear()\n  if (dayStamp(first.endStamp) === dayStamp(last.endStamp)) lastDay = 0 // Force at least one day stamp.\n  const pts = []\n  let label\n  if (dur < 86400000) {\n    label = (d: Date, x: number) => {\n      const day = dayStamp(x)\n      if (day !== lastDay) return `${months[d.getMonth()]}${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`\n      else return `${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`\n    }\n  } else {\n    label = (d: Date) => {\n      const year = d.getFullYear()\n      if (year !== lastYear) return `${months[d.getMonth()]}${d.getDate()} '${String(year).slice(2, 4)}`\n      else return `${months[d.getMonth()]}${d.getDate()}`\n    }\n  }\n  while (x <= end) {\n    const d = new Date(x)\n    pts.push({\n      val: x,\n      txt: label(d, x)\n    })\n    lastDay = dayStamp(x)\n    lastYear = d.getFullYear()\n    x += tick\n  }\n  return { lbls: pts }\n}\n\n/* The last element of an array. */\nfunction last (arr: any[]): any {\n  return arr[arr.length - 1]\n}\n\n/* line draws a line with the provided context. */\nfunction line (ctx: CanvasRenderingContext2D, x0: number, y0: number, x1: number, y1: number, skipStroke?: boolean) {\n  ctx.beginPath()\n  ctx.moveTo(x0, y0)\n  ctx.lineTo(x1, y1)\n  if (!skipStroke) ctx.stroke()\n}\n\n/* dot draws a circle with the provided context. */\nfunction dot (ctx: CanvasRenderingContext2D, x: number, y: number, color: string, radius: number) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.arc(x, y, radius, 0, PIPI)\n  ctx.fill()\n}\n\n/* clamp returns v if min <= v <= max, else min or max. */\nfunction clamp (v: number, min: number, max: number): number {\n  if (v < min) return min\n  if (v > max) return max\n  return v\n}\n\n/* labelSpecs is specifications for axis tick labels. */\nconst labelSpecs = {\n  minimumSignificantDigits: 4,\n  maximumSignificantDigits: 5\n}\n\n/* formatLabelValue formats the provided value using the labelSpecs format. */\nfunction formatLabelValue (x: number) {\n  return x.toLocaleString('en-us', labelSpecs)\n}\n\n/* floatCompare compares two floats to within a tolerance of  1e-8. */\nfunction floatCompare (a: number, b: number) {\n  return withinTolerance(a, b, 1e-8)\n}\n\n/*\n * withinTolerance returns true if the difference between a and b are with\n * the specified tolerance.\n */\nfunction withinTolerance (a: number, b: number, tolerance: number) {\n  return Math.abs(a - b) < Math.abs(tolerance)\n}\n\nfunction truncate (v: number, w: number): number {\n  return v - (v % w)\n}\n","// MessageSocket is a WebSocket manager that uses the Decred DEX Mesage format\n// for communications.\n//\n// Message request format:\n// {\n//   route: 'name',\n//   id: int,\n//   payload: anything or nothing\n// }\n//\n// Message response payload will be a result object with either a valid 'result'\n// field or an 'error' field\n//\n// Functions for external use:\n// registerRoute (route, handler) -- register a function to handle events\n// of the given type\n// request (route, payload) -- create a JSON message in the above format and\n// send it\n//\n// Based on messagesocket_service.js by Jonathan Chappelow @ dcrdata, which is\n// based on ws_events_dispatcher.js by Ismael Celis\nconst typeRequest = 1\n\nfunction forward (route: string, payload: any, handlers: Record<string, ((payload: any) => void)[]>) {\n  if (!route && payload.error) {\n    const err = payload.error\n    console.error(`websocket error (code ${err.code}): ${err.message}`)\n    return\n  }\n  if (typeof handlers[route] === 'undefined') {\n    // console.log(`unhandled message for ${route}: ${payload}`)\n    return\n  }\n  // call each handler\n  for (let i = 0; i < handlers[route].length; i++) {\n    handlers[route][i](payload)\n  }\n}\n\nlet id = 0\n\ntype NoteReceiver = (payload: any) => void\n\nclass MessageSocket {\n  uri: string\n  connection: WebSocket | null\n  handlers: Record<string, NoteReceiver[]>\n  queue: [string, any][]\n  maxQlength: number\n  reloader: () => void // appears unused\n\n  constructor () {\n    this.handlers = {}\n    this.queue = []\n    this.maxQlength = 5\n  }\n\n  registerRoute (route: string, handler: NoteReceiver) {\n    this.handlers[route] = this.handlers[route] || []\n    this.handlers[route].push(handler)\n  }\n\n  deregisterRoute (route: string) {\n    this.handlers[route] = []\n  }\n\n  // request sends a request-type message to the server\n  request (route: string, payload: any) {\n    if (!this.connection || this.connection.readyState !== window.WebSocket.OPEN) {\n      while (this.queue.length > this.maxQlength - 1) this.queue.shift()\n      this.queue.push([route, payload])\n      return\n    }\n    id++\n    const message = JSON.stringify({\n      route: route,\n      type: typeRequest,\n      id: id,\n      payload: payload\n    })\n\n    window.log('ws', 'sending', message)\n    this.connection.send(message)\n  }\n\n  close (reason: string) {\n    window.log('ws', 'close, reason:', reason, this.handlers)\n    this.handlers = {}\n    if (this.connection) this.connection.close()\n  }\n\n  connect (uri: string, reloader: () => void) {\n    this.uri = uri\n    this.reloader = reloader\n    let retrys = 0\n    const go = () => {\n      window.log('ws', `connecting to ${uri}`)\n      let conn: WebSocket | null = this.connection = new window.WebSocket(uri)\n      if (!conn) return\n      const timeout = setTimeout(() => {\n        // readyState is still WebSocket.CONNECTING. Cancel and trigger onclose.\n        if (conn) conn.close()\n      }, 500)\n\n      // unmarshal message, and forward the message to registered handlers\n      conn.onmessage = (evt: MessageEvent) => {\n        const message = JSON.parse(evt.data)\n        forward(message.route, message.payload, this.handlers)\n      }\n\n      // Stub out standard functions\n      conn.onclose = (evt: CloseEvent) => {\n        window.log('ws', 'onclose')\n        clearTimeout(timeout)\n        conn = this.connection = null\n        forward('close', null, this.handlers)\n        retrys++\n        // 1.2, 1.6, 2.0, 2.4, 3.1, 3.8, 4.8, 6.0, 7.5, 9.3, ...\n        const delay = Math.min(Math.pow(1.25, retrys), 10)\n        console.error(`websocket disconnected (${evt.code}), trying again in ${delay.toFixed(1)} seconds`)\n        setTimeout(() => {\n          go()\n        }, delay * 1000)\n      }\n\n      conn.onopen = () => {\n        window.log('ws', 'onopen')\n        clearTimeout(timeout)\n        if (retrys > 0) {\n          retrys = 0\n          reloader()\n        }\n        forward('open', null, this.handlers)\n        const queue = this.queue\n        this.queue = []\n        for (const [route, message] of queue) {\n          this.request(route, message)\n        }\n      }\n\n      conn.onerror = (evt: Event) => {\n        window.log('ws', 'onerror:', evt)\n        forward('error', evt, this.handlers)\n      }\n    }\n    go()\n  }\n}\n\nconst ws = new MessageSocket()\nexport default ws\n","import Doc, { WalletIcons } from './doc'\nimport State from './state'\nimport BasePage from './basepage'\nimport OrderBook from './orderbook'\nimport {\n  CandleChart,\n  DepthChart,\n  DepthLine,\n  CandleReporters,\n  MouseReport,\n  VolumeReport,\n  DepthMarker\n} from './charts'\nimport { postJSON } from './http'\nimport { NewWalletForm, UnlockWalletForm, AccelerateOrderForm, bind as bindForm } from './forms'\nimport * as OrderUtil from './orderutil'\nimport ws from './ws'\nimport * as intl from './locales'\nimport {\n  app,\n  SupportedAsset,\n  PageElement,\n  Order,\n  Market,\n  OrderEstimate,\n  MaxOrderEstimate,\n  Exchange,\n  UnitInfo,\n  Asset,\n  Candle,\n  CandlesPayload,\n  TradeForm,\n  BookUpdate,\n  MaxSell,\n  MaxBuy,\n  SwapEstimate,\n  MarketOrderBook,\n  APIResponse,\n  PreSwap,\n  PreRedeem,\n  WalletStateNote,\n  SpotPriceNote,\n  FeePaymentNote,\n  OrderNote,\n  EpochNote,\n  BalanceNote,\n  MiniOrder,\n  RemainderUpdate,\n  ConnEventNote,\n  Spot,\n  OrderOption,\n  ConnectionStatus\n} from './registry'\n\nconst bind = Doc.bind\n\nconst bookRoute = 'book'\nconst bookOrderRoute = 'book_order'\nconst unbookOrderRoute = 'unbook_order'\nconst updateRemainingRoute = 'update_remaining'\nconst epochOrderRoute = 'epoch_order'\nconst candlesRoute = 'candles'\nconst candleUpdateRoute = 'candle_update'\nconst unmarketRoute = 'unmarket'\n\nconst lastMarketKey = 'selectedMarket'\nconst chartRatioKey = 'chartRatio'\nconst depthZoomKey = 'depthZoom'\n\nconst animationLength = 500\n\nconst anHour = 60 * 60 * 1000 // milliseconds\n\nconst depthChart = 'depth_chart'\nconst candleChart = 'candle_chart'\n\nconst check = document.createElement('span')\ncheck.classList.add('ico-check')\n\nconst percentFormatter = new Intl.NumberFormat(document.documentElement.lang, {\n  minimumFractionDigits: 1,\n  maximumFractionDigits: 2\n})\n\ninterface MetaOrder {\n  row: HTMLElement\n  order: Order\n  cancelling?: boolean\n  status?: number\n}\n\ninterface CancelData {\n  bttn: PageElement\n  order: Order\n}\n\ninterface CurrentMarket {\n  dex: Exchange\n  sid: string // A string market identifier used by the DEX.\n  cfg: Market\n  base: SupportedAsset\n  quote: SupportedAsset\n  baseUnitInfo: UnitInfo\n  quoteUnitInfo: UnitInfo\n  maxSellRequested: boolean\n  maxSell: MaxOrderEstimate | null\n  sellBalance: number\n  buyBalance: number\n  maxBuys: Record<number, MaxOrderEstimate>\n  candleCaches: Record<string, CandlesPayload>\n  baseCfg: Asset\n  quoteCfg: Asset\n  rateConversionFactor: number\n}\n\ninterface BalanceWidgetElement {\n  id: number\n  cfg: Asset | null\n  logo: PageElement\n  avail: PageElement\n  newWalletRow: PageElement\n  newWalletBttn: PageElement\n  locked: PageElement\n  immature: PageElement\n  unsupported: PageElement\n  expired: PageElement\n  connect: PageElement\n  spinner: PageElement\n  iconBox: PageElement\n  stateIcons: WalletIcons\n}\n\ninterface LoadTracker {\n  loaded: () => void,\n  timer: number\n}\n\ninterface OrderRow extends HTMLElement {\n  manager: OrderTableRowManager\n}\n\nexport default class MarketsPage extends BasePage {\n  page: Record<string, PageElement>\n  main: HTMLElement\n  loaded: (() => void) | null\n  maxLoaded: (() => void) | null\n  maxOrderUpdateCounter: number\n  market: CurrentMarket\n  currentForm: HTMLElement\n  openAsset: SupportedAsset\n  openFunc: () => void\n  currentCreate: SupportedAsset\n  maxEstimateTimer: number | null\n  book: OrderBook\n  cancelData: CancelData\n  metaOrders: Record<string, MetaOrder>\n  preorderCache: Record<string, OrderEstimate>\n  currentOrder: TradeForm\n  depthLines: Record<string, DepthLine[]>\n  activeMarkerRate: number | null\n  hovers: HTMLElement[]\n  ordersSortKey: string\n  ordersSortDirection: 1 | -1\n  ogTitle: string\n  depthChart: DepthChart\n  candleChart: CandleChart\n  currentChart: string\n  candleDur: string\n  balanceWgt: BalanceWidget\n  marketList: MarketList\n  quoteUnits: NodeListOf<HTMLElement>\n  baseUnits: NodeListOf<HTMLElement>\n  unlockForm: UnlockWalletForm\n  newWalletForm: NewWalletForm\n  keyup: (e: KeyboardEvent) => void\n  secondTicker: number\n  candlesLoading: LoadTracker | null\n  accelerateOrderForm: AccelerateOrderForm\n\n  constructor (main: HTMLElement, data: any) {\n    super()\n    const page = this.page = Doc.idDescendants(main)\n    this.main = main\n    if (!this.main.parentElement) return // Not gonna happen, but TypeScript cares.\n    this.loaded = app().loading(this.main.parentElement)\n    // There may be multiple pending updates to the max order. This makes sure\n    // that the screen is updated with the most recent one.\n    this.maxOrderUpdateCounter = 0\n    this.metaOrders = {}\n    this.preorderCache = {}\n    this.depthLines = {\n      hover: [],\n      input: []\n    }\n    this.hovers = []\n    // 'Your Orders' list sort key and direction.\n    this.ordersSortKey = 'submitTime'\n    // 1 if sorting ascendingly, -1 if sorting descendingly.\n    this.ordersSortDirection = 1\n    // store original title so we can re-append it when updating market value.\n    this.ogTitle = document.title\n\n    const depthReporters = {\n      click: (x: number) => { this.reportDepthClick(x) },\n      volume: (r: VolumeReport) => { this.reportDepthVolume(r) },\n      mouse: (r: MouseReport) => { this.reportDepthMouse(r) },\n      zoom: (z: number) => { this.reportDepthZoom(z) }\n    }\n    this.depthChart = new DepthChart(page.marketChart, depthReporters, State.fetch(depthZoomKey))\n\n    const candleReporters: CandleReporters = {\n      mouse: c => { this.reportMouseCandle(c) }\n    }\n    this.candleChart = new CandleChart(page.marketChart, candleReporters)\n\n    const success = () => { /* do nothing */ }\n    // Do not call cleanTemplates before creating the AccelerateOrderForm\n    this.accelerateOrderForm = new AccelerateOrderForm(page.accelerateForm, success)\n\n    // TODO: Store user's state and reload last known configuration.\n    this.candleChart.hide()\n    this.currentChart = depthChart\n    this.candleDur = ''\n\n    // Set up the BalanceWidget.\n    {\n      const wgt = this.balanceWgt = new BalanceWidget(page.balanceTable)\n      const baseIcons = wgt.base.stateIcons.icons\n      const quoteIcons = wgt.quote.stateIcons.icons\n      bind(wgt.base.connect, 'click', () => { this.showOpen(this.market.base, this.walletUnlocked) })\n      bind(wgt.quote.connect, 'click', () => { this.showOpen(this.market.quote, this.walletUnlocked) })\n      bind(wgt.base.expired, 'click', () => { this.showOpen(this.market.base, this.walletUnlocked) })\n      bind(wgt.quote.expired, 'click', () => { this.showOpen(this.market.quote, this.walletUnlocked) })\n      bind(baseIcons.sleeping, 'click', () => { this.showOpen(this.market.base, this.walletUnlocked) })\n      bind(quoteIcons.sleeping, 'click', () => { this.showOpen(this.market.quote, this.walletUnlocked) })\n      bind(baseIcons.locked, 'click', () => { this.showOpen(this.market.base, this.walletUnlocked) })\n      bind(quoteIcons.locked, 'click', () => { this.showOpen(this.market.quote, this.walletUnlocked) })\n      bind(wgt.base.newWalletBttn, 'click', () => { this.showCreate(this.market.base) })\n      bind(wgt.quote.newWalletBttn, 'click', () => { this.showCreate(this.market.quote) })\n    }\n\n    // Prepare templates for the buy and sell tables and the user's order table.\n    OrderUtil.setOptionTemplates(page)\n    Doc.cleanTemplates(page.rowTemplate, page.liveTemplate, page.durBttnTemplate, page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl)\n\n    // Prepare the list of markets.\n    this.marketList = new MarketList(page.marketList)\n    for (const xc of this.marketList.xcSections) {\n      if (!xc.marketRows) continue\n      for (const row of xc.marketRows) {\n        bind(row.node, 'click', () => {\n          this.setMarket(xc.host, row.mkt.baseid, row.mkt.quoteid)\n        })\n      }\n    }\n\n    // Store the elements that need their ticker changed when the market\n    // changes.\n    this.quoteUnits = main.querySelectorAll('[data-unit=quote]')\n    this.baseUnits = main.querySelectorAll('[data-unit=base]')\n\n    // Buttons to set order type and side.\n    bind(page.buyBttn, 'click', () => {\n      swapBttns(page.sellBttn, page.buyBttn)\n      page.submitBttn.classList.remove('sellred')\n      page.submitBttn.classList.add('buygreen')\n      page.maxLbl.textContent = intl.prep(intl.ID_BUY)\n      this.setOrderBttnText()\n      this.setOrderVisibility()\n      this.drawChartLines()\n    })\n    bind(page.sellBttn, 'click', () => {\n      swapBttns(page.buyBttn, page.sellBttn)\n      page.submitBttn.classList.add('sellred')\n      page.submitBttn.classList.remove('buygreen')\n      page.maxLbl.textContent = intl.prep(intl.ID_SELL)\n      this.setOrderBttnText()\n      this.setOrderVisibility()\n      this.drawChartLines()\n    })\n    bind(page.limitBttn, 'click', () => {\n      swapBttns(page.marketBttn, page.limitBttn)\n      this.setOrderVisibility()\n      if (!page.rateField.value) return\n      this.depthLines.input = [{\n        rate: parseFloat(page.rateField.value || '0'),\n        color: this.isSell() ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine\n      }]\n      this.drawChartLines()\n    })\n    bind(page.marketBttn, 'click', () => {\n      swapBttns(page.limitBttn, page.marketBttn)\n      this.setOrderVisibility()\n      this.setMarketBuyOrderEstimate()\n      this.depthLines.input = []\n      this.drawChartLines()\n    })\n    bind(page.maxOrd, 'click', () => {\n      if (this.isSell()) {\n        const maxSell = this.market.maxSell\n        if (!maxSell) return\n        page.lotField.value = String(maxSell.swap.lots)\n      } else page.lotField.value = String(this.market.maxBuys[this.adjustedRate()].swap.lots)\n      this.lotChanged()\n    })\n    bind(page.depthBttn, 'click', () => {\n      this.depthChartSelected()\n    })\n    bind(page.candlestickBttn, 'click', () => {\n      this.candleChartSelected()\n    })\n\n    Doc.disableMouseWheel(page.rateField, page.lotField, page.qtyField, page.mktBuyField)\n\n    // Handle the full orderbook sent on the 'book' route.\n    ws.registerRoute(bookRoute, (data: BookUpdate) => { this.handleBookRoute(data) })\n    // Handle the new order for the order book on the 'book_order' route.\n    ws.registerRoute(bookOrderRoute, (data: BookUpdate) => { this.handleBookOrderRoute(data) })\n    // Remove the order sent on the 'unbook_order' route from the orderbook.\n    ws.registerRoute(unbookOrderRoute, (data: BookUpdate) => { this.handleUnbookOrderRoute(data) })\n    // Update the remaining quantity on a booked order.\n    ws.registerRoute(updateRemainingRoute, (data: BookUpdate) => { this.handleUpdateRemainingRoute(data) })\n    // Handle the new order for the order book on the 'epoch_order' route.\n    ws.registerRoute(epochOrderRoute, (data: BookUpdate) => { this.handleEpochOrderRoute(data) })\n    // Handle the intial candlestick data on the 'candles' route.\n    ws.registerRoute(candleUpdateRoute, (data: BookUpdate) => { this.handleCandleUpdateRoute(data) })\n    // Handle the candles update on the 'candles' route.\n    ws.registerRoute(candlesRoute, (data: BookUpdate) => { this.handleCandlesRoute(data) })\n    // Bind the wallet unlock form.\n    this.unlockForm = new UnlockWalletForm(page.unlockWalletForm, async () => { this.openFunc() })\n    // Create a wallet\n    this.newWalletForm = new NewWalletForm(page.newWalletForm, async () => { this.createWallet() })\n    // Main order form.\n    bindForm(page.orderForm, page.submitBttn, async () => { this.stepSubmit() })\n    // Order verification form.\n    bindForm(page.verifyForm, page.vSubmit, async () => { this.submitOrder() })\n    // Unlock for order estimation\n    Doc.bind(page.vUnlockSubmit, 'click', async () => { this.submitEstimateUnlock() })\n    // Cancel order form.\n    bindForm(page.cancelForm, page.cancelSubmit, async () => { this.submitCancel() })\n    // Order detail view\n    Doc.bind(page.vFeeDetails, 'click', () => this.showForm(page.vDetailPane))\n    Doc.bind(page.closeDetailPane, 'click', () => this.showVerifyForm())\n    // Bind active orders list's header sort events.\n    page.liveTable.querySelectorAll('[data-ordercol]')\n      .forEach((th: HTMLElement) => bind(th, 'click', () => setOrdersSortCol(th.dataset.ordercol || '')))\n\n    const setOrdersSortCol = (key: string) => {\n      // First unset header's current sorted col classes.\n      unsetOrdersSortColClasses()\n      // If already sorting by key change sort direction.\n      if (this.ordersSortKey === key) {\n        this.ordersSortDirection *= -1\n      } else {\n        // Otherwise update sort key and set default direction to ascending.\n        this.ordersSortKey = key\n        this.ordersSortDirection = 1\n      }\n      this.refreshActiveOrders()\n      // Set header's new sorted col classes.\n      setOrdersSortColClasses()\n    }\n\n    const sortClassByDirection = () => {\n      if (this.ordersSortDirection === 1) return 'sorted-asc'\n      return 'sorted-dsc'\n    }\n\n    const unsetOrdersSortColClasses = () => {\n      page.liveTable.querySelectorAll('[data-ordercol]')\n        .forEach(th => th.classList.remove('sorted-asc', 'sorted-dsc'))\n    }\n\n    const setOrdersSortColClasses = () => {\n      const key = this.ordersSortKey\n      const sortCls = sortClassByDirection()\n      Doc.safeSelector(page.liveTable, `[data-ordercol=${key}]`).classList.add(sortCls)\n    }\n\n    // Set default's sorted col header classes.\n    setOrdersSortColClasses()\n\n    const closePopups = () => {\n      Doc.hide(page.forms)\n      page.vPass.value = ''\n      page.cancelPass.value = ''\n    }\n\n    // If the user clicks outside of a form, it should close the page overlay.\n    bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (Doc.isDisplayed(page.vDetailPane) && !Doc.mouseInElement(e, page.vDetailPane)) return this.showVerifyForm()\n      if (!Doc.mouseInElement(e, this.currentForm)) {\n        closePopups()\n      }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        closePopups()\n      }\n    }\n    bind(document, 'keyup', this.keyup)\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { closePopups() })\n    })\n\n    // Event listeners for interactions with the various input fields.\n    bind(page.lotField, 'change', () => { this.lotChanged() })\n    bind(page.lotField, 'keyup', () => { this.lotChanged() })\n    bind(page.qtyField, 'change', () => { this.quantityChanged(true) })\n    bind(page.qtyField, 'keyup', () => { this.quantityChanged(false) })\n    bind(page.mktBuyField, 'change', () => { this.marketBuyChanged() })\n    bind(page.mktBuyField, 'keyup', () => { this.marketBuyChanged() })\n    bind(page.rateField, 'change', () => { this.rateFieldChanged() })\n    bind(page.rateField, 'keyup', () => { this.previewQuoteAmt(true) })\n\n    // Market search input bindings.\n    bind(page.marketSearch, 'change', () => { this.filterMarkets() })\n    bind(page.marketSearch, 'keyup', () => { this.filterMarkets() })\n\n    const clearChartLines = () => {\n      this.depthLines.hover = []\n      this.drawChartLines()\n    }\n    bind(page.buyRows, 'mouseleave', clearChartLines)\n    bind(page.sellRows, 'mouseleave', clearChartLines)\n    bind(page.liveList, 'mouseleave', () => {\n      this.activeMarkerRate = null\n      this.setDepthMarkers()\n    })\n\n    // Load the user's layout preferences.\n    const setChartRatio = (r: number) => {\n      if (r > 0.7) r = 0.7\n      else if (r < 0.25) r = 0.25\n\n      const h = r * (this.main.clientHeight - app().header.offsetHeight)\n      page.marketChart.style.height = `${h}px`\n\n      this.depthChart.resize(h)\n      this.candleChart.resize(h)\n    }\n    const chartDivRatio = State.fetch(chartRatioKey)\n    if (chartDivRatio) {\n      setChartRatio(chartDivRatio)\n    }\n    // Bind chart resizing.\n    bind(page.chartResizer, 'mousedown', (e: MouseEvent) => {\n      if (e.button !== 0) return\n      e.preventDefault()\n      let chartRatio: number\n      const trackMouse = (ee: MouseEvent) => {\n        ee.preventDefault()\n        const box = page.rightSide.getBoundingClientRect()\n        const h = box.bottom - box.top\n        chartRatio = (ee.pageY - box.top) / h\n        setChartRatio(chartRatio)\n      }\n      bind(document, 'mousemove', trackMouse)\n      bind(document, 'mouseup', () => {\n        if (chartRatio) State.store(chartRatioKey, chartRatio)\n        Doc.unbind(document, 'mousemove', trackMouse)\n      })\n    })\n\n    // Notification filters.\n    app().registerNoteFeeder({\n      order: (note: OrderNote) => { this.handleOrderNote(note) },\n      epoch: (note: EpochNote) => { this.handleEpochNote(note) },\n      conn: (note: ConnEventNote) => { this.handleConnNote(note) },\n      balance: (note: BalanceNote) => { this.handleBalanceNote(note) },\n      feepayment: (note: FeePaymentNote) => { this.handleFeePayment(note) },\n      spots: (note: SpotPriceNote) => { this.handlePriceUpdate(note) }\n    })\n\n    // Fetch the first market in the list, or the users last selected market, if\n    // it exists.\n    let selected\n    if (data && data.host && typeof data.base !== 'undefined' && typeof data.quote !== 'undefined') {\n      selected = makeMarket(data.host, parseInt(data.base), parseInt(data.quote))\n    } else {\n      selected = State.fetch(lastMarketKey)\n    }\n    if (!selected || !this.marketList.exists(selected.host, selected.base, selected.quote)) {\n      selected = this.marketList.first()\n    }\n    this.setMarket(selected.host, selected.base, selected.quote)\n\n    // Start a ticker to update time-since values.\n    this.secondTicker = window.setInterval(() => {\n      for (const metaOrder of Object.values(this.metaOrders)) {\n        const td = Doc.tmplElement(metaOrder.row, 'age')\n        td.textContent = Doc.timeSince(metaOrder.order.submitTime)\n      }\n    }, 1000)\n\n    // set the initial state for the registration status\n    this.setRegistrationStatusVisibility()\n    this.setBalanceVisibility()\n  }\n\n  /* isSell is true if the user has selected sell in the order options. */\n  isSell () {\n    return this.page.sellBttn.classList.contains('selected')\n  }\n\n  /* isLimit is true if the user has selected the \"limit order\" tab. */\n  isLimit () {\n    return this.page.limitBttn.classList.contains('selected')\n  }\n\n  /* hasFeePending is true if the fee payment is pending */\n  hasFeePending () {\n    return !!this.market.dex.pendingFee\n  }\n\n  /* assetsAreSupported is true if all the assets of the current market are\n   * supported\n   */\n  assetsAreSupported () {\n    const [b, q] = [this.market.base, this.market.quote]\n    return b && q\n  }\n\n  /*\n   * setOrderVisibility sets which form is visible based on the specified\n   * options.\n   */\n  setOrderVisibility () {\n    const page = this.page\n    if (this.isLimit()) {\n      Doc.show(page.priceBox, page.tifBox, page.qtyBox, page.maxBox)\n      Doc.hide(page.mktBuyBox)\n      this.previewQuoteAmt(true)\n    } else {\n      Doc.hide(page.tifBox, page.maxBox, page.priceBox)\n      if (this.isSell()) {\n        Doc.hide(page.mktBuyBox)\n        Doc.show(page.qtyBox)\n        this.previewQuoteAmt(true)\n      } else {\n        Doc.show(page.mktBuyBox)\n        Doc.hide(page.qtyBox)\n        this.previewQuoteAmt(false)\n      }\n    }\n  }\n\n  /* resolveOrderFormVisibility displays or hides the 'orderForm' based on\n   * a set of conditions to be met.\n   */\n  resolveOrderFormVisibility () {\n    const page = this.page\n    // By default the order form should be hidden, and only if market is set\n    // and ready for trading the form should show up.\n    Doc.hide(page.orderForm)\n    const feePaid = !this.hasFeePending()\n    const assetsAreSupported = this.assetsAreSupported()\n    const { base, quote } = this.market\n    const hasWallets = base && app().assets[base.id].wallet && quote && app().assets[quote.id].wallet\n\n    if (feePaid && assetsAreSupported && hasWallets) {\n      Doc.show(page.orderForm)\n    }\n  }\n\n  /* setLoaderMsgVisibility displays a message in case a dex asset is not\n   * supported\n   */\n  setLoaderMsgVisibility () {\n    const { page, market } = this\n\n    if (this.assetsAreSupported()) {\n      // make sure to hide the loader msg\n      Doc.hide(page.loaderMsg)\n      return\n    }\n    const symbol = market.base ? market.quoteCfg.symbol : market.baseCfg.symbol\n    page.loaderMsg.textContent = intl.prep(intl.ID_NOT_SUPPORTED, { asset: symbol.toUpperCase() })\n    Doc.show(page.loaderMsg)\n  }\n\n  /* setRegistrationStatusView sets the text content and class for the\n   * registration status view\n   */\n  setRegistrationStatusView (titleContent: string, confStatusMsg: string, titleClass: string) {\n    const page = this.page\n    page.regStatusTitle.textContent = titleContent\n    page.regStatusConfsDisplay.textContent = confStatusMsg\n    page.registrationStatus.classList.remove('completed', 'error', 'waiting')\n    page.registrationStatus.classList.add(titleClass)\n  }\n\n  /*\n   * updateRegistrationStatusView updates the view based on the current\n   * registration status\n   */\n  updateRegistrationStatusView () {\n    const { page, market: { dex } } = this\n    page.regStatusDex.textContent = dex.host\n\n    const pending = dex.pendingFee\n    if (!pending) {\n      this.setRegistrationStatusView(intl.prep(intl.ID_REGISTRATION_FEE_SUCCESS), '', 'completed')\n      return\n    }\n\n    const confirmationsRequired = dex.regFees[pending.symbol].confs\n    page.confReq.textContent = String(confirmationsRequired)\n    const confStatusMsg = `${pending.confs} / ${confirmationsRequired}`\n    this.setRegistrationStatusView(intl.prep(intl.ID_WAITING_FOR_CONFS), confStatusMsg, 'waiting')\n  }\n\n  /*\n   * setRegistrationStatusVisibility toggles the registration status view based\n   * on the dex data.\n   */\n  setRegistrationStatusVisibility () {\n    const { page, market: { dex } } = this\n\n    // If dex is not connected to server, is not possible to know fee\n    // registration status.\n    if (dex.connectionStatus !== ConnectionStatus.Connected) return\n\n    this.updateRegistrationStatusView()\n\n    if (dex.pendingFee) {\n      Doc.show(page.registrationStatus)\n    } else {\n      const toggle = () => {\n        Doc.hide(page.registrationStatus)\n        this.resolveOrderFormVisibility()\n      }\n      if (Doc.isHidden(page.orderForm)) {\n        // wait a couple of seconds before showing the form so the success\n        // message is shown to the user\n        setTimeout(toggle, 5000)\n        return\n      }\n      toggle()\n    }\n  }\n\n  setOrderBttnText () {\n    if (this.isSell()) {\n      this.page.submitBttn.textContent = intl.prep(intl.ID_SET_BUTTON_SELL, { asset: this.market.baseCfg.symbol.toUpperCase() })\n    } else this.page.submitBttn.textContent = intl.prep(intl.ID_SET_BUTTON_BUY, { asset: this.market.baseCfg.symbol.toUpperCase() })\n  }\n\n  setCandleDurBttns () {\n    const { page, market } = this\n    Doc.empty(page.durBttnBox)\n    for (const dur of market.dex.candleDurs) {\n      const bttn = page.durBttnTemplate.cloneNode(true)\n      bttn.textContent = dur\n      Doc.bind(bttn, 'click', () => this.candleDurationSelected(dur))\n      page.durBttnBox.appendChild(bttn)\n    }\n  }\n\n  /* setMarket sets the currently displayed market. */\n  async setMarket (host: string, base: number, quote: number) {\n    const dex = app().user.exchanges[host]\n    const page = this.page\n\n    // reset form inputs\n    page.lotField.value = ''\n    page.qtyField.value = ''\n    page.rateField.value = ''\n\n    // If we have not yet connected, there is no dex.assets or any other\n    // exchange data, so just put up a message and wait for the connection to be\n    // established, at which time handleConnNote will refresh and reload.\n    if (dex.connectionStatus !== ConnectionStatus.Connected) {\n      // TODO: Figure out why this was like this.\n      // this.market = { dex: dex }\n\n      page.chartErrMsg.textContent = intl.prep(intl.ID_CONNECTION_FAILED)\n      Doc.show(page.chartErrMsg)\n      if (this.loaded) this.loaded()\n      this.main.style.opacity = '1'\n      Doc.hide(page.marketLoader)\n      return\n    }\n\n    const baseCfg = dex.assets[base]\n    const quoteCfg = dex.assets[quote]\n\n    const [bui, qui] = [app().unitInfo(base, dex), app().unitInfo(quote, dex)]\n\n    const rateConversionFactor = OrderUtil.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor\n    Doc.hide(page.maxOrd, page.chartErrMsg)\n    if (this.maxEstimateTimer) {\n      window.clearTimeout(this.maxEstimateTimer)\n      this.maxEstimateTimer = null\n    }\n    const mktId = marketID(baseCfg.symbol, quoteCfg.symbol)\n    this.market = {\n      dex: dex,\n      sid: mktId, // A string market identifier used by the DEX.\n      cfg: dex.markets[mktId],\n      // app().assets is a map of core.SupportedAsset type, which can be found at\n      // client/core/types.go.\n      base: app().assets[base],\n      quote: app().assets[quote],\n      baseUnitInfo: bui,\n      quoteUnitInfo: qui,\n      maxSell: null,\n      maxBuys: {},\n      maxSellRequested: false,\n      candleCaches: {},\n      baseCfg,\n      quoteCfg,\n      rateConversionFactor,\n      sellBalance: 0,\n      buyBalance: 0\n    }\n\n    Doc.show(page.marketLoader)\n    if (!dex.candleDurs || dex.candleDurs.length === 0) this.currentChart = depthChart\n    if (this.currentChart === depthChart) ws.request('loadmarket', makeMarket(host, base, quote))\n    else {\n      if (dex.candleDurs.indexOf(this.candleDur) === -1) this.candleDur = dex.candleDurs[0]\n      this.loadCandles()\n    }\n    this.setLoaderMsgVisibility()\n    this.setRegistrationStatusVisibility()\n    this.resolveOrderFormVisibility()\n    this.setOrderBttnText()\n    this.setCandleDurBttns()\n    this.previewQuoteAmt(false)\n  }\n\n  /*\n   * reportDepthClick is a callback used by the DepthChart when the user clicks\n   * on the chart area. The rate field is set to the x-value of the click.\n   */\n  reportDepthClick (r: number) {\n    this.page.rateField.value = String(r)\n    this.rateFieldChanged()\n  }\n\n  /*\n   * reportDepthVolume accepts a volume report from the DepthChart and sets the\n   * values in the chart legend.\n   */\n  reportDepthVolume (r: VolumeReport) {\n    const page = this.page\n    const { baseUnitInfo: b, quoteUnitInfo: q } = this.market\n    // DepthChart reports volumes in conventional units. We'll still use\n    // formatCoinValue for formatting though.\n    page.sellBookedBase.textContent = Doc.formatCoinValue(r.sellBase * b.conventional.conversionFactor, b)\n    page.sellBookedQuote.textContent = Doc.formatCoinValue(r.sellQuote * q.conventional.conversionFactor, q)\n    page.buyBookedBase.textContent = Doc.formatCoinValue(r.buyBase * b.conventional.conversionFactor, b)\n    page.buyBookedQuote.textContent = Doc.formatCoinValue(r.buyQuote * q.conventional.conversionFactor, q)\n  }\n\n  /*\n   * reportDepthMouse accepts informations about the mouse position on the\n   * chart area.\n   */\n  reportDepthMouse (r: MouseReport) {\n    while (this.hovers.length) (this.hovers.shift() as HTMLElement).classList.remove('hover')\n    const page = this.page\n    if (!r) {\n      Doc.hide(page.hoverData)\n      return\n    }\n\n    // If the user is hovered to within a small percent (based on chart width)\n    // of a user order, highlight that order's row.\n    for (const metaOrd of Object.values(this.metaOrders)) {\n      const [row, ord] = [metaOrd.row, metaOrd.order]\n      if (ord.status !== OrderUtil.StatusBooked) continue\n      if (r.hoverMarkers.indexOf(ord.rate) > -1) {\n        row.classList.add('hover')\n        this.hovers.push(row)\n      }\n    }\n\n    page.hoverPrice.textContent = Doc.formatCoinValue(r.rate)\n    page.hoverVolume.textContent = Doc.formatCoinValue(r.depth)\n    page.hoverVolume.style.color = r.dotColor\n    Doc.show(page.hoverData)\n  }\n\n  /*\n   * reportDepthZoom accepts informations about the current depth chart zoom level.\n   * This information is saved to disk so that the zoom level can be maintained\n   * across reloads.\n   */\n  reportDepthZoom (zoom: number) {\n    State.store(depthZoomKey, zoom)\n  }\n\n  reportMouseCandle (candle: Candle | null) {\n    const page = this.page\n    if (!candle) {\n      Doc.hide(page.hoverData)\n      return\n    }\n\n    page.candleStart.textContent = Doc.formatCoinValue(candle.startRate / this.market.rateConversionFactor)\n    page.candleEnd.textContent = Doc.formatCoinValue(candle.endRate / this.market.rateConversionFactor)\n    page.candleHigh.textContent = Doc.formatCoinValue(candle.highRate / this.market.rateConversionFactor)\n    page.candleLow.textContent = Doc.formatCoinValue(candle.lowRate / this.market.rateConversionFactor)\n    page.candleVol.textContent = Doc.formatCoinValue(candle.matchVolume, this.market.baseUnitInfo)\n    Doc.show(page.hoverData)\n  }\n\n  /*\n   * parseOrder pulls the order information from the form fields. Data is not\n   * validated in any way.\n   */\n  parseOrder (): TradeForm {\n    const page = this.page\n    let qtyField = page.qtyField\n    const limit = this.isLimit()\n    const sell = this.isSell()\n    const market = this.market\n    if (!limit && !sell) {\n      qtyField = page.mktBuyField\n    }\n    return {\n      host: market.dex.host,\n      isLimit: limit,\n      sell: sell,\n      base: market.base.id,\n      quote: market.quote.id,\n      qty: convertToAtoms(qtyField.value || '', market.baseUnitInfo.conventional.conversionFactor),\n      rate: convertToAtoms(page.rateField.value || '', market.rateConversionFactor), // message-rate\n      tifnow: page.tifNow.checked || false,\n      options: {}\n    }\n  }\n\n  /**\n   * previewQuoteAmt shows quote amount when rate or quantity input are changed\n   */\n  previewQuoteAmt (show: boolean) {\n    const page = this.page\n    if (!this.market.base || !this.market.quote) return // Not a supported asset\n    const order = this.parseOrder()\n    const adjusted = this.adjustedRate()\n    page.orderErr.textContent = ''\n    if (adjusted) {\n      if (order.sell) this.preSell()\n      else this.preBuy()\n    }\n    this.depthLines.input = []\n    if (adjusted && this.isLimit()) {\n      this.depthLines.input = [{\n        rate: order.rate / this.market.rateConversionFactor,\n        color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine\n      }]\n    }\n    this.drawChartLines()\n    if (!show || !adjusted || !order.qty) {\n      page.orderPreview.textContent = ''\n      this.drawChartLines()\n      return\n    }\n    const quoteAsset = app().assets[order.quote]\n    const quoteQty = order.qty * order.rate / OrderUtil.RateEncodingFactor\n    const total = Doc.formatCoinValue(quoteQty, this.market.quoteUnitInfo)\n\n    page.orderPreview.textContent = intl.prep(intl.ID_ORDER_PREVIEW, { total, asset: quoteAsset.symbol.toUpperCase() })\n    if (this.isSell()) this.preSell()\n    else this.preBuy()\n  }\n\n  /**\n   * preSell populates the max order message for the largest available sell.\n   */\n  preSell () {\n    const mkt = this.market\n    const baseWallet = app().assets[mkt.base.id].wallet\n    if (baseWallet.balance.available < mkt.cfg.lotsize) {\n      this.setMaxOrder(null)\n      return\n    }\n    if (mkt.maxSell) {\n      this.setMaxOrder(mkt.maxSell.swap)\n      return\n    }\n    if (mkt.maxSellRequested) return\n    mkt.maxSellRequested = true\n    // We only fetch pre-sell once per balance update, so don't delay.\n    this.scheduleMaxEstimate('/api/maxsell', {}, 0, (res: MaxSell) => {\n      mkt.maxSellRequested = false\n      mkt.maxSell = res.maxSell\n      mkt.sellBalance = baseWallet.balance.available\n      this.setMaxOrder(res.maxSell.swap)\n    })\n  }\n\n  /**\n   * preBuy populates the max order message for the largest available buy.\n   */\n  preBuy () {\n    const mkt = this.market\n    const rate = this.adjustedRate()\n    const quoteWallet = app().assets[mkt.quote.id].wallet\n    if (!quoteWallet) return\n    const aLot = mkt.cfg.lotsize * (rate / OrderUtil.RateEncodingFactor)\n    if (quoteWallet.balance.available < aLot) {\n      this.setMaxOrder(null)\n      return\n    }\n    if (mkt.maxBuys[rate]) {\n      this.setMaxOrder(mkt.maxBuys[rate].swap)\n      return\n    }\n    // 0 delay for first fetch after balance update or market change, otherwise\n    // meter these at 1 / sec.\n    const delay = Object.keys(mkt.maxBuys).length ? 350 : 0\n    this.scheduleMaxEstimate('/api/maxbuy', { rate }, delay, (res: MaxBuy) => {\n      mkt.maxBuys[rate] = res.maxBuy\n      mkt.buyBalance = app().assets[mkt.quote.id].wallet.balance.available\n      this.setMaxOrder(res.maxBuy.swap)\n    })\n  }\n\n  /**\n   * scheduleMaxEstimate shows the loading icon and schedules a call to an order\n   * estimate api endpoint. If another call to scheduleMaxEstimate is made before\n   * this one is fired (after delay), this call will be canceled.\n   */\n  scheduleMaxEstimate (path: string, args: any, delay: number, success: (res: any) => void) {\n    const page = this.page\n    if (!this.maxLoaded) this.maxLoaded = app().loading(page.maxOrd)\n    const [bid, qid] = [this.market.base.id, this.market.quote.id]\n    const [bWallet, qWallet] = [app().assets[bid].wallet, app().assets[qid].wallet]\n    if (!bWallet || !bWallet.running || !qWallet || !qWallet.running) return\n    if (this.maxEstimateTimer) window.clearTimeout(this.maxEstimateTimer)\n\n    Doc.show(page.maxOrd, page.maxLotBox)\n    Doc.hide(page.maxAboveZero)\n    page.maxFromLots.textContent = intl.prep(intl.ID_CALCULATING)\n    page.maxFromLotsLbl.textContent = ''\n    this.maxOrderUpdateCounter++\n    const counter = this.maxOrderUpdateCounter\n    this.maxEstimateTimer = window.setTimeout(async () => {\n      this.maxEstimateTimer = null\n      if (counter !== this.maxOrderUpdateCounter) return\n      const res = await postJSON(path, {\n        host: this.market.dex.host,\n        base: bid,\n        quote: qid,\n        ...args\n      })\n      if (counter !== this.maxOrderUpdateCounter) return\n      if (!app().checkResponse(res, true)) {\n        console.warn('max order estimate not available:', res)\n        page.maxFromLots.textContent = intl.prep(intl.ID_ESTIMATE_UNAVAILABLE)\n        if (this.maxLoaded) {\n          this.maxLoaded()\n          this.maxLoaded = null\n        }\n        return\n      }\n      success(res)\n    }, delay)\n  }\n\n  /* setMaxOrder sets the max order text. */\n  setMaxOrder (maxOrder: SwapEstimate | null) {\n    const page = this.page\n    if (this.maxLoaded) {\n      this.maxLoaded()\n      this.maxLoaded = null\n    }\n    Doc.show(page.maxOrd, page.maxLotBox, page.maxAboveZero)\n    const sell = this.isSell()\n\n    let lots = 0\n    if (maxOrder) lots = maxOrder.lots\n\n    page.maxFromLots.textContent = lots.toString()\n    // XXX add plural into format details, so we don't need this\n    page.maxFromLotsLbl.textContent = lots === 1 ? 'lot' : 'lots'\n    if (!maxOrder) {\n      Doc.hide(page.maxAboveZero)\n      return\n    }\n    // Could add the estimatedFees here, but that might also be\n    // confusing.\n    const [fromAsset, toAsset] = sell ? [this.market.base, this.market.quote] : [this.market.quote, this.market.base]\n    page.maxFromAmt.textContent = Doc.formatCoinValue(maxOrder.value || 0, fromAsset.info.unitinfo)\n    page.maxFromTicker.textContent = fromAsset.symbol.toUpperCase()\n    // Could subtract the maxOrder.redemptionFees here.\n    const toConversion = sell ? this.adjustedRate() / OrderUtil.RateEncodingFactor : OrderUtil.RateEncodingFactor / this.adjustedRate()\n    page.maxToAmt.textContent = Doc.formatCoinValue((maxOrder.value || 0) * toConversion, toAsset.info.unitinfo)\n    page.maxToTicker.textContent = toAsset.symbol.toUpperCase()\n  }\n\n  /*\n   * validateOrder performs some basic order sanity checks, returning boolean\n   * true if the order appears valid.\n   */\n  validateOrder (order: TradeForm) {\n    const page = this.page\n    if (order.isLimit && !order.rate) {\n      Doc.show(page.orderErr)\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ZERO_RATE)\n      return false\n    }\n    if (!order.qty) {\n      Doc.show(page.orderErr)\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ZERO_QUANTITY)\n      return false\n    }\n    return true\n  }\n\n  /* handleBook accepts the data sent in the 'book' notification. */\n  handleBook (data: MarketOrderBook) {\n    const { cfg, baseUnitInfo, quoteUnitInfo, baseCfg, quoteCfg } = this.market\n    this.book = new OrderBook(data, baseCfg.symbol, quoteCfg.symbol)\n    this.loadTable()\n    for (const order of (data.book.epoch || [])) {\n      if (order.rate > 0) this.book.add(order)\n      this.addTableOrder(order)\n    }\n    if (!this.book) {\n      this.depthChart.clear()\n      Doc.empty(this.page.buyRows)\n      Doc.empty(this.page.sellRows)\n      return\n    }\n    this.depthChart.set(this.book, cfg.lotsize, cfg.ratestep, baseUnitInfo, quoteUnitInfo)\n  }\n\n  /*\n   * midGapConventional is the same as midGap, but returns the mid-gap rate as\n   * the conventional ratio. This is used to convert from a conventional\n   * quantity from base to quote or vice-versa.\n   */\n  midGapConventional () {\n    const gap = this.midGap()\n    if (!gap) return gap\n    const { baseUnitInfo: b, quoteUnitInfo: q } = this.market\n    return gap * b.conventional.conversionFactor / q.conventional.conversionFactor\n  }\n\n  /*\n   * midGap returns the value in the middle of the best buy and best sell. If\n   * either one of the buy or sell sides are empty, midGap returns the best rate\n   * from the other side. If both sides are empty, midGap returns the value\n   * null. The rate returned is the atomic ratio.\n   */\n  midGap () {\n    const book = this.book\n    if (!book) return\n    if (book.buys && book.buys.length) {\n      if (book.sells && book.sells.length) {\n        return (book.buys[0].msgRate + book.sells[0].msgRate) / 2 / OrderUtil.RateEncodingFactor\n      }\n      return book.buys[0].msgRate / OrderUtil.RateEncodingFactor\n    }\n    if (book.sells && book.sells.length) {\n      return book.sells[0].msgRate / OrderUtil.RateEncodingFactor\n    }\n    return null\n  }\n\n  /*\n   * setMarketBuyOrderEstimate sets the \"min. buy\" display for the current\n   * market.\n   */\n  setMarketBuyOrderEstimate () {\n    const market = this.market\n    const lotSize = market.cfg.lotsize\n    const xc = app().user.exchanges[market.dex.host]\n    const buffer = xc.markets[market.sid].buybuffer\n    const gap = this.midGapConventional()\n    if (gap) {\n      this.page.minMktBuy.textContent = Doc.formatCoinValue(lotSize * buffer * gap, market.baseUnitInfo)\n    }\n  }\n\n  /*\n   * ordersSortCompare returns sort compare function according to the active\n   * sort key and direction.\n   */\n  ordersSortCompare () {\n    switch (this.ordersSortKey) {\n      case 'submitTime':\n        return (a: Order, b: Order) => this.ordersSortDirection * (b.submitTime - a.submitTime)\n      case 'rate':\n        return (a: Order, b: Order) => this.ordersSortDirection * (a.rate - b.rate)\n      case 'qty':\n        return (a: Order, b: Order) => this.ordersSortDirection * (a.qty - b.qty)\n      case 'type':\n        return (a: Order, b: Order) => this.ordersSortDirection *\n        OrderUtil.typeString(a).localeCompare(OrderUtil.typeString(b))\n      case 'sell':\n        return (a: Order, b: Order) => this.ordersSortDirection *\n          (OrderUtil.sellString(a)).localeCompare(OrderUtil.sellString(b))\n      case 'status':\n        return (a: Order, b: Order) => this.ordersSortDirection *\n          (OrderUtil.statusString(a)).localeCompare(OrderUtil.statusString(b))\n      case 'settled':\n        return (a: Order, b: Order) => this.ordersSortDirection *\n          ((OrderUtil.settled(a) * 100 / a.qty) - (OrderUtil.settled(b) * 100 / b.qty))\n      case 'filled':\n        return (a: Order, b: Order) => this.ordersSortDirection *\n          ((OrderUtil.filled(a) * 100 / a.qty) - (OrderUtil.filled(b) * 100 / b.qty))\n    }\n  }\n\n  /* refreshActiveOrders refreshes the user's active order list. */\n  refreshActiveOrders () {\n    const page = this.page\n    const metaOrders = this.metaOrders\n    const market = this.market\n    for (const oid in metaOrders) delete metaOrders[oid]\n    const orders = app().orders(market.dex.host, marketID(market.baseCfg.symbol, market.quoteCfg.symbol))\n    // Sort orders by sort key.\n    const compare = this.ordersSortCompare()\n    orders.sort(compare)\n\n    Doc.empty(page.liveList)\n    for (const ord of orders) {\n      const row = page.liveTemplate.cloneNode(true) as HTMLElement\n      metaOrders[ord.id] = {\n        row: row,\n        order: ord\n      }\n      Doc.bind(row, 'mouseenter', () => {\n        this.activeMarkerRate = ord.rate\n        this.setDepthMarkers()\n      })\n      this.updateUserOrderRow(row, ord)\n      if (ord.type === OrderUtil.Limit && (ord.tif === OrderUtil.StandingTiF && ord.status < OrderUtil.StatusExecuted)) {\n        const icon = Doc.tmplElement(row, 'cancelBttn')\n        Doc.show(icon)\n        bind(icon, 'click', e => {\n          e.stopPropagation()\n          this.showCancel(row, ord.id)\n        })\n      }\n\n      const accelerateBttn = Doc.tmplElement(row, 'accelerateBttn')\n      bind(accelerateBttn, 'click', e => {\n        e.stopPropagation()\n        this.showAccelerate(ord)\n      })\n      if (app().canAccelerateOrder(ord)) {\n        Doc.show(accelerateBttn)\n      }\n\n      const side = Doc.tmplElement(row, 'side')\n      side.classList.add(ord.sell ? 'sellcolor' : 'buycolor')\n      const link = Doc.tmplElement(row, 'link')\n      link.href = `order/${ord.id}`\n      app().bindInternalNavigation(row)\n      page.liveList.appendChild(row)\n      app().bindTooltips(row)\n    }\n    this.setDepthMarkers()\n  }\n\n  /*\n  * updateUserOrderRow sets the td contents of the user's order table row.\n  */\n  updateUserOrderRow (tr: HTMLElement, ord: Order) {\n    updateDataCol(tr, 'type', OrderUtil.typeString(ord))\n    updateDataCol(tr, 'side', OrderUtil.sellString(ord))\n    updateDataCol(tr, 'age', Doc.timeSince(ord.submitTime))\n    updateDataCol(tr, 'rate', Doc.formatCoinValue(ord.rate / this.market.rateConversionFactor))\n    updateDataCol(tr, 'qty', Doc.formatCoinValue(ord.qty, this.market.baseUnitInfo))\n    updateDataCol(tr, 'filled', `${(OrderUtil.filled(ord) / ord.qty * 100).toFixed(1)}%`)\n    updateDataCol(tr, 'settled', `${(OrderUtil.settled(ord) / ord.qty * 100).toFixed(1)}%`)\n    updateDataCol(tr, 'status', OrderUtil.statusString(ord))\n  }\n\n  /* setMarkers sets the depth chart markers for booked orders. */\n  setDepthMarkers () {\n    const markers: Record<string, DepthMarker[]> = {\n      buys: [],\n      sells: []\n    }\n    const rateFactor = this.market.rateConversionFactor\n    for (const mo of Object.values(this.metaOrders)) {\n      const ord = mo.order\n      if (ord.rate && ord.status === OrderUtil.StatusBooked) {\n        if (ord.sell) {\n          markers.sells.push({\n            rate: ord.rate / rateFactor,\n            active: ord.rate === this.activeMarkerRate\n          })\n        } else {\n          markers.buys.push({\n            rate: ord.rate / rateFactor,\n            active: ord.rate === this.activeMarkerRate\n          })\n        }\n      }\n    }\n    this.depthChart.setMarkers(markers)\n    if (this.book) this.depthChart.draw()\n  }\n\n  /* updateTitle update the browser title based on the midgap value and the\n   * selected assets.\n   */\n  updateTitle () {\n    // gets first price value from buy or from sell, so we can show it on\n    // title.\n    const midGapValue = this.midGapConventional()\n    if (!midGapValue) return\n\n    const { baseCfg: b, quoteCfg: q } = this.market\n    const baseSymb = b.symbol.toUpperCase()\n    const quoteSymb = q.symbol.toUpperCase()\n    // more than 6 numbers it gets too big for the title.\n    document.title = `${Doc.formatCoinValue(midGapValue)} | ${baseSymb}${quoteSymb} | ${this.ogTitle}`\n  }\n\n  /* handleBookRoute is the handler for the 'book' notification, which is sent\n   * in response to a new market subscription. The data received will contain\n   * the entire order book.\n   */\n  handleBookRoute (note: BookUpdate) {\n    app().log('book', 'handleBookRoute:', note)\n    const mktBook = note.payload\n    const market = this.market\n    const page = this.page\n    const host = market.dex.host\n    const [b, q] = [market.baseCfg, market.quoteCfg]\n    if (mktBook.base !== b.id || mktBook.quote !== q.id) return\n    this.refreshActiveOrders()\n    this.handleBook(mktBook)\n    this.updateTitle()\n    Doc.hide(page.marketLoader)\n    this.marketList.select(host, b.id, q.id)\n\n    State.store(lastMarketKey, {\n      host: note.host,\n      base: mktBook.base,\n      quote: mktBook.quote\n    })\n\n    page.lotSize.textContent = Doc.formatCoinValue(market.cfg.lotsize, market.baseUnitInfo)\n    page.rateStep.textContent = Doc.formatCoinValue(market.cfg.ratestep / market.rateConversionFactor)\n    this.baseUnits.forEach(el => { el.textContent = b.symbol.toUpperCase() })\n    this.quoteUnits.forEach(el => { el.textContent = q.symbol.toUpperCase() })\n    this.balanceWgt.setWallets(host, b.id, q.id)\n    this.setMarketBuyOrderEstimate()\n    this.refreshActiveOrders()\n    if (this.loaded) {\n      this.loaded()\n      this.loaded = null\n      Doc.animate(250, progress => {\n        this.main.style.opacity = String(progress)\n      })\n    }\n  }\n\n  /* handleBookOrderRoute is the handler for 'book_order' notifications. */\n  handleBookOrderRoute (data: BookUpdate) {\n    app().log('book', 'handleBookOrderRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const order = data.payload as MiniOrder\n    if (order.rate > 0) this.book.add(order)\n    this.addTableOrder(order)\n    this.updateTitle()\n    this.depthChart.draw()\n  }\n\n  /* handleUnbookOrderRoute is the handler for 'unbook_order' notifications. */\n  handleUnbookOrderRoute (data: BookUpdate) {\n    app().log('book', 'handleUnbookOrderRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const order = data.payload\n    this.book.remove(order.token)\n    this.removeTableOrder(order)\n    this.updateTitle()\n    this.depthChart.draw()\n  }\n\n  /*\n   * handleUpdateRemainingRoute is the handler for 'update_remaining'\n   * notifications.\n   */\n  handleUpdateRemainingRoute (data: BookUpdate) {\n    app().log('book', 'handleUpdateRemainingRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const update = data.payload\n    this.book.updateRemaining(update.token, update.qty, update.qtyAtomic)\n    this.updateTableOrder(update)\n    this.depthChart.draw()\n  }\n\n  /* handleEpochOrderRoute is the handler for 'epoch_order' notifications. */\n  handleEpochOrderRoute (data: BookUpdate) {\n    app().log('book', 'handleEpochOrderRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const order = data.payload\n    if (order.msgRate > 0) this.book.add(order) // No cancels or market orders\n    if (order.qtyAtomic > 0) this.addTableOrder(order) // No cancel orders\n    this.depthChart.draw()\n  }\n\n  /* handleCandlesRoute is the handler for 'candles' notifications. */\n  handleCandlesRoute (data: BookUpdate) {\n    if (this.candlesLoading) {\n      clearTimeout(this.candlesLoading.timer)\n      this.candlesLoading.loaded()\n      this.candlesLoading = null\n    }\n    this.depthChart.hide()\n    this.candleChart.show()\n    if (data.host !== this.market.dex.host) return\n    const dur = data.payload.dur\n    this.market.candleCaches[dur] = data.payload\n    if (this.currentChart !== candleChart || this.candleDur !== dur) return\n    this.candleChart.setCandles(data.payload, this.market.cfg, this.market.baseUnitInfo, this.market.quoteUnitInfo)\n  }\n\n  /* handleCandleUpdateRoute is the handler for 'candle_update' notifications. */\n  handleCandleUpdateRoute (data: BookUpdate) {\n    if (data.host !== this.market.dex.host) return\n    const { dur, candle } = data.payload\n    const cache = this.market.candleCaches[dur]\n    if (!cache) return // must not have seen the 'candles' notification yet?\n    const candles = cache.candles\n    if (candles.length === 0) candles.push(candle)\n    else {\n      const last = candles[candles.length - 1]\n      if (last.startStamp === candle.startStamp) candles[candles.length - 1] = candle\n      else candles.push(candle)\n    }\n    if (this.currentChart !== candleChart || this.candleDur !== dur) return\n    this.candleChart.draw()\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    this.currentForm = form\n    const page = this.page\n    Doc.hide(page.unlockWalletForm, page.verifyForm, page.newWalletForm,\n      page.cancelForm, page.vDetailPane, page.accelerateForm)\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  /* showOpen shows the form to unlock a wallet. */\n  async showOpen (asset: SupportedAsset, f: () => void) {\n    const page = this.page\n    this.openAsset = asset\n    this.openFunc = f\n    this.unlockForm.refresh(app().assets[asset.id])\n    this.showForm(page.unlockWalletForm)\n    page.uwAppPass.focus()\n  }\n\n  /* showVerify shows the form to accept the currently parsed order information\n   * and confirm submission of the order to the dex.\n   */\n  showVerify () {\n    this.preorderCache = {}\n    const page = this.page\n    const order = this.currentOrder = this.parseOrder()\n    const isSell = order.sell\n    const baseAsset = app().assets[order.base]\n    const quoteAsset = app().assets[order.quote]\n    const toAsset = isSell ? quoteAsset : baseAsset\n    const fromAsset = isSell ? baseAsset : quoteAsset\n\n    // Set the to and from icons in the fee details pane.\n    for (const icon of Doc.applySelector(page.vDetailPane, '[data-icon]')) {\n      switch (icon.dataset.icon) {\n        case 'from':\n          icon.src = Doc.logoPath(fromAsset.symbol)\n          break\n        case 'to':\n          icon.src = Doc.logoPath(toAsset.symbol)\n      }\n    }\n\n    Doc.hide(page.vUnlockPreorder, page.vPreorderErr)\n    Doc.show(page.vPreorder)\n\n    page.vBuySell.textContent = isSell ? 'Selling' : 'Buying'\n    const buySellStr = isSell ? intl.prep(intl.ID_SELL) : intl.prep(intl.ID_BUY)\n    page.vSideSubmit.textContent = buySellStr\n    page.vOrderHost.textContent = order.host\n    if (order.isLimit) {\n      Doc.show(page.verifyLimit)\n      Doc.hide(page.verifyMarket)\n      const orderDesc = `Limit ${buySellStr} Order`\n      page.vOrderType.textContent = order.tifnow ? orderDesc + ' (immediate)' : orderDesc\n      page.vRate.textContent = Doc.formatCoinValue(order.rate / this.market.rateConversionFactor)\n      page.vQty.textContent = Doc.formatCoinValue(order.qty, baseAsset.info.unitinfo)\n      const total = order.rate / OrderUtil.RateEncodingFactor * order.qty\n      page.vTotal.textContent = Doc.formatCoinValue(total, quoteAsset.info.unitinfo)\n      // Format total fiat value.\n      this.showFiatValue(quoteAsset.id, total, page.vFiatTotal)\n    } else {\n      Doc.hide(page.verifyLimit)\n      Doc.show(page.verifyMarket)\n      page.vOrderType.textContent = `Market ${buySellStr} Order`\n      const ui = order.sell ? this.market.baseUnitInfo : this.market.quoteUnitInfo\n      page.vmFromTotal.textContent = Doc.formatCoinValue(order.qty, ui)\n      page.vmFromAsset.textContent = fromAsset.symbol.toUpperCase()\n      // Format fromAsset fiat value.\n      this.showFiatValue(fromAsset.id, order.qty, page.vmFromTotalFiat)\n      const gap = this.midGap()\n      if (gap) {\n        Doc.show(page.vMarketEstimate)\n        const received = order.sell ? order.qty * gap : order.qty / gap\n        page.vmToTotal.textContent = Doc.formatCoinValue(received, toAsset.info.unitinfo)\n        page.vmToAsset.textContent = toAsset.symbol.toUpperCase()\n        // Format recieved value to fiat equivalent.\n        this.showFiatValue(toAsset.id, received, page.vmTotalFiat)\n      } else {\n        Doc.hide(page.vMarketEstimate)\n      }\n    }\n    // Visually differentiate between buy/sell orders.\n    const buyBtnClass = 'buygreen'\n    const sellBtnClass = 'sellred'\n    if (isSell) {\n      page.vHeader.classList.add(sellBtnClass)\n      page.vHeader.classList.remove(buyBtnClass)\n      page.vSubmit.classList.add(sellBtnClass)\n      page.vSubmit.classList.remove(buyBtnClass)\n    } else {\n      page.vHeader.classList.add(buyBtnClass)\n      page.vHeader.classList.remove(sellBtnClass)\n      page.vSubmit.classList.add(buyBtnClass)\n      page.vSubmit.classList.remove(sellBtnClass)\n    }\n    this.showVerifyForm()\n    page.vPass.focus()\n\n    if (baseAsset.wallet.open && quoteAsset.wallet.open) this.preOrder(order)\n    else {\n      Doc.hide(page.vPreorder)\n      if (State.passwordIsCached()) this.unlockWalletsForEstimates('')\n      else Doc.show(page.vUnlockPreorder)\n    }\n  }\n\n  // showFiatValue displays the fiat equivalent for an order quantity.\n  showFiatValue (assetID: number, qty: number, display: PageElement) {\n    if (display) {\n      const rate = app().fiatRatesMap[assetID]\n      display.textContent = Doc.formatFiatConversion(qty, rate, app().unitInfo(assetID))\n      if (rate) Doc.show(display.parentElement as Element)\n      else Doc.hide(display.parentElement as Element)\n    }\n  }\n\n  /* showVerifyForm displays form to verify an order */\n  async showVerifyForm () {\n    const page = this.page\n    Doc.hide(page.vErr)\n    this.showForm(page.verifyForm)\n  }\n\n  /*\n   * submitEstimateUnlock reads the current vUnlockPass and unlocks any locked\n   * wallets.\n   */\n  async submitEstimateUnlock () {\n    const pw = this.page.vUnlockPass.value || ''\n    return await this.unlockWalletsForEstimates(pw)\n  }\n\n  /*\n   * unlockWalletsForEstimates unlocks any locked wallets with the provided\n   * password.\n   */\n  async unlockWalletsForEstimates (pw: string) {\n    const page = this.page\n    const loaded = app().loading(page.verifyForm)\n    const err = await this.attemptWalletUnlock(pw)\n    loaded()\n    if (err) return this.setPreorderErr(err)\n    Doc.show(page.vPreorder)\n    Doc.hide(page.vUnlockPreorder)\n    this.preOrder(this.parseOrder())\n  }\n\n  /*\n   * attemptWalletUnlock unlocks both the base and quote wallets for the current\n   * market, if locked.\n   */\n  async attemptWalletUnlock (pw: string) {\n    const { base, quote } = this.market\n    const assetIDs = []\n    if (!base.wallet.open) assetIDs.push(base.id)\n    if (!quote.wallet.open) assetIDs.push(quote.id)\n    const req = {\n      pass: pw,\n      assetID: -1\n    }\n    for (const assetID of assetIDs) {\n      req.assetID = assetID\n      const res = await postJSON('/api/openwallet', req)\n      if (!app().checkResponse(res, true)) {\n        return res.msg\n      }\n    }\n  }\n\n  /* fetchPreorder fetches the pre-order estimates and options. */\n  async fetchPreorder (order: TradeForm) {\n    const page = this.page\n    const cacheKey = JSON.stringify(order.options)\n    const cached = this.preorderCache[cacheKey]\n    if (cached) return cached\n\n    Doc.hide(page.vPreorderErr)\n    const loaded = app().loading(page.verifyForm)\n    const res = await postJSON('/api/preorder', wireOrder(order))\n    loaded()\n    if (!app().checkResponse(res, true)) return { err: res.msg }\n    this.preorderCache[cacheKey] = res.estimate\n    return res.estimate\n  }\n\n  /*\n   * setPreorderErr sets and displays the pre-order error message and hides the\n   * pre-order details box.\n   */\n  setPreorderErr (msg: string) {\n    const page = this.page\n    Doc.hide(page.vPreorder)\n    Doc.show(page.vPreorderErr)\n    page.vPreorderErrTip.dataset.tooltip = msg\n  }\n\n  /* preOrder loads the options and fetches pre-order estimates */\n  async preOrder (order: TradeForm) {\n    // if (!this.validateOrder(order)) return\n    const page = this.page\n\n    // Add swap options.\n    const refreshPreorder = async () => {\n      const res: APIResponse = await this.fetchPreorder(order)\n      if (res.err) return this.setPreorderErr(res.err)\n      const est = (res as any) as OrderEstimate\n      Doc.hide(page.vPreorderErr)\n      Doc.show(page.vPreorder)\n      const { swap, redeem } = est\n      Doc.empty(page.vOrderOpts)\n      swap.options = swap.options || []\n      redeem.options = redeem.options || []\n      this.setFeeEstimates(swap, redeem, order)\n\n      const changed = async () => {\n        await refreshPreorder()\n        Doc.animate(400, progress => {\n          page.vFeeSummary.style.backgroundColor = `rgba(128, 128, 128, ${0.5 - 0.5 * progress})`\n        })\n      }\n      const addOption = (opt: OrderOption, isSwap: boolean) => page.vOrderOpts.appendChild(OrderUtil.optionElement(opt, order, changed, isSwap))\n      for (const opt of swap.options || []) addOption(opt, true)\n      for (const opt of redeem.options || []) addOption(opt, false)\n      app().bindTooltips(page.vOrderOpts)\n    }\n\n    refreshPreorder()\n  }\n\n  /* setFeeEstimates sets all of the pre-order estimate fields */\n  setFeeEstimates (swap: PreSwap, redeem: PreRedeem, order: TradeForm) {\n    const { page, market } = this\n    const { baseUnitInfo, quoteUnitInfo, rateConversionFactor } = market\n    const swapped = swap.estimate.value || 0\n    const fmtPct = percentFormatter.format\n\n    let [toUI, fromUI] = [baseUnitInfo, quoteUnitInfo]\n    if (this.currentOrder.sell) {\n      [fromUI, toUI] = [toUI, fromUI]\n    }\n\n    // Set swap fee estimates in the details pane.\n    const bestSwapPct = swap.estimate.realisticBestCase / swapped * 100\n    page.vSwapFeesLowPct.textContent = `${fmtPct(bestSwapPct)}%`\n    page.vSwapFeesLow.textContent = Doc.formatCoinValue(swap.estimate.realisticBestCase, fromUI)\n    const worstSwapPct = swap.estimate.realisticWorstCase / swapped * 100\n    page.vSwapFeesHighPct.textContent = `${fmtPct(worstSwapPct)}%`\n    page.vSwapFeesHigh.textContent = Doc.formatCoinValue(swap.estimate.realisticWorstCase, fromUI)\n    page.vSwapFeesMaxPct.textContent = `${fmtPct(swap.estimate.maxFees / swapped * 100)}%`\n    page.vSwapFeesMax.textContent = Doc.formatCoinValue(swap.estimate.maxFees, fromUI)\n\n    // Set redemption fee estimates in the details pane.\n    const midGap = this.midGap()\n    const estRate = midGap || order.rate / rateConversionFactor\n    const received = order.sell ? swapped * estRate : swapped / estRate\n    const bestRedeemPct = redeem.estimate.realisticBestCase / received * 100\n    page.vRedeemFeesLowPct.textContent = `${fmtPct(bestRedeemPct)}%`\n    page.vRedeemFeesLow.textContent = Doc.formatCoinValue(redeem.estimate.realisticBestCase, toUI)\n    const worstRedeemPct = redeem.estimate.realisticWorstCase / received * 100\n    page.vRedeemFeesHighPct.textContent = `${fmtPct(worstRedeemPct)}%`\n    page.vRedeemFeesHigh.textContent = Doc.formatCoinValue(redeem.estimate.realisticWorstCase, toUI)\n\n    // Set the summary percent, which is a simple addition of swap and redeem\n    // loss percents.\n    page.vFeeSummaryLow.textContent = fmtPct(bestSwapPct + bestRedeemPct)\n    page.vFeeSummaryHigh.textContent = fmtPct(worstSwapPct + worstRedeemPct)\n  }\n\n  async submitCancel () {\n    // this will be the page.cancelSubmit button (evt.currentTarget)\n    const page = this.page\n    const cancelData = this.cancelData\n    const order = cancelData.order\n    const req = {\n      orderID: order.id,\n      pw: page.cancelPass.value\n    }\n    page.cancelPass.value = ''\n    // Toggle the loader and submit button.\n    const loaded = app().loading(page.cancelSubmit)\n    const res = await postJSON('/api/cancel', req)\n    loaded()\n    // Display error on confirmation modal.\n    if (!app().checkResponse(res, true)) {\n      page.cancelErr.textContent = res.msg\n      Doc.show(page.cancelErr)\n      return\n    }\n    // Hide confirmation modal only on success.\n    Doc.hide(cancelData.bttn, page.forms)\n    order.cancelling = true\n  }\n\n  /* showCancel shows a form to confirm submission of a cancel order. */\n  showCancel (row: HTMLElement, orderID: string) {\n    const order = this.metaOrders[orderID].order\n    const page = this.page\n    const remaining = order.qty - order.filled\n    const asset = OrderUtil.isMarketBuy(order) ? this.market.quote : this.market.base\n    page.cancelRemain.textContent = Doc.formatCoinValue(remaining, asset.info.unitinfo)\n    page.cancelUnit.textContent = asset.symbol.toUpperCase()\n    Doc.hide(page.cancelErr)\n    this.showForm(page.cancelForm)\n    page.cancelPass.focus()\n    this.cancelData = {\n      bttn: Doc.tmplElement(row, 'cancelBttn'),\n      order: order\n    }\n  }\n\n  /* showAccelerate shows the accelerate order form. */\n  showAccelerate (order: Order) {\n    const loaded = app().loading(this.main)\n    this.accelerateOrderForm.refresh(order)\n    loaded()\n    this.showForm(this.page.accelerateForm)\n  }\n\n  /* showCreate shows the new wallet creation form. */\n  showCreate (asset: SupportedAsset) {\n    const page = this.page\n    this.currentCreate = asset\n    this.newWalletForm.setAsset(asset.id)\n    this.showForm(page.newWalletForm)\n    this.newWalletForm.loadDefaults()\n  }\n\n  /*\n   * stepSubmit will examine the current state of wallets and step the user\n   * through the process of order submission.\n   * NOTE: I expect this process will be streamlined soon such that the wallets\n   * will attempt to be unlocked in the order submission process, negating the\n   * need to unlock ahead of time.\n   */\n  stepSubmit () {\n    const page = this.page\n    const market = this.market\n    Doc.hide(page.orderErr)\n    if (!this.validateOrder(this.parseOrder())) return\n    const baseWallet = app().walletMap[market.base.id]\n    const quoteWallet = app().walletMap[market.quote.id]\n    if (!baseWallet) {\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ASSET_WALLET, { asset: market.base.symbol })\n      Doc.show(page.orderErr)\n      return\n    }\n    if (!quoteWallet) {\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ASSET_WALLET, { asset: market.quote.symbol })\n      Doc.show(page.orderErr)\n      return\n    }\n    this.showVerify()\n  }\n\n  handlePriceUpdate (note: SpotPriceNote) {\n    const xcSection = this.marketList.xcSection(note.host)\n    if (!xcSection) return\n    for (const spot of Object.values(note.spots)) {\n      const marketRow = xcSection.marketRow(spot.baseID, spot.quoteID)\n      if (marketRow) marketRow.setSpot(spot)\n    }\n  }\n\n  /*\n   * handleFeePayment is the handler for the 'feepayment' notification type.\n   * This is used to update the registration status of the current exchange.\n   */\n  handleFeePayment (note: FeePaymentNote) {\n    const dexAddr = note.dex\n    if (dexAddr !== this.market.dex.host) return\n    // update local dex\n    this.market.dex = app().exchanges[dexAddr]\n    this.setRegistrationStatusVisibility()\n  }\n\n  /*\n   * handleOrderNote is the handler for the 'order'-type notification, which are\n   * used to update a user's order's status.\n   */\n  handleOrderNote (note: OrderNote) {\n    const order = note.order\n    const metaOrder = this.metaOrders[order.id]\n    // If metaOrder doesn't exist for the given order it means it was\n    // created via dexcctl and the GUI isn't aware of it.\n    // Call refreshActiveOrders to grab the order.\n    if (!metaOrder) return this.refreshActiveOrders()\n    const oldStatus = metaOrder.status\n    metaOrder.order = order\n    const cancelBttn = Doc.tmplElement(metaOrder.row, 'cancelBttn')\n    if (note.topic === 'MissedCancel') Doc.show(cancelBttn)\n    if (order.filled === order.qty) Doc.hide(cancelBttn)\n    const accelerateBttn = Doc.tmplElement(metaOrder.row, 'accelerateBttn')\n    if (app().canAccelerateOrder(order)) Doc.show(accelerateBttn)\n    else Doc.hide(accelerateBttn)\n    this.updateUserOrderRow(metaOrder.row, order)\n    // Only reset markers if there is a change, since the chart is redrawn.\n    if ((oldStatus === OrderUtil.StatusEpoch && order.status === OrderUtil.StatusBooked) ||\n      (oldStatus === OrderUtil.StatusBooked && order.status > OrderUtil.StatusBooked)) this.setDepthMarkers()\n  }\n\n  /*\n   * handleEpochNote handles notifications signalling the start of a new epoch.\n   */\n  handleEpochNote (note: EpochNote) {\n    app().log('book', 'handleEpochNote:', note)\n    if (note.host !== this.market.dex.host || note.marketID !== this.market.sid) return\n    if (this.book) {\n      this.book.setEpoch(note.epoch)\n      this.depthChart.draw()\n    }\n\n    this.clearOrderTableEpochs()\n    for (const metaOrder of Object.values(this.metaOrders)) {\n      const order = metaOrder.order\n      const alreadyMatched = note.epoch > order.epoch\n      const statusTD = Doc.tmplElement(metaOrder.row, 'status')\n      switch (true) {\n        case order.type === OrderUtil.Limit && order.status === OrderUtil.StatusEpoch && alreadyMatched:\n          statusTD.textContent = order.tif === OrderUtil.ImmediateTiF ? intl.prep(intl.ID_EXECUTED) : intl.prep(intl.ID_BOOKED)\n          order.status = order.tif === OrderUtil.ImmediateTiF ? OrderUtil.StatusExecuted : OrderUtil.StatusBooked\n          break\n        case order.type === OrderUtil.Market && order.status === OrderUtil.StatusEpoch:\n          // Technically don't know if this should be 'executed' or 'settling'.\n          statusTD.textContent = intl.prep(intl.ID_EXECUTED)\n          order.status = OrderUtil.StatusExecuted\n          break\n      }\n    }\n  }\n\n  setBalanceVisibility () {\n    if (this.market.dex.connectionStatus === ConnectionStatus.Connected) {\n      Doc.show(this.page.balanceTable)\n    } else {\n      Doc.hide(this.page.balanceTable)\n    }\n  }\n\n  /* handleBalanceNote handles notifications updating a wallet's balance. */\n  handleBalanceNote (note: BalanceNote) {\n    this.setBalanceVisibility()\n    // if connection to dex server fails, it is not possible to retrieve\n    // markets.\n    if (this.market.dex.connectionStatus !== ConnectionStatus.Connected) return\n    // If there's a balance update, refresh the max order section.\n    const mkt = this.market\n    const avail = note.balance.available\n    switch (note.assetID) {\n      case mkt.baseCfg.id:\n        // If we're not showing the max order panel yet, don't do anything.\n        if (!mkt.maxSell) break\n        if (typeof mkt.sellBalance === 'number' && mkt.sellBalance !== avail) mkt.maxSell = null\n        if (this.isSell()) this.preSell()\n        break\n      case mkt.quoteCfg.id:\n        if (!Object.keys(mkt.maxBuys).length) break\n        if (typeof mkt.buyBalance === 'number' && mkt.buyBalance !== avail) mkt.maxBuys = {}\n        if (!this.isSell()) this.preBuy()\n    }\n  }\n\n  /*\n   * submitOrder is attached to the affirmative button on the order validation\n   * form. Clicking the button is the last step in the order submission process.\n   */\n  async submitOrder () {\n    const page = this.page\n    Doc.hide(page.orderErr, page.vErr)\n    const order = this.currentOrder\n    const pw = page.vPass.value\n    page.vPass.value = ''\n    const req = {\n      order: wireOrder(order),\n      pw: pw\n    }\n    if (!this.validateOrder(order)) return\n    // Show loader and hide submit button.\n    page.vSubmit.classList.add('d-hide')\n    page.vLoader.classList.remove('d-hide')\n    const res = await postJSON('/api/trade', req)\n    // Hide loader and show submit button.\n    page.vSubmit.classList.remove('d-hide')\n    page.vLoader.classList.add('d-hide')\n    // If errors display error on confirmation modal.\n    if (!app().checkResponse(res, true)) {\n      page.vErr.textContent = res.msg\n      Doc.show(page.vErr)\n      return\n    }\n    // Hide confirmation modal only on success.\n    Doc.hide(page.forms)\n    this.refreshActiveOrders()\n    this.depthChart.draw()\n  }\n\n  /*\n   * createWallet is attached to successful submission of the wallet creation\n   * form. createWallet is only called once the form is submitted and a success\n   * response is received from the client.\n   */\n  async createWallet () {\n    const user = await app().fetchUser()\n    if (!user) return\n    const asset = user.assets[this.currentCreate.id]\n    Doc.hide(this.page.forms)\n    this.balanceWgt.updateAsset(asset.id)\n    this.resolveOrderFormVisibility()\n  }\n\n  /*\n   * walletUnlocked is attached to successful submission of the wallet unlock\n   * form. walletUnlocked is only called once the form is submitted and a\n   * success response is received from the client.\n   */\n  async walletUnlocked () {\n    Doc.hide(this.page.forms)\n    this.balanceWgt.updateAsset(this.openAsset.id)\n  }\n\n  /* lotChanged is attached to the keyup and change events of the lots input. */\n  lotChanged () {\n    const page = this.page\n    const lots = parseInt(page.lotField.value || '0')\n    if (lots <= 0) {\n      page.lotField.value = '0'\n      page.qtyField.value = ''\n      this.previewQuoteAmt(false)\n      return\n    }\n    const lotSize = this.market.cfg.lotsize\n    page.lotField.value = String(lots)\n    // Conversion factor must be a multiple of 10.\n    page.qtyField.value = String(lots * lotSize / this.market.baseUnitInfo.conventional.conversionFactor)\n    this.previewQuoteAmt(true)\n  }\n\n  /*\n   * quantityChanged is attached to the keyup and change events of the quantity\n   * input.\n   */\n  quantityChanged (finalize: boolean) {\n    const page = this.page\n    const order = this.parseOrder()\n    if (order.qty < 0) {\n      page.lotField.value = '0'\n      page.qtyField.value = ''\n      this.previewQuoteAmt(false)\n      return\n    }\n    const lotSize = this.market.cfg.lotsize\n    const lots = Math.floor(order.qty / lotSize)\n    const adjusted = lots * lotSize\n    page.lotField.value = String(lots)\n    if (!order.isLimit && !order.sell) return\n    // Conversion factor must be a multiple of 10.\n    if (finalize) page.qtyField.value = String(adjusted / this.market.baseUnitInfo.conventional.conversionFactor)\n    this.previewQuoteAmt(true)\n  }\n\n  /*\n   * marketBuyChanged is attached to the keyup and change events of the quantity\n   * input for the market-buy form.\n   */\n  marketBuyChanged () {\n    const page = this.page\n    const qty = convertToAtoms(page.mktBuyField.value || '', this.market.quoteUnitInfo.conventional.conversionFactor)\n    const gap = this.midGap()\n    if (!gap || !qty) {\n      page.mktBuyLots.textContent = '0'\n      page.mktBuyScore.textContent = '0'\n      return\n    }\n    const lotSize = this.market.cfg.lotsize\n    const received = qty / gap\n    page.mktBuyLots.textContent = (received / lotSize).toFixed(1)\n    page.mktBuyScore.textContent = Doc.formatCoinValue(received, this.market.baseUnitInfo)\n  }\n\n  /*\n   * rateFieldChanged is attached to the keyup and change events of the rate\n   * input.\n   */\n  rateFieldChanged () {\n    // Truncate to rate step. If it is a market buy order, do not adjust.\n    const adjusted = this.adjustedRate()\n    if (adjusted <= 0) {\n      this.depthLines.input = []\n      this.drawChartLines()\n      this.page.rateField.value = '0'\n      return\n    }\n    const order = this.parseOrder()\n    const r = adjusted / this.market.rateConversionFactor\n    this.page.rateField.value = String(r)\n    this.depthLines.input = [{\n      rate: r,\n      color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine\n    }]\n    this.drawChartLines()\n    this.previewQuoteAmt(true)\n  }\n\n  /*\n   * adjustedRate is the current rate field rate, rounded down to a\n   * multiple of rateStep.\n   */\n  adjustedRate (): number {\n    const v = this.page.rateField.value\n    if (!v) return NaN\n    const rate = convertToAtoms(v, this.market.rateConversionFactor)\n    const rateStep = this.market.cfg.ratestep\n    return rate - (rate % rateStep)\n  }\n\n  /* loadTable reloads the table from the current order book information. */\n  loadTable () {\n    this.loadTableSide(true)\n    this.loadTableSide(false)\n  }\n\n  /* binOrdersByRateAndEpoch takes a list of sorted orders and returns the\n     same orders grouped into arrays. The orders are grouped by their rate\n     and whether or not they are epoch queue orders. Epoch queue orders\n     will come after non epoch queue orders with the same rate. */\n  binOrdersByRateAndEpoch (orders: MiniOrder[]) {\n    if (!orders || !orders.length) return []\n    const bins = []\n    let currEpochBin = []\n    let currNonEpochBin = []\n    let currRate = orders[0].msgRate\n    if (orders[0].epoch) currEpochBin.push(orders[0])\n    else currNonEpochBin.push(orders[0])\n    for (let i = 1; i < orders.length; i++) {\n      if (orders[i].msgRate !== currRate) {\n        bins.push(currNonEpochBin)\n        bins.push(currEpochBin)\n        currEpochBin = []\n        currNonEpochBin = []\n        currRate = orders[i].msgRate\n      }\n      if (orders[i].epoch) currEpochBin.push(orders[i])\n      else currNonEpochBin.push(orders[i])\n    }\n    bins.push(currNonEpochBin)\n    bins.push(currEpochBin)\n    return bins.filter(bin => bin.length > 0)\n  }\n\n  /* loadTables loads the order book side into its table. */\n  loadTableSide (sell: boolean) {\n    const bookSide = sell ? this.book.sells : this.book.buys\n    const tbody = sell ? this.page.sellRows : this.page.buyRows\n    Doc.empty(tbody)\n    if (!bookSide || !bookSide.length) return\n    const orderBins = this.binOrdersByRateAndEpoch(bookSide)\n    orderBins.forEach(bin => { tbody.appendChild(this.orderTableRow(bin)) })\n  }\n\n  /* addTableOrder adds a single order to the appropriate table. */\n  addTableOrder (order: MiniOrder) {\n    const tbody = order.sell ? this.page.sellRows : this.page.buyRows\n    let row = tbody.firstChild as OrderRow\n    // Handle market order differently.\n    if (order.rate === 0) {\n      // This is a market order.\n      if (row && row.manager.getRate() === 0) {\n        row.manager.insertOrder(order)\n      } else {\n        row = this.orderTableRow([order])\n        tbody.insertBefore(row, tbody.firstChild)\n      }\n      return\n    }\n    // Must be a limit order. Sort by rate. Skip the market order row.\n    if (row && row.manager.getRate() === 0) row = row.nextSibling as OrderRow\n    while (row) {\n      if (row.manager.compare(order) === 0) {\n        row.manager.insertOrder(order)\n        return\n      } else if (row.manager.compare(order) > 0) {\n        const tr = this.orderTableRow([order])\n        tbody.insertBefore(tr, row)\n        return\n      }\n      row = row.nextSibling as OrderRow\n    }\n    const tr = this.orderTableRow([order])\n    tbody.appendChild(tr)\n  }\n\n  /* removeTableOrder removes a single order from its table. */\n  removeTableOrder (order: MiniOrder) {\n    const token = order.token\n    for (const tbody of [this.page.sellRows, this.page.buyRows]) {\n      for (const tr of (Array.from(tbody.children) as OrderRow[])) {\n        if (tr.manager.removeOrder(token)) {\n          return\n        }\n      }\n    }\n  }\n\n  /* updateTableOrder looks for the order in the table and updates the qty */\n  updateTableOrder (u: RemainderUpdate) {\n    for (const tbody of [this.page.sellRows, this.page.buyRows]) {\n      for (const tr of (Array.from(tbody.children) as OrderRow[])) {\n        if (tr.manager.updateOrderQty(u)) {\n          return\n        }\n      }\n    }\n  }\n\n  /*\n   * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired.\n   */\n  clearOrderTableEpochs () {\n    this.clearOrderTableEpochSide(this.page.sellRows)\n    this.clearOrderTableEpochSide(this.page.buyRows)\n  }\n\n  /*\n   * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired\n   * for a single side.\n   */\n  clearOrderTableEpochSide (tbody: HTMLElement) {\n    for (const tr of (Array.from(tbody.children)) as OrderRow[]) {\n      tr.manager.removeEpochOrders()\n    }\n  }\n\n  /*\n   * orderTableRow creates a new <tr> element to insert into an order table.\n     Takes a bin of orders with the same rate, and displays the total quantity.\n   */\n  orderTableRow (orderBin: MiniOrder[]): OrderRow {\n    const tr = this.page.rowTemplate.cloneNode(true) as OrderRow\n    const { baseUnitInfo, rateConversionFactor } = this.market\n    const manager = new OrderTableRowManager(tr, orderBin, baseUnitInfo, rateConversionFactor)\n    tr.manager = manager\n    bind(tr, 'click', () => {\n      this.reportDepthClick(tr.manager.getRate() / rateConversionFactor)\n    })\n    if (tr.manager.getRate() !== 0) {\n      Doc.bind(tr, 'mouseenter', () => {\n        const chart = this.depthChart\n        this.depthLines.hover = [{\n          rate: tr.manager.getRate() / rateConversionFactor,\n          color: tr.manager.isSell() ? chart.theme.sellLine : chart.theme.buyLine\n        }]\n        this.drawChartLines()\n      })\n    }\n    return tr\n  }\n\n  /* handleConnNote handles the 'conn' notification.\n   */\n  async handleConnNote (note: ConnEventNote) {\n    this.marketList.setConnectionStatus(note)\n    if (note.connectionStatus === ConnectionStatus.Connected) {\n      // Having been disconnected from a DEX server, anything may have changed,\n      // or this may be the first opportunity to get the server's config, so\n      // fetch it all before reloading the markets page.\n      await app().fetchUser()\n      app().loadPage('markets')\n    }\n  }\n\n  /*\n   * filterMarkets sets the display of markets in the markets list based on the\n   * value of the search input.\n   */\n  filterMarkets () {\n    const filterTxt = this.page.marketSearch.value\n    const filter = filterTxt ? (mkt: MarketRow) => mkt.name.includes(filterTxt) : () => true\n    this.marketList.setFilter(filter)\n  }\n\n  /* drawChartLines draws the hover and input lines on the chart. */\n  drawChartLines () {\n    this.depthChart.setLines([...this.depthLines.hover, ...this.depthLines.input])\n    this.depthChart.draw()\n  }\n\n  /*\n   * depthChartSelected is called when the user clicks a button to show the\n   * depth chart.\n  */\n  depthChartSelected () {\n    const page = this.page\n    Doc.hide(page.depthBttn, page.durBttnBox, page.candleHoverData)\n    Doc.show(page.candlestickBttn, page.epochLine, page.depthHoverData, page.depthSummary)\n    this.currentChart = depthChart\n    this.depthChart.show()\n    this.candleChart.hide()\n  }\n\n  /*\n   * candleChartSelected is called when the user clicks a button to show the\n   * historical market data (candlestick) chart.\n  */\n  candleChartSelected () {\n    const page = this.page\n    const dex = this.market.dex\n    this.currentChart = candleChart\n    Doc.hide(page.candlestickBttn, page.epochLine, page.depthHoverData, page.depthSummary)\n    Doc.show(page.depthBttn, page.durBttnBox, page.candleHoverData)\n    if (dex.candleDurs.indexOf(this.candleDur) === -1) this.candleDur = dex.candleDurs[0]\n    this.loadCandles()\n  }\n\n  /* candleDurationSelected sets the candleDur and loads the candles. */\n  candleDurationSelected (dur: string) {\n    this.candleDur = dur\n    this.loadCandles()\n  }\n\n  /*\n   * loadCandles loads the candles for the current candleDur. If a cache is already\n   * active, the cache will be used without a loadcandles request.\n   */\n  loadCandles () {\n    for (const bttn of Doc.kids(this.page.durBttnBox)) {\n      if (bttn.textContent === this.candleDur) bttn.classList.add('selected')\n      else bttn.classList.remove('selected')\n    }\n    const { candleCaches, cfg, baseUnitInfo, quoteUnitInfo } = this.market\n    const cache = candleCaches[this.candleDur]\n    if (cache) {\n      this.depthChart.hide()\n      this.candleChart.show()\n      this.candleChart.setCandles(cache, cfg, baseUnitInfo, quoteUnitInfo)\n      return\n    }\n    this.requestCandles()\n  }\n\n  /* requestCandles sends the loadcandles request. */\n  requestCandles () {\n    this.candlesLoading = {\n      loaded: () => { Doc.hide(this.page.marketLoader) },\n      timer: window.setTimeout(() => {\n        if (this.candlesLoading) {\n          this.candlesLoading = null\n          Doc.hide(this.page.marketLoader)\n          console.error('candles not received')\n        }\n      }, 10000)\n    }\n    const { dex, baseCfg, quoteCfg } = this.market\n    ws.request('loadcandles', { host: dex.host, base: baseCfg.id, quote: quoteCfg.id, dur: this.candleDur })\n  }\n\n  /*\n   * unload is called by the Application when the user navigates away from\n   * the /markets page.\n   */\n  unload () {\n    ws.request(unmarketRoute, {})\n    ws.deregisterRoute(bookRoute)\n    ws.deregisterRoute(epochOrderRoute)\n    ws.deregisterRoute(bookOrderRoute)\n    ws.deregisterRoute(unbookOrderRoute)\n    ws.deregisterRoute(candlesRoute)\n    ws.deregisterRoute(candleUpdateRoute)\n    this.depthChart.unattach()\n    this.candleChart.unattach()\n    Doc.unbind(document, 'keyup', this.keyup)\n    clearInterval(this.secondTicker)\n  }\n}\n\n/*\n *  MarketList represents the list of exchanges and markets on the left side of\n * markets view. The MarketList provides utilities for adjusting the visibility\n * and sort order of markets.\n */\nclass MarketList {\n  xcSections: ExchangeSection[]\n  selected: MarketRow\n\n  constructor (div: HTMLElement) {\n    const xcTmpl = Doc.tmplElement(div, 'xc')\n    Doc.cleanTemplates(xcTmpl)\n    this.xcSections = []\n    for (const dex of Object.values(app().user.exchanges)) {\n      this.xcSections.push(new ExchangeSection(xcTmpl, dex))\n    }\n    // Initial sort is alphabetical.\n    for (const xc of this.sortedSections()) {\n      div.appendChild(xc.node)\n    }\n  }\n\n  /*\n   * sortedSections returns a list of ExchangeSection sorted alphabetically by\n   * host.\n   */\n  sortedSections () {\n    return [...this.xcSections].sort((a, b) => a.host < b.host ? -1 : 1)\n  }\n\n  /*\n   * xcSection is a getter for the ExchangeSection for a specified host.\n   */\n  xcSection (host: string) {\n    for (const xc of this.xcSections) {\n      if (xc.host === host) return xc\n    }\n    return null\n  }\n\n  /* exists will be true if the specified market exists. */\n  exists (host: string, baseID: number, quoteID: number) {\n    const xc = this.xcSection(host)\n    // If connecting to an offline server the client is not able to get xc.marketRows.\n    // Therefore we must check for it.\n    if (!xc || !xc.marketRows) return false\n    for (const mkt of xc.marketRows) {\n      if (mkt.baseID === baseID && mkt.quoteID === quoteID) return true\n    }\n    return false\n  }\n\n  /* first gets the first market from the first exchange, alphabetically. */\n  first () {\n    const firstXC = this.sortedSections()[0]\n    const firstMkt = firstXC.first()\n    // Cannot find markets if server connection failed.\n    if (!firstMkt) return makeMarket(firstXC.host)\n    return makeMarket(firstXC.host, firstMkt.baseID, firstMkt.quoteID)\n  }\n\n  /* select sets the specified market as selected. */\n  select (host: string, baseID: number, quoteID: number) {\n    if (this.selected) this.selected.node.classList.remove('selected')\n    const xcSection = this.xcSection(host)\n    if (!xcSection) return console.error(`select: no exchange section for ${host}`)\n    const marketRow = xcSection.marketRow(baseID, quoteID)\n    if (!marketRow) return console.error(`select: no market row for ${host}, ${baseID}-${quoteID}`)\n    this.selected = marketRow\n    this.selected.node.classList.add('selected')\n  }\n\n  /* setConnectionStatus sets the visibility of the disconnected icon based\n   * on the core.ConnEventNote.\n   */\n  setConnectionStatus (note: ConnEventNote) {\n    const xcSection = this.xcSection(note.host)\n    if (!xcSection) return console.error(`setConnectionStatus: no exchange section for ${note.host}`)\n    xcSection.setConnected(note.connectionStatus === ConnectionStatus.Connected)\n  }\n\n  /*\n   * setFilter sets the visibility of market rows based on the provided filter.\n   */\n  setFilter (filter: (mkt: MarketRow) => boolean) {\n    for (const xc of this.xcSections) {\n      xc.setFilter(filter)\n    }\n  }\n}\n\n/*\n * ExchangeSection is a top level section of the MarketList.\n */\nclass ExchangeSection {\n  marketRows: MarketRow[]\n  host: string\n  dex: Exchange\n  node: HTMLElement\n  disconnectedIco: PageElement\n\n  constructor (template: HTMLElement, dex: Exchange) {\n    this.dex = dex\n    this.host = dex.host\n    this.node = template.cloneNode(true) as HTMLElement\n    const tmpl = Doc.parseTemplate(this.node)\n    tmpl.header.textContent = dex.host\n\n    this.disconnectedIco = tmpl.disconnected\n    if (dex.connectionStatus === ConnectionStatus.Connected) Doc.hide(tmpl.disconnected)\n\n    tmpl.mkts.removeChild(tmpl.mktrow)\n    // If disconnected is not possible to get the markets from the server.\n    if (!dex.markets) return\n\n    this.marketRows = Object.values(dex.markets).map(mkt => {\n      const bui = app().unitInfo(mkt.baseid, dex)\n      const qui = app().unitInfo(mkt.quoteid, dex)\n      const rateConversionFactor = OrderUtil.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor\n      return new MarketRow(tmpl.mktrow, mkt, rateConversionFactor)\n    })\n\n    // for (const mkt of Object.values(dex.markets)) {\n    //   this.marketRows.push(new MarketRow(tmpl.mktrow, mkt))\n    // }\n    for (const market of this.sortedMarkets()) {\n      tmpl.mkts.appendChild(market.node)\n    }\n  }\n\n  /*\n   * sortedMarkets is the list of MarketRow sorted alphabetically by the base\n   * symbol first, quote symbol second.\n   */\n  sortedMarkets () {\n    if (!this.marketRows) return []\n    return [...this.marketRows].sort((a, b) => a.name < b.name ? -1 : 1)\n  }\n\n  /*\n   * first returns the first market in the alphabetically-sorted list of\n   * markets.\n   */\n  first () {\n    return this.sortedMarkets()[0]\n  }\n\n  /*\n   * marketRow gets the MarketRow for the specified market.\n   */\n  marketRow (baseID: number, quoteID: number) {\n    for (const mkt of this.marketRows) {\n      if (mkt.baseID === baseID && mkt.quoteID === quoteID) return mkt\n    }\n  }\n\n  /* setConnected sets the visiblity of the disconnected icon. */\n  setConnected (isConnected: boolean) {\n    if (isConnected) Doc.hide(this.disconnectedIco)\n    else Doc.show(this.disconnectedIco)\n  }\n\n  /*\n   * setFilter sets the visibility of market rows based on the provided filter.\n   */\n  setFilter (filter: (mkt: MarketRow) => boolean) {\n    for (const mkt of this.marketRows) {\n      if (filter(mkt)) Doc.show(mkt.node)\n      else Doc.hide(mkt.node)\n    }\n  }\n}\n\n/*\n * MarketRow represents one row in the MarketList. A MarketRow is a subsection\n * of the ExchangeSection.\n */\nclass MarketRow {\n  node: HTMLElement\n  mkt: Market\n  name: string\n  baseID: number\n  quoteID: number\n  lotSize: number\n  rateStep: number\n  tmpl: Record<string, PageElement>\n  rateConversionFactor: number\n\n  constructor (template: HTMLElement, mkt: Market, rateConversionFactor: number) {\n    this.mkt = mkt\n    this.name = mkt.name\n    this.baseID = mkt.baseid\n    this.quoteID = mkt.quoteid\n    this.lotSize = mkt.lotsize\n    this.rateStep = mkt.ratestep\n    this.rateConversionFactor = rateConversionFactor\n    this.node = template.cloneNode(true) as HTMLElement\n    const tmpl = this.tmpl = Doc.parseTemplate(this.node)\n    tmpl.baseIcon.src = Doc.logoPath(mkt.basesymbol)\n    tmpl.quoteIcon.src = Doc.logoPath(mkt.quotesymbol)\n    tmpl.baseSymbol.textContent = mkt.basesymbol.toUpperCase()\n    tmpl.quoteSymbol.textContent = mkt.quotesymbol.toUpperCase()\n    this.setSpot(mkt.spot)\n  }\n\n  setSpot (spot: Spot) {\n    if (!spot) return\n    const { tmpl, mkt } = this\n\n    Doc.show(tmpl.pctChange)\n    const pct = spot.change24 * 100\n    const num = percentFormatter.format(pct)\n    const sign = pct > 0 ? '+' : ''\n    tmpl.pctChange.textContent = `${sign}${num}%`\n    tmpl.pctChange.classList.remove('upgreen', 'downred', 'grey')\n    tmpl.pctChange.classList.add(pct === 0 ? 'grey' : pct > 0 ? 'upgreen' : 'downred')\n    const baseAsset = app().assets[mkt.baseid]\n    if (baseAsset) {\n      Doc.show(tmpl.bottomRow)\n      tmpl.assetName.textContent = baseAsset.info.name\n      tmpl.price.textContent = Doc.formatCoinValue(spot.rate / this.rateConversionFactor)\n    }\n  }\n}\n\n/*\n * BalanceWidget is a display of balance information. Because the wallet can be\n * in any number of states, and because every exchange has different funding\n * coin confirmation requirements, the BalanceWidget displays a number of state\n * indicators and buttons, as well as tabulated balance data with rows for\n * locked and immature balance.\n */\nclass BalanceWidget {\n  base: BalanceWidgetElement\n  quote: BalanceWidgetElement\n  dex: Exchange\n\n  constructor (table: HTMLElement) {\n    const els = Doc.idDescendants(table)\n    this.base = {\n      id: 0,\n      cfg: null,\n      logo: els.baseImg,\n      avail: els.baseAvail,\n      newWalletRow: els.baseNewWalletRow,\n      newWalletBttn: els.baseNewButton,\n      locked: els.baseLocked,\n      immature: els.baseImmature,\n      unsupported: els.baseUnsupported,\n      expired: els.baseExpired,\n      connect: els.baseConnect,\n      spinner: els.baseSpinner,\n      iconBox: els.baseWalletState,\n      stateIcons: new WalletIcons(els.baseWalletState)\n    }\n    this.quote = {\n      id: 0,\n      cfg: null,\n      logo: els.quoteImg,\n      avail: els.quoteAvail,\n      newWalletRow: els.quoteNewWalletRow,\n      newWalletBttn: els.quoteNewButton,\n      locked: els.quoteLocked,\n      immature: els.quoteImmature,\n      unsupported: els.quoteUnsupported,\n      expired: els.quoteExpired,\n      connect: els.quoteConnect,\n      spinner: els.quoteSpinner,\n      iconBox: els.quoteWalletState,\n      stateIcons: new WalletIcons(els.quoteWalletState)\n    }\n\n    app().registerNoteFeeder({\n      balance: (note: BalanceNote) => { this.updateAsset(note.assetID) },\n      walletstate: (note: WalletStateNote) => { this.updateAsset(note.wallet.assetID) }\n    })\n  }\n\n  /*\n   * setWallet sets the balance widget to display data for specified market.\n   */\n  setWallets (host: string, baseID: number, quoteID: number) {\n    this.dex = app().user.exchanges[host]\n    this.base.id = baseID\n    this.base.cfg = this.dex.assets[baseID]\n    this.quote.id = quoteID\n    this.quote.cfg = this.dex.assets[quoteID]\n    this.updateWallet(this.base)\n    this.updateWallet(this.quote)\n  }\n\n  /*\n   * updateWallet updates the displayed wallet information based on the\n   * core.Wallet state.\n   */\n  updateWallet (side: BalanceWidgetElement) {\n    if (!side.cfg) return // no wallet set yet\n    const asset = app().assets[side.id]\n    // Just hide everything to start.\n    Doc.hide(\n      side.newWalletRow, side.avail, side.immature, side.locked,\n      side.expired, side.unsupported, side.connect, side.spinner, side.iconBox\n    )\n    side.logo.src = Doc.logoPath(side.cfg.symbol)\n    // Handle an unsupported asset.\n    if (!asset) {\n      Doc.show(side.unsupported)\n      return\n    }\n    Doc.show(side.iconBox)\n    const wallet = asset.wallet\n    side.stateIcons.readWallet(wallet)\n    // Handle no wallet configured.\n    if (!wallet) {\n      Doc.show(side.newWalletRow)\n      return\n    }\n    const bal = wallet.balance\n    // Handle not connected and no balance known for the DEX.\n    if (!bal && !wallet.running) {\n      Doc.show(side.connect)\n      return\n    }\n    // If there is no balance, but the wallet is connected, show the loading\n    // icon while we fetch an update.\n    if (!bal) {\n      app().fetchBalance(side.id)\n      Doc.show(side.spinner)\n      return\n    }\n    // We have a wallet and a DEX-specific balance. Set all of the fields.\n    Doc.show(side.avail, side.immature, side.locked)\n    side.avail.textContent = Doc.formatCoinValue(bal.available, asset.info.unitinfo)\n    side.locked.textContent = Doc.formatCoinValue((bal.locked + bal.contractlocked), asset.info.unitinfo)\n    side.immature.textContent = Doc.formatCoinValue(bal.immature, asset.info.unitinfo)\n    // If the current balance update time is older than an hour, show the\n    // expiration icon. Request a balance update, if possible.\n    const expired = new Date().getTime() - new Date(bal.stamp).getTime() > anHour\n    if (expired) {\n      Doc.show(side.expired)\n      if (wallet.running) app().fetchBalance(side.id)\n    } else Doc.hide(side.expired)\n  }\n\n  /*\n   * updateAsset updates the info for one side of the existing market. If the\n   * specified asset ID is not one of the current market's base or quote assets,\n   * it is silently ignored.\n   */\n  updateAsset (assetID: number) {\n    if (assetID === this.base.id) this.updateWallet(this.base)\n    else if (assetID === this.quote.id) this.updateWallet(this.quote)\n  }\n}\n\n/* makeMarket creates a market object that specifies basic market details. */\nfunction makeMarket (host: string, base?: number, quote?: number) {\n  return {\n    host: host,\n    base: base,\n    quote: quote\n  }\n}\n\n/* marketID creates a DEX-compatible market name from the ticker symbols. */\nexport function marketID (b: string, q: string) { return `${b}_${q}` }\n\n/* convertToAtoms converts the float string to the basic unit of a coin. */\nfunction convertToAtoms (s: string, conversionFactor: number) {\n  if (!s) return 0\n  return Math.round(parseFloat(s) * conversionFactor)\n}\n\n/* swapBttns changes the 'selected' class of the buttons. */\nfunction swapBttns (before: HTMLElement, now: HTMLElement) {\n  before.classList.remove('selected')\n  now.classList.add('selected')\n}\n\n/*\n * updateDataCol sets the textContent of descendent template element.\n */\nfunction updateDataCol (tr: HTMLElement, col: string, s: string) {\n  Doc.tmplElement(tr, col).textContent = s\n}\n\n/*\n * wireOrder prepares a copy of the order with the options field converted to a\n * string -> string map.\n */\nfunction wireOrder (order: TradeForm) {\n  const stringyOptions: Record<string, string> = {}\n  for (const [k, v] of Object.entries(order.options)) stringyOptions[k] = JSON.stringify(v)\n  return Object.assign({}, order, { options: stringyOptions })\n}\n\n// OrderTableRowManager manages the data within a row in an order table. Each row\n// represents all the orders in the order book with the same rate, but orders that\n// are booked or still in the epoch queue are displayed in separate rows.\nclass OrderTableRowManager {\n  tableRow: HTMLElement\n  orderBin: MiniOrder[]\n  sell: boolean\n  msgRate: number\n  epoch: boolean\n  baseUnitInfo: UnitInfo\n  rateConversionFactor: number\n\n  constructor (tableRow: HTMLElement, orderBin: MiniOrder[], baseUnitInfo: UnitInfo, rateConversionFactor: number) {\n    this.tableRow = tableRow\n    this.orderBin = orderBin\n    this.sell = orderBin[0].sell\n    this.msgRate = orderBin[0].msgRate\n    this.epoch = !!orderBin[0].epoch\n    this.baseUnitInfo = baseUnitInfo\n    this.rateConversionFactor = rateConversionFactor\n    this.setRateEl()\n    this.setEpochEl()\n    this.updateQtyNumOrdersEl()\n  }\n\n  // setEpochEl displays a checkmark in the row if the orders represented by\n  // this row are in the epoch queue.\n  setEpochEl () {\n    const epochEl = Doc.tmplElement(this.tableRow, 'epoch')\n    if (this.isEpoch()) epochEl.appendChild(check.cloneNode())\n  }\n\n  // setRateEl popuplates the rate element in the row.\n  setRateEl () {\n    const rateEl = Doc.tmplElement(this.tableRow, 'rate')\n    if (this.msgRate === 0) {\n      rateEl.innerText = 'market'\n    } else {\n      const cssClass = this.isSell() ? 'sellcolor' : 'buycolor'\n      rateEl.innerText = Doc.formatFullPrecision(this.msgRate / this.rateConversionFactor)\n      rateEl.classList.add(cssClass)\n    }\n  }\n\n  // updateQtyNumOrdersEl populates the quantity element in the row, and also\n  // displays the number of orders if there is more than one order in the order\n  // bin.\n  updateQtyNumOrdersEl () {\n    const qty = this.orderBin.reduce((total, curr) => total + curr.qtyAtomic, 0)\n    const numOrders = this.orderBin.length\n    const qtyEl = Doc.tmplElement(this.tableRow, 'qty')\n    const numOrdersEl = Doc.tmplElement(this.tableRow, 'numorders')\n    qtyEl.innerText = Doc.formatFullPrecision(qty, this.baseUnitInfo)\n    if (numOrders > 1) {\n      numOrdersEl.removeAttribute('hidden')\n      numOrdersEl.innerText = String(numOrders)\n      numOrdersEl.title = `quantity is comprised of ${numOrders} orders`\n    } else {\n      numOrdersEl.setAttribute('hidden', 'true')\n    }\n  }\n\n  // insertOrder adds an order to the order bin and updates the row elements\n  // accordingly.\n  insertOrder (order: MiniOrder) {\n    this.orderBin.push(order)\n    this.updateQtyNumOrdersEl()\n  }\n\n  // updateOrderQuantity updates the quantity of the order identified by a token,\n  // if it exists in the row, and updates the row elements accordingly. The function\n  // returns true if the order is in the bin, and false otherwise.\n  updateOrderQty (update: RemainderUpdate) {\n    const { token, qty, qtyAtomic } = update\n    for (let i = 0; i < this.orderBin.length; i++) {\n      if (this.orderBin[i].token === token) {\n        this.orderBin[i].qty = qty\n        this.orderBin[i].qtyAtomic = qtyAtomic\n        this.updateQtyNumOrdersEl()\n        return true\n      }\n    }\n    return false\n  }\n\n  // removeOrder removes the order identified by the token, if it exists in the row,\n  // and updates the row elements accordingly. If the order bin is empty, the row is\n  // removed from the screen. The function returns true if an order was removed, and\n  // false otherwise.\n  removeOrder (token: string) {\n    const index = this.orderBin.findIndex(order => order.token === token)\n    if (index < 0) return false\n    this.orderBin.splice(index, 1)\n    if (!this.orderBin.length) this.tableRow.remove()\n    else this.updateQtyNumOrdersEl()\n    return true\n  }\n\n  // removeEpochOrders removes all the orders from the row that are not in the\n  // new epoch's epoch queue and updates the elements accordingly.\n  removeEpochOrders (newEpoch?: number) {\n    this.orderBin = this.orderBin.filter((order) => {\n      return !(order.epoch && order.epoch !== newEpoch)\n    })\n    if (!this.orderBin.length) this.tableRow.remove()\n    else this.updateQtyNumOrdersEl()\n  }\n\n  // getRate returns the rate of the orders in the row.\n  getRate () {\n    return this.msgRate\n  }\n\n  // isEpoch returns whether the orders in this row are in the epoch queue.\n  isEpoch () {\n    return this.epoch\n  }\n\n  // isSell returns whether the orders in this row are sell orders.\n  isSell () {\n    return this.sell\n  }\n\n  // compare takes an order and returns 0 if the order belongs in this row,\n  // 1 if the order should go after this row in the table, and -1 if it should\n  // be before this row in the table. Sell orders are displayed in ascending order,\n  // buy orders are displayed in descending order, and epoch orders always come\n  // after booked orders.\n  compare (order: MiniOrder) {\n    if (this.getRate() === order.msgRate && this.isEpoch() === !!order.epoch) {\n      return 0\n    } else if (this.getRate() !== order.msgRate) {\n      return (this.getRate() > order.msgRate) === order.sell ? 1 : -1\n    } else {\n      return this.isEpoch() ? 1 : -1\n    }\n  }\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport * as OrderUtil from './orderutil'\nimport { postJSON } from './http'\nimport {\n  app,\n  PageElement,\n  OrderFilter,\n  Order\n} from './registry'\n\nconst orderBatchSize = 50\n\nexport default class OrdersPage extends BasePage {\n  main: HTMLElement\n  offset: string\n  loading: boolean\n  orderTmpl: PageElement\n  filterState: OrderFilter\n  page: Record<string, PageElement>\n\n  constructor (main: HTMLElement) {\n    super()\n    this.main = main\n    // if offset is '', there are no more orders available to auto-load for\n    // never-ending scrolling.\n    this.offset = ''\n    this.loading = false\n    const page = this.page = Doc.idDescendants(main)\n    this.orderTmpl = page.rowTmpl\n    this.orderTmpl.remove()\n\n    // filterState will store arrays of strings. The assets and statuses\n    // sub-filters will need to be converted to ints for JSON encoding.\n    const filterState: OrderFilter = this.filterState = {\n      hosts: [],\n      assets: [],\n      statuses: []\n    }\n\n    const search = new URLSearchParams(window.location.search)\n    const readFilter = (form: HTMLElement, filterKey: string) => {\n      const v = search.get(filterKey)\n      if (!v || v.length === 0) return\n      const subFilter = v.split(',')\n      if (v) {\n        (filterState as any)[filterKey] = subFilter // Kinda janky\n      }\n      form.querySelectorAll('input').forEach(bttn => {\n        if (subFilter.indexOf(bttn.value) >= 0) bttn.checked = true\n      })\n    }\n    readFilter(page.hostFilter, 'hosts')\n    readFilter(page.assetFilter, 'assets')\n    readFilter(page.statusFilter, 'statuses')\n\n    const applyButtons: HTMLElement[] = []\n    const monitorFilter = (form: HTMLElement, filterKey: string) => {\n      const applyBttn = form.querySelector('.apply-bttn') as HTMLElement\n      applyButtons.push(applyBttn)\n      Doc.bind(applyBttn, 'click', () => {\n        this.submitFilter()\n        applyButtons.forEach(bttn => Doc.hide(bttn))\n      })\n      form.querySelectorAll('input').forEach(bttn => {\n        Doc.bind(bttn, 'change', () => {\n          const subFilter = parseSubFilter(form)\n          if (compareSubFilter(subFilter, (filterState as any)[filterKey])) {\n            // Same as currently loaded. Hide the apply button.\n            Doc.hide(applyBttn)\n          } else {\n            Doc.show(applyBttn)\n          }\n        })\n      })\n    }\n\n    monitorFilter(page.hostFilter, 'hosts')\n    monitorFilter(page.assetFilter, 'assets')\n    monitorFilter(page.statusFilter, 'statuses')\n\n    Doc.bind(this.main, 'scroll', () => {\n      if (this.loading) return\n      const belowBottom = page.ordersTable.offsetHeight - this.main.offsetHeight - this.main.scrollTop\n      if (belowBottom < 0) {\n        this.nextPage()\n      }\n    })\n\n    Doc.bind(page.exportOrders, 'click', () => {\n      this.exportOrders()\n    })\n\n    this.submitFilter()\n  }\n\n  /* setOrders empties the order table and appends the specified orders. */\n  setOrders (orders: Order[]) {\n    Doc.empty(this.page.tableBody)\n    this.appendOrders(orders)\n  }\n\n  /* appendOrders appends orders to the orders table. */\n  appendOrders (orders: Order[]) {\n    const tbody = this.page.tableBody\n    for (const ord of orders) {\n      const tr = this.orderTmpl.cloneNode(true) as HTMLElement\n      const set = (tmplID: string, s: string) => { Doc.tmplElement(tr, tmplID).textContent = s }\n      const mktID = `${ord.baseSymbol.toUpperCase()}-${ord.quoteSymbol.toUpperCase()}`\n      set('host', `${mktID} @ ${ord.host}`)\n      let from, to, fromQty\n      let toQty = ''\n      const [baseUnitInfo, quoteUnitInfo] = [app().unitInfo(ord.baseID), app().unitInfo(ord.quoteID)]\n      if (ord.sell) {\n        [from, to] = [ord.baseSymbol, ord.quoteSymbol]\n        fromQty = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        if (ord.type === OrderUtil.Limit) {\n          toQty = Doc.formatCoinValue(ord.qty / OrderUtil.RateEncodingFactor * ord.rate, quoteUnitInfo)\n        }\n      } else {\n        [from, to] = [ord.quoteSymbol, ord.baseSymbol]\n        if (ord.type === OrderUtil.Market) {\n          fromQty = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        } else {\n          fromQty = Doc.formatCoinValue(ord.qty / OrderUtil.RateEncodingFactor * ord.rate, quoteUnitInfo)\n          toQty = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        }\n      }\n\n      set('fromQty', fromQty)\n      Doc.tmplElement(tr, 'fromLogo').src = Doc.logoPath(from)\n      set('fromSymbol', from)\n      set('toQty', toQty)\n      Doc.tmplElement(tr, 'toLogo').src = Doc.logoPath(to)\n      set('toSymbol', to)\n      set('type', `${OrderUtil.typeString(ord)} ${OrderUtil.sellString(ord)}`)\n      set('rate', Doc.formatCoinValue(app().conventionalRate(ord.baseID, ord.quoteID, ord.rate)))\n      set('status', OrderUtil.statusString(ord))\n      set('filled', `${(OrderUtil.filled(ord) / ord.qty * 100).toFixed(1)}%`)\n      set('settled', `${(OrderUtil.settled(ord) / ord.qty * 100).toFixed(1)}%`)\n      const dateTime = new Date(ord.submitTime).toLocaleString()\n      set('time', `${Doc.timeSince(ord.submitTime)} ago, ${dateTime}`)\n      const link = Doc.tmplElement(tr, 'link')\n      link.href = `order/${ord.id}`\n      app().bindInternalNavigation(tr)\n      tbody.appendChild(tr)\n    }\n    if (orders.length === orderBatchSize) {\n      this.offset = orders[orders.length - 1].id\n    } else {\n      this.offset = ''\n    }\n  }\n\n  /* submitFilter submits the current filter and reloads the order table. */\n  async submitFilter () {\n    const page = this.page\n    this.offset = ''\n    const filterState = this.filterState\n    filterState.hosts = parseSubFilter(page.hostFilter)\n    filterState.assets = parseSubFilter(page.assetFilter).map((s: string) => parseInt(s))\n    filterState.statuses = parseSubFilter(page.statusFilter).map((s: string) => parseInt(s))\n    this.setOrders(await this.fetchOrders())\n  }\n\n  /* fetchOrders fetches orders using the current filter. */\n  async fetchOrders () {\n    const loaded = app().loading(this.main)\n    const res = await postJSON('/api/orders', this.currentFilter())\n    loaded()\n    return res.orders\n  }\n\n  /* exportOrders downloads a csv of the user's orders based on the current filter. */\n  exportOrders () {\n    this.offset = ''\n    const filterState = this.currentFilter()\n    const url = new URL(window.location.href)\n    const search = new URLSearchParams('')\n    const setQuery = (k: string) => {\n      const subFilter = (filterState as any)[k]\n      subFilter.forEach((v: any) => {\n        search.append(k, v)\n      })\n    }\n    setQuery('hosts')\n    setQuery('assets')\n    setQuery('statuses')\n    url.search = search.toString()\n    url.pathname = '/orders/export'\n    window.open(url.toString())\n  }\n\n  /*\n   * currentFilter converts the local filter type (which is all strings) to the\n   * server's filter type.\n   */\n  currentFilter (): OrderFilter {\n    const filterState = this.filterState\n    return {\n      hosts: filterState.hosts,\n      assets: filterState.assets.map((s: any) => parseInt(s)),\n      statuses: filterState.statuses.map((s: any) => parseInt(s)),\n      n: orderBatchSize,\n      offset: this.offset\n    }\n  }\n\n  /*\n   * nextPage resubmits the filter with the offset set to the last loaded order.\n   */\n  async nextPage () {\n    if (this.offset === '' || this.loading) return\n    this.loading = true\n    Doc.show(this.page.orderLoader)\n    const orders = await this.fetchOrders()\n    this.loading = false\n    Doc.hide(this.page.orderLoader)\n    this.appendOrders(orders)\n  }\n}\n\n/*\n * parseSubFilter parses a bool-map from the checkbox inputs in the specified\n * ancestor element.\n */\nfunction parseSubFilter (form: HTMLElement): string[] {\n  const entries: string[] = []\n  form.querySelectorAll('input').forEach(box => {\n    if (box.checked) entries.push(box.value)\n  })\n  return entries\n}\n\n/* compareSubFilter compares the two filter arrays for unordered equivalence. */\nfunction compareSubFilter (filter1: any[], filter2: any[]): boolean {\n  if (filter1.length !== filter2.length) return false\n  for (const entry of filter1) {\n    if (filter2.indexOf(entry) === -1) return false\n  }\n  return true\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport * as OrderUtil from './orderutil'\nimport { bind as bindForm, AccelerateOrderForm } from './forms'\nimport { postJSON } from './http'\nimport * as intl from './locales'\nimport {\n  app,\n  Order,\n  PageElement,\n  OrderNote,\n  MatchNote,\n  Match,\n  Coin\n} from './registry'\n\nconst Mainnet = 0\nconst Testnet = 1\n// const Regtest = 3\n\nconst animationLength = 500\n\nlet net: number\n\nexport default class OrderPage extends BasePage {\n  orderID: string\n  order: Order\n  page: Record<string, PageElement>\n  currentForm: HTMLElement\n  secondTicker: number\n  refreshOnPopupClose: boolean\n  accelerateOrderForm: AccelerateOrderForm\n\n  constructor (main: HTMLElement) {\n    super()\n    const stampers = Doc.applySelector(main, '[data-stamp]')\n    net = parseInt(main.dataset.net || '')\n    // Find the order\n    this.orderID = main.dataset.oid || ''\n    const ord = app().order(this.orderID)\n    // app().order can only access active orders. If the order is not active,\n    // we'll need to get the data from the database.\n    if (ord) this.order = ord\n    else this.fetchOrder()\n\n    const page = this.page = Doc.idDescendants(main)\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => {\n        if (this.refreshOnPopupClose) {\n          window.location.replace(window.location.href)\n          return\n        }\n        Doc.hide(page.forms)\n      })\n    })\n\n    if (page.cancelBttn) {\n      Doc.bind(page.cancelBttn, 'click', () => {\n        this.showForm(page.cancelForm)\n      })\n    }\n\n    Doc.bind(page.accelerateBttn, 'click', () => {\n      this.showAccelerateForm()\n    })\n\n    this.showAccelerationButton()\n    const success = () => {\n      this.refreshOnPopupClose = true\n    }\n    // Do not call cleanTemplates before creating the AccelerateOrderForm\n    OrderUtil.setOptionTemplates(page)\n    this.accelerateOrderForm = new AccelerateOrderForm(page.accelerateForm, success)\n    Doc.cleanTemplates(page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl)\n\n    // If the user clicks outside of a form, it should close the page overlay.\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) {\n        if (this.refreshOnPopupClose) {\n          window.location.reload()\n          return\n        }\n        Doc.hide(page.forms)\n        page.cancelPass.value = ''\n      }\n    })\n\n    // Cancel order form\n    bindForm(page.cancelForm, page.cancelSubmit, async () => { this.submitCancel() })\n\n    main.querySelectorAll('[data-explorer-id]').forEach((link: PageElement) => {\n      setCoinHref(link)\n    })\n\n    const setStamp = () => {\n      for (const span of stampers) {\n        span.textContent = Doc.timeSince(parseInt(span.dataset.stamp || ''))\n      }\n    }\n    setStamp()\n\n    this.secondTicker = window.setInterval(() => {\n      setStamp()\n    }, 10000) // update every 10 seconds\n\n    app().registerNoteFeeder({\n      order: (note: OrderNote) => { this.handleOrderNote(note) },\n      match: (note: MatchNote) => { this.handleMatchNote(note) }\n    })\n  }\n\n  unload () {\n    clearInterval(this.secondTicker)\n  }\n\n  /* fetchOrder fetches the order from the client. */\n  async fetchOrder () {\n    const res = await postJSON('/api/order', this.orderID)\n    if (!app().checkResponse(res)) return\n    this.order = res.order\n  }\n\n  /* showCancel shows a form to confirm submission of a cancel order. */\n  showCancel () {\n    const order = this.order\n    const page = this.page\n    const remaining = order.qty - order.filled\n    const asset = OrderUtil.isMarketBuy(order) ? app().assets[order.quoteID] : app().assets[order.baseID]\n    page.cancelRemain.textContent = Doc.formatCoinValue(remaining, asset.info.unitinfo)\n    page.cancelUnit.textContent = asset.info.unitinfo.conventional.unit.toUpperCase()\n    this.showForm(page.cancelForm)\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    this.currentForm = form\n    const page = this.page\n    Doc.hide(page.cancelForm, page.accelerateForm)\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0px'\n  }\n\n  /* submitCancel submits a cancellation for the order. */\n  async submitCancel () {\n    // this will be the page.cancelSubmit button (evt.currentTarget)\n    const page = this.page\n    const order = this.order\n    const req = {\n      orderID: order.id,\n      pw: page.cancelPass.value\n    }\n    page.cancelPass.value = ''\n    const loaded = app().loading(page.cancelForm)\n    const res = await postJSON('/api/cancel', req)\n    loaded()\n    if (!app().checkResponse(res)) return\n    page.status.textContent = intl.prep(intl.ID_CANCELING)\n    Doc.hide(page.forms)\n    order.cancelling = true\n  }\n\n  /*\n   * showAccelerationButton shows the acceleration button if the order can\n   * be accelerated.\n   */\n  showAccelerationButton () {\n    const order = this.order\n    if (!order) return\n    const page = this.page\n    if (app().canAccelerateOrder(order)) Doc.show(page.accelerateBttn, page.actionsLabel)\n    else Doc.hide(page.accelerateBttn, page.actionsLabel)\n  }\n\n  /* showAccelerateForm shows a form to accelerate an order */\n  async showAccelerateForm () {\n    const loaded = app().loading(this.page.accelerateBttn)\n    this.accelerateOrderForm.refresh(this.order)\n    loaded()\n    this.showForm(this.page.accelerateForm)\n  }\n\n  /*\n   * handleOrderNote is the handler for the 'order'-type notification, which are\n   * used to update an order's status.\n   */\n  handleOrderNote (note: OrderNote) {\n    const page = this.page\n    const order = note.order\n    if (order.id !== this.orderID) return\n    this.order = order\n    const bttn = page.cancelBttn\n    if (bttn && order.status > OrderUtil.StatusBooked) Doc.hide(bttn)\n    page.status.textContent = OrderUtil.statusString(order)\n    for (const m of order.matches || []) this.processMatch(m)\n    this.showAccelerationButton()\n  }\n\n  /* handleMatchNote handles a 'match' notification. */\n  handleMatchNote (note: MatchNote) {\n    if (note.orderID !== this.orderID) return\n    this.processMatch(note.match)\n  }\n\n  /*\n   * processMatch synchronizes a match's card with a match received in a\n   * 'order' or 'match' notification.\n   */\n  processMatch (m: Match) {\n    let card: HTMLElement | null = null\n    for (const div of Doc.applySelector(this.page.matchBox, '.match-card')) {\n      if (div.dataset.matchID === m.matchID) {\n        card = div\n        break\n      }\n    }\n    if (!card) {\n      // TO DO: Create a new card from template.\n      return\n    }\n\n    const setCoin = (divName: string, linkName: string, coin: Coin) => {\n      if (!card) return // Ugh\n      if (!coin) return\n      Doc.show(Doc.tmplElement(card, divName))\n      const coinLink = Doc.tmplElement(card, linkName)\n      coinLink.textContent = coin.stringID\n      coinLink.dataset.explorerCoin = coin.stringID\n      setCoinHref(coinLink)\n    }\n\n    setCoin('swap', 'swapCoin', m.swap)\n    setCoin('counterSwap', 'counterSwapCoin', m.counterSwap)\n    setCoin('redeem', 'redeemCoin', m.redeem)\n    setCoin('counterRedeem', 'counterRedeemCoin', m.counterRedeem)\n    setCoin('refund', 'refundCoin', m.refund)\n\n    const swapSpan = Doc.tmplElement(card, 'swapMsg')\n    const cSwapSpan = Doc.tmplElement(card, 'counterSwapMsg')\n\n    if (inCounterSwapCast(m)) {\n      cSwapSpan.textContent = confirmationString(m.counterSwap)\n      Doc.hide(Doc.tmplElement(card, 'swapMsg'))\n      Doc.show(cSwapSpan)\n    } else if (inSwapCast(m)) {\n      swapSpan.textContent = confirmationString(m.swap)\n      Doc.hide(Doc.tmplElement(card, 'counterSwapMsg'))\n      Doc.show(swapSpan)\n    } else {\n      Doc.hide(swapSpan, cSwapSpan)\n    }\n\n    Doc.tmplElement(card, 'status').textContent = OrderUtil.matchStatusString(m)\n  }\n}\n\n/*\n * confirmationString is a string describing the state of confirmations for a\n * coin\n * */\nfunction confirmationString (coin: Coin) {\n  if (!coin.confs) return ''\n  return `${coin.confs.count} / ${coin.confs.required} confirmations`\n}\n\n/*\n * inCounterSwapCast will be true if we are waiting on confirmations for the\n * counterparty's swap.\n */\nfunction inCounterSwapCast (m: Match) {\n  return (m.side === OrderUtil.Taker && m.status === OrderUtil.MakerSwapCast) || (m.side === OrderUtil.Maker && m.status === OrderUtil.TakerSwapCast)\n}\n\n/*\n * inCounterSwapCast will be true if we are waiting on confirmations for our own\n * swap.\n */\nfunction inSwapCast (m: Match) {\n  return (m.side === OrderUtil.Maker && m.status === OrderUtil.MakerSwapCast) || (m.side === OrderUtil.Taker && m.status === OrderUtil.TakerSwapCast)\n}\n\n/*\n * setCoinHref sets the hyperlink element's href attribute based on its\n * data-explorer-id and data-explorer-coin values.\n */\nfunction setCoinHref (link: PageElement) {\n  const assetExplorer = CoinExplorers[parseInt(link.dataset.explorerId || '')]\n  if (!assetExplorer) return\n  const formatter = assetExplorer[net]\n  if (!formatter) return\n  link.classList.remove('plainlink')\n  link.classList.add('subtlelink')\n  link.href = formatter(link.dataset.explorerCoin || '')\n}\n\nconst CoinExplorers: Record<number, Record<number, (cid: string) => string>> = {\n  42: { // dcr\n    [Mainnet]: (cid: string) => {\n      const [txid, vout] = cid.split(':')\n      return `https://explorer.dcrdata.org/tx/${txid}/out/${vout}`\n    },\n    [Testnet]: (cid: string) => {\n      const [txid, vout] = cid.split(':')\n      return `https://testnet.dcrdata.org/tx/${txid}/out/${vout}`\n    }\n  },\n  0: { // btc\n    [Mainnet]: (cid: string) => `https://mempool.space/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://mempool.space/testnet/tx/${cid.split(':')[0]}`\n  },\n  2: { // ltc\n    [Mainnet]: (cid: string) => `https://ltc.bitaps.com/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://sochain.com/tx/LTCTEST/${cid.split(':')[0]}`\n  },\n  60: { // eth\n    [Mainnet]: (cid: string) => {\n      if (cid.length === 42) {\n        return `https://etherscan.io/address/${cid}`\n      }\n      return `https://etherscan.io/tx/${cid}`\n    },\n    [Testnet]: (cid: string) => {\n      if (cid.length === 42) {\n        return `https://goerli.etherscan.io/address/${cid}`\n      }\n      return `https://goerli.etherscan.io/tx/${cid}`\n    }\n  },\n  3: { // doge\n    [Mainnet]: (cid: string) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://blockexplorer.one/dogecoin/testnet/tx/${cid.split(':')[0]}`\n  },\n  145: { // bch\n    [Mainnet]: (cid: string) => `https://bch.loping.net/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://tbch4.loping.net/tx/${cid.split(':')[0]}`\n  }\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport State from './state'\nimport { postJSON } from './http'\nimport * as forms from './forms'\n\nimport {\n  app,\n  PageElement,\n  ConnectionStatus,\n  Exchange\n} from './registry'\n\nconst animationLength = 300\n\nexport default class DexSettingsPage extends BasePage {\n  body: HTMLElement\n  forms: PageElement[]\n  currentForm: PageElement\n  page: Record<string, PageElement>\n  host: string\n  keyup: (e: KeyboardEvent) => void\n  dexAddrForm: forms.DEXAddressForm\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    this.host = body.dataset.host ? body.dataset.host : ''\n    const page = this.page = Doc.idDescendants(body)\n    this.forms = Doc.applySelector(page.forms, ':scope > form')\n\n    Doc.bind(page.exportDexBtn, 'click', () => this.prepareAccountExport(page.authorizeAccountExportForm))\n    Doc.bind(page.disableAcctBtn, 'click', () => this.prepareAccountDisable(page.disableAccountForm))\n    Doc.bind(page.updateCertBtn, 'click', () => page.certFileInput.click())\n    Doc.bind(page.updateHostBtn, 'click', () => this.prepareUpdateHost())\n    Doc.bind(page.certFileInput, 'change', () => this.onCertFileChange())\n\n    this.dexAddrForm = new forms.DEXAddressForm(page.dexAddrForm, async (xc: Exchange) => {\n      window.location.assign(`/dexsettings/${xc.host}`)\n    }, undefined, this.host)\n\n    forms.bind(page.authorizeAccountExportForm, page.authorizeExportAccountConfirm, () => this.exportAccount())\n    forms.bind(page.disableAccountForm, page.disableAccountConfirm, () => this.disableAccount())\n\n    const closePopups = () => {\n      Doc.hide(page.forms)\n    }\n\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) { closePopups() }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        closePopups()\n      }\n    }\n    Doc.bind(document, 'keyup', this.keyup)\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { closePopups() })\n    })\n\n    app().registerNoteFeeder({\n      conn: () => { this.setConnectionStatus() }\n    })\n\n    this.setConnectionStatus()\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    const page = this.page\n    this.currentForm = form\n    this.forms.forEach(form => Doc.hide(form))\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  // exportAccount exports and downloads the account info.\n  async exportAccount () {\n    const page = this.page\n    const pw = page.exportAccountAppPass.value\n    const host = page.exportAccountHost.textContent\n    page.exportAccountAppPass.value = ''\n    const req = {\n      pw,\n      host\n    }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/exportaccount', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.exportAccountErr.textContent = res.msg\n      Doc.show(page.exportAccountErr)\n      return\n    }\n    const accountForExport = JSON.parse(JSON.stringify(res.account))\n    const a = document.createElement('a')\n    a.setAttribute('download', 'dcrAccount-' + host + '.json')\n    a.setAttribute('href', 'data:text/json,' + JSON.stringify(accountForExport, null, 2))\n    a.click()\n    Doc.hide(page.forms)\n  }\n\n  // disableAccount disables the account associated with the provided host.\n  async disableAccount () {\n    const page = this.page\n    const pw = page.disableAccountAppPW.value\n    const host = page.disableAccountHost.textContent\n    page.disableAccountAppPW.value = ''\n    const req = {\n      pw,\n      host\n    }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/disableaccount', req)\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.disableAccountErr.textContent = res.msg\n      Doc.show(page.disableAccountErr)\n      return\n    }\n    Doc.hide(page.forms)\n    window.location.assign('/settings')\n  }\n\n  async prepareAccountExport (authorizeAccountExportForm: HTMLElement) {\n    const page = this.page\n    page.exportAccountHost.textContent = this.host\n    page.exportAccountErr.textContent = ''\n    if (State.passwordIsCached()) {\n      this.exportAccount()\n    } else {\n      this.showForm(authorizeAccountExportForm)\n    }\n  }\n\n  async prepareAccountDisable (disableAccountForm: HTMLElement) {\n    const page = this.page\n    page.disableAccountHost.textContent = this.host\n    page.disableAccountErr.textContent = ''\n    this.showForm(disableAccountForm)\n  }\n\n  async prepareUpdateHost () {\n    const page = this.page\n    this.dexAddrForm.refresh()\n    this.showForm(page.dexAddrForm)\n  }\n\n  async onCertFileChange () {\n    const page = this.page\n    Doc.hide(page.errMsg)\n    const files = page.certFileInput.files\n    let cert\n    if (files && files.length) cert = await files[0].text()\n    if (!cert) return\n    const req = { host: this.host, cert: cert }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/updatecert', req)\n    loaded()\n    if (!app().checkResponse(res, true)) {\n      page.errMsg.textContent = res.msg\n      Doc.show(page.errMsg)\n    } else {\n      Doc.show(page.updateCertMsg)\n      setTimeout(() => { Doc.hide(page.updateCertMsg) }, 5000)\n    }\n  }\n\n  setConnectionStatus () {\n    const page = this.page\n    const exchange = app().user.exchanges[this.host]\n    const displayIcons = (connected: boolean) => {\n      if (connected) {\n        Doc.hide(page.disconnectedIcon)\n        Doc.show(page.connectedIcon)\n      } else {\n        Doc.show(page.disconnectedIcon)\n        Doc.hide(page.connectedIcon)\n      }\n    }\n    if (exchange) {\n      switch (exchange.connectionStatus) {\n        case ConnectionStatus.Connected:\n          displayIcons(true)\n          page.connectionStatus.textContent = 'Connected'\n          break\n        case ConnectionStatus.Disconnected:\n          displayIcons(false)\n          page.connectionStatus.textContent = 'Disconnected'\n          break\n        case ConnectionStatus.InvalidCert:\n          displayIcons(false)\n          page.connectionStatus.textContent = 'Disconnected - Invalid Certificate'\n      }\n    }\n  }\n}\n","import Doc from './doc'\nimport State from './state'\nimport RegistrationPage from './register'\nimport LoginPage from './login'\nimport WalletsPage from './wallets'\nimport SettingsPage from './settings'\nimport MarketsPage from './markets'\nimport OrdersPage from './orders'\nimport OrderPage from './order'\nimport DexSettingsPage from './dexsettings'\nimport { RateEncodingFactor, StatusExecuted, hasLiveMatches } from './orderutil'\nimport { getJSON, postJSON } from './http'\nimport * as ntfn from './notifications'\nimport ws from './ws'\nimport * as intl from './locales'\nimport {\n  User,\n  SupportedAsset,\n  Exchange,\n  WalletState,\n  FeePaymentNote,\n  CoreNote,\n  OrderNote,\n  Market,\n  Order,\n  Match,\n  BalanceNote,\n  WalletConfigNote,\n  MatchNote,\n  ConnEventNote,\n  SpotPriceNote,\n  UnitInfo,\n  WalletDefinition,\n  WalletBalance,\n  LogMessage,\n  NoteElement,\n  BalanceResponse,\n  APIResponse,\n  RateNote\n} from './registry'\n\nconst idel = Doc.idel // = element by id\nconst bind = Doc.bind\nconst unbind = Doc.unbind\n\nconst notificationRoute = 'notify'\nconst loggersKey = 'loggers'\nconst recordersKey = 'recorders'\nconst noteCacheSize = 100\n\ninterface Page {\n  unload (): void\n}\n\ninterface PageClass {\n  new (main: HTMLElement, data: any): Page;\n}\n\ninterface CoreNotePlus extends CoreNote {\n  el: HTMLElement // Added in app\n}\n\n/* constructors is a map to page constructors. */\nconst constructors: Record<string, PageClass> = {\n  login: LoginPage,\n  register: RegistrationPage,\n  markets: MarketsPage,\n  wallets: WalletsPage,\n  settings: SettingsPage,\n  orders: OrdersPage,\n  order: OrderPage,\n  dexsettings: DexSettingsPage\n}\n\n// unathedPages are pages that don't require authorization to load.\n// These are endpoints outside of the requireLogin block in webserver.New.\nconst unauthedPages = ['register', 'login', 'settings']\n\n// Application is the main javascript web application for the Decred DEX client.\nexport default class Application {\n  notes: CoreNotePlus[]\n  pokes: CoreNotePlus[]\n  user: User\n  seedGenTime: number\n  commitHash: string\n  showPopups: boolean\n  loggers: Record<string, boolean>\n  recorders: Record<string, LogMessage[]>\n  main: HTMLElement\n  header: HTMLElement\n  assets: Record<number, SupportedAsset>\n  exchanges: Record<string, Exchange>\n  walletMap: Record<number, WalletState>\n  fiatRatesMap: Record<number, number>\n  tooltip: HTMLElement\n  page: Record<string, HTMLElement>\n  loadedPage: Page | null\n  popupNotes: HTMLElement\n  popupTmpl: HTMLElement\n  noteReceivers: Record<string, (n: CoreNote) => void>[]\n\n  constructor () {\n    this.notes = []\n    this.pokes = []\n    // The \"user\" is a large data structure that contains nearly all state\n    // information, including exchanges, markets, wallets, orders and exchange\n    // rates for assets.\n    this.user = {\n      exchanges: {},\n      inited: false,\n      seedgentime: 0,\n      assets: {},\n      fiatRates: {},\n      authed: false,\n      ok: true\n    }\n    this.seedGenTime = 0\n    this.commitHash = process.env.COMMITHASH || ''\n    this.noteReceivers = []\n    this.showPopups = State.getCookie('popups') === '1'\n    console.log('Decred DEX Client App, Build', this.commitHash.substring(0, 7))\n\n    // Loggers can be enabled by setting a truthy value to the loggerID using\n    // enableLogger. Settings are stored across sessions. See docstring for the\n    // log method for more info.\n    this.loggers = State.fetch(loggersKey) || {}\n    window.enableLogger = (loggerID, state) => {\n      if (state) this.loggers[loggerID] = true\n      else delete this.loggers[loggerID]\n      State.store(loggersKey, this.loggers)\n      return `${loggerID} logger ${state ? 'enabled' : 'disabled'}`\n    }\n    // Enable logging from anywhere.\n    window.log = (loggerID, ...a) => { this.log(loggerID, ...a) }\n\n    // Recorders can record log messages, and then save them to file on request.\n    const recorderKeys = State.fetch(recordersKey) || []\n    this.recorders = {}\n    for (const loggerID of recorderKeys) {\n      console.log('recording', loggerID)\n      this.recorders[loggerID] = []\n    }\n    window.recordLogger = (loggerID, on) => {\n      if (on) this.recorders[loggerID] = []\n      else delete this.recorders[loggerID]\n      State.store(recordersKey, Object.keys(this.recorders))\n      return `${loggerID} recorder ${on ? 'enabled' : 'disabled'}`\n    }\n    window.dumpLogger = loggerID => {\n      const record = this.recorders[loggerID]\n      if (!record) return `no recorder for logger ${loggerID}`\n      const a = document.createElement('a')\n      a.href = `data:application/octet-stream;base64,${window.btoa(JSON.stringify(record, null, 4))}`\n      a.download = `${loggerID}.json`\n      document.body.appendChild(a)\n      a.click()\n      setTimeout(() => {\n        document.body.removeChild(a)\n      }, 0)\n    }\n\n    // use user current locale set by backend\n    intl.setLocale()\n  }\n\n  /**\n   * Start the application. This is the only thing done from the index.js entry\n   * point. Read the id = main element and attach handlers.\n   */\n  async start () {\n    // Handle back navigation from the browser.\n    bind(window, 'popstate', (e: PopStateEvent) => {\n      const page = e.state.page\n      if (!page && page !== '') return\n      this.loadPage(page, e.state.data, true)\n    })\n    // The main element is the interchangeable part of the page that doesn't\n    // include the header. Main should define a data-handler attribute\n    // associated with  one of the available constructors.\n    this.main = idel(document, 'main')\n    const handler = this.main.dataset.handler\n    // Don't fetch the user until we know what page we're on.\n    await this.fetchUser()\n    // The application is free to respond with a page that differs from the\n    // one requested in the omnibox, e.g. routing though a login page. Set the\n    // current URL state based on the actual page.\n    const url = new URL(window.location.href)\n    if (handlerFromPath(url.pathname) !== handler) {\n      url.pathname = `/${handler}`\n      url.search = ''\n      window.history.replaceState({ page: handler }, '', url)\n    }\n    // Attach stuff.\n    this.attachHeader()\n    this.attachCommon(this.header)\n    this.attach({})\n    // Load recent notifications from Window.localStorage.\n    const notes = State.fetch('notifications')\n    this.setNotes(notes || [])\n    // Connect the websocket and register the notification route.\n    ws.connect(getSocketURI(), this.reconnected)\n    ws.registerRoute(notificationRoute, (note: CoreNote) => {\n      this.notify(note)\n    })\n  }\n\n  /*\n   * reconnected is called by the websocket client when a reconnection is made.\n   */\n  reconnected () {\n    window.location.reload() // This triggers another websocket disconnect/connect (!)\n    // a fetchUser() and loadPage(window.history.state.page) might work\n  }\n\n  /*\n   * Fetch and save the user, which is the primary core state that must be\n   * maintained by the Application.\n   */\n  async fetchUser (): Promise<User | void> {\n    const resp: APIResponse = await getJSON('/api/user')\n    // If it's not a page that requires auth, skip the error notification.\n    const skipNote = unauthedPages.indexOf(this.main.dataset.handler || '') > -1\n    if (!this.checkResponse(resp, skipNote)) return\n    const user = (resp as any) as User\n    this.seedGenTime = user.seedgentime\n    this.user = user\n    this.assets = user.assets\n    this.exchanges = user.exchanges\n    this.walletMap = {}\n    this.fiatRatesMap = user.fiatRates\n    for (const [assetID, asset] of (Object.entries(user.assets) as [any, SupportedAsset][])) {\n      if (asset.wallet) {\n        this.walletMap[assetID] = asset.wallet\n      }\n    }\n\n    this.updateMenuItemsDisplay()\n    return user\n  }\n\n  /* Load the page from the server. Insert and bind the DOM. */\n  async loadPage (page: string, data?: any, skipPush?: boolean): Promise<boolean> {\n    // Close some menus and tooltips.\n    this.tooltip.style.left = '-10000px'\n    Doc.hide(this.page.noteBox, this.page.profileBox)\n    // Parse the request.\n    const url = new URL(`/${page}`, window.location.origin)\n    const requestedHandler = handlerFromPath(page)\n    // Fetch and parse the page.\n    const response = await window.fetch(url.toString())\n    if (!response.ok) return false\n    const html = await response.text()\n    const doc = Doc.noderize(html)\n    const main = idel(doc, 'main')\n    const delivered = main.dataset.handler\n    // Append the request to the page history.\n    if (!skipPush) {\n      const path = delivered === requestedHandler ? url.toString() : `/${delivered}`\n      window.history.pushState({ page: page, data: data }, '', path)\n    }\n    // Insert page and attach handlers.\n    document.title = doc.title\n    this.main.replaceWith(main)\n    this.main = main\n    this.noteReceivers = []\n    this.attach(data)\n    return true\n  }\n\n  /* attach binds the common handlers and calls the page constructor. */\n  attach (data: any) {\n    const handlerID = this.main.dataset.handler\n    if (!handlerID) {\n      console.error('cannot attach to content with no specified handler')\n      return\n    }\n    this.attachCommon(this.main)\n    if (this.loadedPage) this.loadedPage.unload()\n    const constructor = constructors[handlerID]\n    if (constructor) this.loadedPage = new constructor(this.main, data)\n    else this.loadedPage = null\n\n    // Bind the tooltips.\n    this.bindTooltips(this.main)\n  }\n\n  bindTooltips (ancestor: HTMLElement) {\n    ancestor.querySelectorAll('[data-tooltip]').forEach((el: HTMLElement) => {\n      bind(el, 'mouseenter', () => {\n        this.tooltip.textContent = el.dataset.tooltip || ''\n        const lyt = Doc.layoutMetrics(el)\n        let left = lyt.centerX - this.tooltip.offsetWidth / 2\n        if (left < 0) left = 5\n        if (left + this.tooltip.offsetWidth > document.body.offsetWidth) {\n          left = document.body.offsetWidth - this.tooltip.offsetWidth - 5\n        }\n        this.tooltip.style.left = `${left}px`\n        this.tooltip.style.top = `${lyt.bodyTop - this.tooltip.offsetHeight - 5}px`\n      })\n      bind(el, 'mouseleave', () => {\n        this.tooltip.style.left = '-10000px'\n      })\n    })\n  }\n\n  /* attachHeader attaches the header element, which unlike the main element,\n   * isn't replaced during page navigation.\n   */\n  attachHeader () {\n    this.header = idel(document.body, 'header')\n    this.popupNotes = idel(document.body, 'popupNotes')\n    this.popupTmpl = Doc.tmplElement(this.popupNotes, 'note')\n    if (this.popupTmpl) this.popupTmpl.remove()\n    else console.error('popupTmpl element not found')\n    this.tooltip = idel(document.body, 'tooltip')\n    const page = this.page = Doc.idDescendants(this.header)\n    page.noteTmpl.removeAttribute('id')\n    page.noteTmpl.remove()\n    page.pokeTmpl.removeAttribute('id')\n    page.pokeTmpl.remove()\n    page.loader.remove()\n    Doc.show(page.loader)\n\n    bind(page.noteMenuEntry, 'click', async () => {\n      Doc.hide(page.pokeList)\n      Doc.show(page.noteList)\n      this.ackNotes()\n      page.noteCat.classList.add('active')\n      page.pokeCat.classList.remove('active')\n      this.showDropdown(page.noteMenuEntry, page.noteBox)\n      Doc.hide(page.noteIndicator)\n      for (const note of this.notes) {\n        if (note.acked) {\n          note.el.classList.remove('firstview')\n        }\n      }\n      this.setNoteTimes(page.noteList)\n      this.setNoteTimes(page.pokeList)\n      this.storeNotes()\n    })\n\n    bind(page.profileMenuEntry, 'click', () => {\n      this.showDropdown(page.profileMenuEntry, page.profileBox)\n    })\n\n    bind(page.innerNoteIcon, 'click', () => { Doc.hide(page.noteBox) })\n    bind(page.innerProfileIcon, 'click', () => { Doc.hide(page.profileBox) })\n\n    bind(page.profileSignout, 'click', async () => await this.signOut())\n\n    bind(page.pokeCat, 'click', () => {\n      this.setNoteTimes(page.pokeList)\n      page.pokeCat.classList.add('active')\n      page.noteCat.classList.remove('active')\n      Doc.hide(page.noteList)\n      Doc.show(page.pokeList)\n      this.ackNotes()\n    })\n\n    bind(page.noteCat, 'click', () => {\n      this.setNoteTimes(page.noteList)\n      page.noteCat.classList.add('active')\n      page.pokeCat.classList.remove('active')\n      Doc.hide(page.pokeList)\n      Doc.show(page.noteList)\n      this.ackNotes()\n    })\n  }\n\n  /*\n   * showDropdown sets the position and visibility of the specified dropdown\n   * dialog according to the position of its icon button.\n   */\n  showDropdown (icon: HTMLElement, dialog: HTMLElement) {\n    const ico = icon.getBoundingClientRect()\n    Doc.hide(this.page.noteBox, this.page.profileBox)\n    Doc.show(dialog)\n    dialog.style.right = `${window.innerWidth - ico.left - ico.width + 11}px`\n    dialog.style.top = `${ico.top - 9}px`\n\n    const hide = (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, dialog)) {\n        Doc.hide(dialog)\n        unbind(document, 'click', hide)\n        if (dialog === this.page.noteBox && Doc.isDisplayed(this.page.noteList)) {\n          this.ackNotes()\n        }\n      }\n    }\n    bind(document, 'click', hide)\n  }\n\n  ackNotes () {\n    const acks = []\n    for (const note of this.notes) {\n      if (note.acked) {\n        note.el.classList.remove('firstview')\n      } else {\n        note.acked = true\n        if (note.id && note.severity > ntfn.POKE) acks.push(note.id)\n      }\n    }\n    if (acks.length) ws.request('acknotes', acks)\n    Doc.hide(this.page.noteIndicator)\n  }\n\n  setNoteTimes (noteList: HTMLElement) {\n    for (const el of (Array.from(noteList.children) as NoteElement[])) {\n      Doc.safeSelector(el, 'span.note-time').textContent = Doc.timeSince(el.note.stamp)\n    }\n  }\n\n  /*\n   * bindInternalNavigation hijacks navigation by click on any local links that\n   * are descendants of ancestor.\n   */\n  bindInternalNavigation (ancestor: HTMLElement) {\n    const pageURL = new URL(window.location.href)\n    ancestor.querySelectorAll('a').forEach(a => {\n      if (!a.href) return\n      const url = new URL(a.href)\n      if (url.origin === pageURL.origin) {\n        const token = url.pathname.substring(1)\n        const params: Record<string, string> = {}\n        if (url.search) {\n          url.searchParams.forEach((v, k) => {\n            params[k] = v\n          })\n        }\n        Doc.bind(a, 'click', (e: Event) => {\n          e.preventDefault()\n          this.loadPage(token, params)\n        })\n      }\n    })\n  }\n\n  /*\n   * storeNotes stores the list of notifications in Window.localStorage. The\n   * actual stored list is stripped of information not necessary for display.\n   */\n  storeNotes () {\n    State.store('notifications', this.notes.map(n => {\n      return {\n        subject: n.subject,\n        details: n.details,\n        severity: n.severity,\n        stamp: n.stamp,\n        id: n.id,\n        acked: n.acked\n      }\n    }))\n  }\n\n  /*\n   * updateMenuItemsDisplay should be called when the user has signed in or out,\n   * and when the user registers a DEX.\n   */\n  updateMenuItemsDisplay () {\n    const page = this.page\n    if (!page) {\n      // initial page load, header elements not yet attached but menu items\n      // would already be hidden/displayed as appropriate.\n      return\n    }\n    if (!this.user.authed) {\n      Doc.hide(page.noteMenuEntry, page.walletsMenuEntry, page.marketsMenuEntry, page.profileMenuEntry)\n      return\n    }\n    Doc.show(page.noteMenuEntry, page.walletsMenuEntry, page.profileMenuEntry)\n    if (Object.keys(this.user.exchanges).length > 0) {\n      Doc.show(page.marketsMenuEntry)\n    } else {\n      Doc.hide(page.marketsMenuEntry)\n    }\n  }\n\n  /* attachCommon scans the provided node and handles some common bindings. */\n  attachCommon (node: HTMLElement) {\n    this.bindInternalNavigation(node)\n  }\n\n  /*\n   * updateExchangeRegistration updates the information for the exchange\n   * registration payment\n   */\n  updateExchangeRegistration (dexAddr: string, confs: number, assetID: number) {\n    const dex = this.exchanges[dexAddr]\n    const symbol = this.assets[assetID].symbol\n    dex.pendingFee = { confs, assetID, symbol }\n  }\n\n  setDEXPaid (host: string) {\n    // setting the null value in the 'confs' field indicates that the fee\n    // payment was completed\n    this.exchanges[host].pendingFee = null\n  }\n\n  /*\n   * handleFeePaymentNote is the handler for the 'feepayment'-type notification, which\n   * is used to update the dex registration status.\n   */\n  handleFeePaymentNote (note: FeePaymentNote) {\n    switch (note.topic) {\n      case 'RegUpdate':\n        this.updateExchangeRegistration(note.dex, note.confirmations, note.asset)\n        break\n      case 'AccountRegistered':\n        this.setDEXPaid(note.dex)\n        break\n      default:\n        break\n    }\n  }\n\n  /*\n   * setNotes sets the current notification cache and populates the notification\n   * display.\n   */\n  setNotes (notes: CoreNote[]) {\n    this.log('notes', 'setNotes', notes)\n    this.notes = []\n    Doc.empty(this.page.noteList)\n    for (let i = 0; i < notes.length; i++) {\n      this.prependNoteElement(notes[i], true)\n    }\n    this.storeNotes()\n  }\n\n  /*\n   * notify is the top-level handler for notifications received from the client.\n   * Notifications are propagated to the loadedPage.\n   */\n  notify (note: CoreNote) {\n    // Handle type-specific updates.\n    this.log('notes', 'notify', note)\n    switch (note.type) {\n      case 'order': {\n        const order = (note as OrderNote).order\n        const mkt = this.user.exchanges[order.host].markets[order.market]\n        // Updates given order in market's orders list if it finds it.\n        // Returns a bool which indicates if order was found.\n        const updateOrder = (mkt: Market, ord: Order) => {\n          for (const i in mkt.orders || []) {\n            if (mkt.orders[i].id === ord.id) {\n              mkt.orders[i] = ord\n              return true\n            }\n          }\n          return false\n        }\n        // If the notification order already exists we update it.\n        // In case market's orders list is empty or the notification order isn't\n        // part of it we add it manually as this means the order was\n        // just placed.\n        if (!mkt.orders) mkt.orders = [order]\n        else if (!updateOrder(mkt, order)) mkt.orders.push(order)\n        break\n      }\n      case 'balance': {\n        const n: BalanceNote = note as BalanceNote\n        const asset = this.user.assets[n.assetID]\n        // Balance updates can come before the user is fetched after login.\n        if (!asset) break\n        const w = asset.wallet\n        if (w) w.balance = n.balance\n        break\n      }\n      case 'feepayment':\n        this.handleFeePaymentNote(note as FeePaymentNote)\n        break\n      case 'walletstate':\n      case 'walletconfig': {\n        // assets can be null if failed to connect to dex server.\n        if (!this.assets) return\n        const wallet = (note as WalletConfigNote).wallet\n        const asset = this.assets[wallet.assetID]\n        asset.wallet = wallet\n        this.walletMap[wallet.assetID] = wallet\n        const bal = wallet.balance.available\n        const balances = this.main.querySelectorAll(`[data-balance-target=\"${wallet.assetID}\"]`)\n        balances.forEach(el => { el.textContent = Doc.formatFullPrecision(bal, asset.info.unitinfo) })\n        break\n      }\n      case 'match': {\n        const n = note as MatchNote\n        const ord = this.order(n.orderID)\n        if (ord) updateMatch(ord, n.match)\n        break\n      }\n      case 'conn': {\n        const n = note as ConnEventNote\n        const xc = this.user.exchanges[n.host]\n        if (xc) xc.connectionStatus = n.connectionStatus\n        break\n      }\n      case 'spots': {\n        const n = note as SpotPriceNote\n        const xc = this.user.exchanges[n.host]\n        // Spots can come before the user is fetched after login.\n        if (!xc) break\n        for (const [mktName, spot] of Object.entries(n.spots)) xc.markets[mktName].spot = spot\n        break\n      }\n      case 'fiatrateupdate': {\n        this.fiatRatesMap = (note as RateNote).fiatRates\n      }\n    }\n\n    // Inform the page.\n    for (const feeder of this.noteReceivers) {\n      const f = feeder[note.type]\n      if (!f) continue\n      try {\n        f(note)\n      } catch (error) {\n        console.error('note feeder error:', error.message ? error.message : error)\n      }\n    }\n    // Discard data notifications.\n    if (note.severity < ntfn.POKE) return\n    // Poke notifications have their own display.\n    if (this.showPopups) {\n      const span = this.popupTmpl.cloneNode(true) as HTMLElement\n      Doc.tmplElement(span, 'text').textContent = `${note.subject}: ${note.details}`\n      const indicator = Doc.tmplElement(span, 'indicator')\n      if (note.severity === ntfn.POKE) {\n        Doc.hide(indicator)\n      } else setSeverityClass(indicator, note.severity)\n      const pn = this.popupNotes\n      pn.appendChild(span)\n      // These take up screen space. Only show max 5 at a time.\n      while (pn.children.length > 5) pn.removeChild(pn.firstChild as Node)\n      setTimeout(async () => {\n        await Doc.animate(500, (progress: number) => {\n          span.style.opacity = String(1 - progress)\n        })\n        span.remove()\n      }, 6000)\n    }\n    // Success and higher severity go to the bell dropdown.\n    if (note.severity === ntfn.POKE) this.prependPokeElement(note)\n    else this.prependNoteElement(note)\n  }\n\n  /*\n   * registerNoteFeeder registers a feeder for core notifications. The feeder\n   * will be de-registered when a new page is loaded.\n   */\n  registerNoteFeeder (receivers: Record<string, (n: CoreNote) => void>) {\n    this.noteReceivers.push(receivers)\n  }\n\n  /*\n   * log prints to the console if a logger has been enabled. Loggers are created\n   * implicitly by passing a loggerID to log. i.e. you don't create a logger,\n   * you just log to it. Loggers are enabled by invoking a global function,\n   * enableLogger(loggerID, onOffBoolean), from the browser's js console. Your\n   * choices are stored across sessions. Some common and useful loggers are\n   * listed below, but this list is not meant to be comprehensive.\n   *\n   * LoggerID   Description\n   * --------   -----------\n   * notes      Notifications of all levels.\n   * book       Order book feed.\n   * ws.........Websocket connection status changes.\n   */\n  log (loggerID: string, ...msg: any) {\n    if (this.loggers[loggerID]) console.log(`${nowString()}[${loggerID}]:`, ...msg)\n    if (this.recorders[loggerID]) {\n      this.recorders[loggerID].push({\n        time: nowString(),\n        msg: msg\n      })\n    }\n  }\n\n  prependPokeElement (cn: CoreNote) {\n    const [el, note] = this.makePoke(cn)\n    this.pokes.push(note)\n    while (this.pokes.length > noteCacheSize) this.pokes.shift()\n    this.prependListElement(this.page.pokeList, note, el)\n  }\n\n  prependNoteElement (cn: CoreNote, skipSave?: boolean) {\n    const [el, note] = this.makeNote(cn)\n    this.notes.push(note)\n    while (this.notes.length > noteCacheSize) this.notes.shift()\n    const noteList = this.page.noteList\n    this.prependListElement(noteList, note, el)\n    if (!skipSave) this.storeNotes()\n    // Set the indicator color.\n    if (this.notes.length === 0 || (Doc.isDisplayed(this.page.noteBox) && Doc.isDisplayed(noteList))) return\n    let unacked = 0\n    const severity = this.notes.reduce((s, note) => {\n      if (!note.acked) unacked++\n      if (!note.acked && note.severity > s) return note.severity\n      return s\n    }, ntfn.IGNORE)\n    const ni = this.page.noteIndicator\n    setSeverityClass(ni, severity)\n    if (unacked) {\n      ni.textContent = String((unacked > noteCacheSize - 1) ? `${noteCacheSize - 1}+` : unacked)\n      Doc.show(ni)\n    } else Doc.hide(ni)\n  }\n\n  prependListElement (noteList: HTMLElement, note: CoreNotePlus, el: NoteElement) {\n    el.note = note\n    noteList.prepend(el)\n    while (noteList.children.length > noteCacheSize) noteList.removeChild(noteList.lastChild as Node)\n    this.setNoteTimes(noteList)\n  }\n\n  /*\n   * makeNote constructs a single notification element for the drop-down\n   * notification list.\n   */\n  makeNote (note: CoreNote): [NoteElement, CoreNotePlus] {\n    const el = this.page.noteTmpl.cloneNode(true) as NoteElement\n    if (note.severity > ntfn.POKE) {\n      const cls = note.severity === ntfn.SUCCESS ? 'good' : note.severity === ntfn.WARNING ? 'warn' : 'bad'\n      Doc.safeSelector(el, 'div.note-indicator').classList.add(cls)\n    }\n\n    Doc.safeSelector(el, 'div.note-subject').textContent = note.subject\n    Doc.safeSelector(el, 'div.note-details').textContent = note.details\n    const np: CoreNotePlus = { el, ...note }\n    return [el, np]\n  }\n\n  makePoke (note: CoreNote): [NoteElement, CoreNotePlus] {\n    const el = this.page.pokeTmpl.cloneNode(true) as NoteElement\n    const d = new Date(note.stamp)\n    Doc.tmplElement(el, 'dateTime').textContent = `${d.toLocaleDateString()}, ${d.toLocaleTimeString()}`\n    Doc.tmplElement(el, 'details').textContent = `${note.subject}: ${note.details}`\n    const np: CoreNotePlus = { el, ...note }\n    return [el, np]\n  }\n\n  /*\n   * loading appends the loader to the specified element and displays the\n   * loading icon. The loader will block all interaction with the specified\n   * element until Application.loaded is called.\n   */\n  loading (el: HTMLElement): () => void {\n    const loader = this.page.loader.cloneNode(true) as HTMLElement\n    el.appendChild(loader)\n    return () => { loader.remove() }\n  }\n\n  /* orders retrieves a list of orders for the specified dex and market. */\n  orders (host: string, mktID: string): Order[] {\n    let o = this.user.exchanges[host].markets[mktID].orders\n    if (!o) {\n      o = []\n      this.user.exchanges[host].markets[mktID].orders = o\n    }\n    return o\n  }\n\n  /*\n   * haveActiveOrders returns whether or not the there are active orders\n   * involving a certain asset.\n   */\n  haveAssetOrders (assetID: number): boolean {\n    for (const xc of Object.values(this.user.exchanges)) {\n      if (!xc.markets) continue\n      for (const market of Object.values(xc.markets)) {\n        if (!market.orders) continue\n        for (const ord of market.orders) {\n          if ((ord.baseID === assetID || ord.quoteID === assetID) &&\n            (ord.status < StatusExecuted || hasLiveMatches(ord))) return true\n        }\n      }\n    }\n    return false\n  }\n\n  walletIsActive (assetID: number): boolean {\n    if (this.haveAssetOrders(assetID)) return true\n    for (const xc of Object.values(this.user.exchanges)) {\n      if (xc.pendingFee && xc.pendingFee.assetID === assetID) {\n        return true\n      }\n    }\n    return false\n  }\n\n  /* order attempts to locate an order by order ID. */\n  order (oid: string): Order | null {\n    for (const xc of Object.values(this.user.exchanges)) {\n      for (const market of Object.values(xc.markets)) {\n        if (!market.orders) continue\n        for (const ord of market.orders) {\n          if (ord.id === oid) return ord\n        }\n      }\n    }\n    return null\n  }\n\n  /*\n   * canAccelerateOrder returns true if the \"from\" wallet of the order\n   * supports acceleration, and if the order has unconfirmed swap\n   * transactions.\n   */\n  canAccelerateOrder (order: Order): boolean {\n    const walletTraitAccelerator = 1 << 4\n    let fromAssetID\n    if (order.sell) fromAssetID = order.baseID\n    else fromAssetID = order.quoteID\n    const wallet = this.walletMap[fromAssetID]\n    if (!wallet || !(wallet.traits & walletTraitAccelerator)) return false\n    if (order.matches) {\n      for (let i = 0; i < order.matches.length; i++) {\n        const match = order.matches[i]\n        if (match.swap && match.swap.confs && match.swap.confs.count === 0) {\n          return true\n        }\n      }\n    }\n    return false\n  }\n\n  /*\n   * unitInfo fetches unit info [dex.UnitInfo] for the asset. If xc\n   * [core.Exchange] is provided, and this is not a SupportedAsset, the UnitInfo\n   * sent from the exchange's assets map [dex.Asset] will be used.\n   */\n  unitInfo (assetID: number, xc?: Exchange): UnitInfo {\n    const supportedAsset = this.assets[assetID]\n    if (supportedAsset) return supportedAsset.info.unitinfo\n    if (!xc) {\n      throw Error(`no supported asset info for id = ${assetID}, and no exchange info provided`)\n    }\n    return xc.assets[assetID].unitInfo\n  }\n\n  /* conventionalRate converts the encoded atomic rate to a conventional rate */\n  conventionalRate (baseID: number, quoteID: number, encRate: number): number {\n    const [b, q] = [this.unitInfo(baseID), this.unitInfo(quoteID)]\n    const r = b.conventional.conversionFactor / q.conventional.conversionFactor\n    return encRate / RateEncodingFactor * r\n  }\n\n  walletDefinition (assetID: number, walletType: string): WalletDefinition {\n    const assetInfo = this.assets[assetID].info\n    if (walletType === '') return assetInfo.availablewallets[assetInfo.emptyidx]\n    return assetInfo.availablewallets.filter(def => def.type === walletType)[0]\n  }\n\n  currentWalletDefinition (assetID: number): WalletDefinition {\n    return this.walletDefinition(assetID, this.assets[assetID].wallet.type)\n  }\n\n  /*\n   * fetchBalance requests a balance update from the API. The API response does\n   * include the balance, but we're ignoring it, since a balance update\n   * notification is received via the Application anyways.\n   */\n  async fetchBalance (assetID: number): Promise<WalletBalance> {\n    const res: BalanceResponse = await postJSON('/api/balance', { assetID: assetID })\n    if (!this.checkResponse(res)) {\n      throw new Error(`failed to fetch balance for asset ID ${assetID}`)\n    }\n    return res.balance\n  }\n\n  /*\n   * checkResponse checks the response object as returned from the functions in\n   * the http module. If the response indicates that the request failed, a\n   * message will be displayed in the drop-down notifications and false will be\n   * returned.\n   */\n  checkResponse (resp: APIResponse, skipNote?: boolean): boolean {\n    if (!resp.requestSuccessful || !resp.ok) {\n      if (this.user.inited && !skipNote) this.notify(ntfn.make(intl.prep(intl.ID_API_ERROR), resp.msg, ntfn.ERROR))\n      return false\n    }\n    return true\n  }\n\n  /**\n   * signOut call to /api/logout, if response with no errors occurred clear all\n   * store, remove auth, darkMode cookies and reload the page, otherwise will\n   * show a notification\n   */\n  async signOut () {\n    const res = await postJSON('/api/logout')\n    if (!this.checkResponse(res)) {\n      Doc.hide(this.page.profileBox)\n      return\n    }\n    State.clearAllStore()\n    State.removeAuthCK()\n    window.location.href = '/login'\n  }\n}\n\n/* getSocketURI returns the websocket URI for the client. */\nfunction getSocketURI (): string {\n  const protocol = (window.location.protocol === 'https:') ? 'wss' : 'ws'\n  return `${protocol}://${window.location.host}/ws`\n}\n\n/*\n * severityClassMap maps a notification severity level to a CSS class that\n * assigns a background color.\n */\nconst severityClassMap: Record<number, string> = {\n  [ntfn.SUCCESS]: 'good',\n  [ntfn.ERROR]: 'bad',\n  [ntfn.WARNING]: 'warn'\n}\n\n/* handlerFromPath parses the handler name from the path. */\nfunction handlerFromPath (path: string): string {\n  return path.replace(/^\\//, '').split('/')[0].split('?')[0].split('#')[0]\n}\n\n/* nowString creates a string formatted like HH:MM:SS.xxx */\nfunction nowString (): string {\n  const stamp = new Date()\n  const h = stamp.getHours().toString().padStart(2, '0')\n  const m = stamp.getMinutes().toString().padStart(2, '0')\n  const s = stamp.getSeconds().toString().padStart(2, '0')\n  const ms = stamp.getMilliseconds().toString().padStart(3, '0')\n  return `${h}:${m}:${s}.${ms}`\n}\n\nfunction setSeverityClass (el: HTMLElement, severity: number) {\n  el.classList.remove('bad', 'warn', 'good')\n  el.classList.add(severityClassMap[severity])\n}\n\n/* updateMatch updates the match in or adds the match to the order. */\nfunction updateMatch (order: Order, match: Match) {\n  for (const i in order.matches) {\n    const m = order.matches[i]\n    if (m.matchID === match.matchID) {\n      order.matches[i] = match\n      return\n    }\n  }\n  order.matches = order.matches || []\n  order.matches.push(match)\n}\n","import Application from './js/app'\nimport { registerApplication } from './js/registry'\nimport './css/application.scss'\n\nconst app = new Application()\nregisterApplication(app)\napp.start()\n"],"names":["module","exports","runtime","undefined","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","state","GenStateSuspendedStart","method","arg","GenStateExecuting","Error","GenStateCompleted","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","done","GenStateSuspendedYield","makeInvokeMethod","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","resolve","reject","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","o","get","prop","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","minLen","toString","from","test","_slicedToArray","isArray","_i","_s","_e","_arr","_n","_d","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","_defineProperty","locale","ID_NO_PASS_ERROR_MSG","ID_NO_APP_PASS_ERROR_MSG","ID_SET_BUTTON_BUY","ID_SET_BUTTON_SELL","ID_OFF","ID_READY","ID_LOCKED","ID_NOWALLET","ID_WALLET_SYNC_PROGRESS","ID_HIDE_ADDITIONAL_SETTINGS","ID_SHOW_ADDITIONAL_SETTINGS","ID_BUY","ID_SELL","ID_NOT_SUPPORTED","ID_CONNECTION_FAILED","ID_ORDER_PREVIEW","ID_CALCULATING","ID_ESTIMATE_UNAVAILABLE","ID_NO_ZERO_RATE","ID_NO_ZERO_QUANTITY","ID_TRADE","ID_NO_ASSET_WALLET","ID_EXECUTED","ID_BOOKED","ID_CANCELING","ID_PASSWORD_NOT_MATCH","ID_ACCT_UNDEFINED","ID_KEEP_WALLET_PASS","ID_NEW_WALLET_PASS","ID_LOT","ID_LOTS","ID_UNKNOWN","ID_EPOCH","ID_SETTLING","ID_NO_MATCH","ID_CANCELED","ID_REVOKED","ID_WAITING_FOR_CONFS","ID_NONE_SELECTED","ID_REGISTRATION_FEE_SUCCESS","ID_API_ERROR","ID_ADD","ID_CREATE","ID_SETUP_WALLET","ID_WALLET_READY","ID_CHANGE_WALLET_TYPE","ID_KEEP_WALLET_TYPE","WALLET_READY","SETUP_NEEDED","enUS","ptBR","zhCN","plPL","localesMap","defaultLocale","prep","k","expression","replace","_","stringTemplateParser","window","localeDiscrepancies","ref","entries","lang","dict","s","console","log","parser","DOMParser","BipSymbols","intFormatter","Intl","NumberFormat","navigator","languages","decimalFormatters","fullPrecisionFormatters","fullPrecisionFormatter","prec","formatter","formatters","min","max","fmt","minimumFractionDigits","maximumFractionDigits","convertToConventional","v","unitInfo","f","conventional","conversionFactor","Math","round","log10","Doc","el","id","querySelector","ev","addEventListener","removeEventListener","html","parseFromString","e","rect","getBoundingClientRect","pageX","left","right","pageY","top","bottom","box","docEl","document","documentElement","scrollTop","scrollLeft","w","offsetWidth","h","offsetHeight","bodyTop","bodyLeft","width","height","centerX","centerY","els","firstChild","removeChild","classList","add","remove","contains","duration","easingAlgo","easer","Easing","linear","start","Date","getTime","range","end","frameDuration","now","sleep","ancestor","querySelectorAll","children","warn","createElement","applySelector","vAtomic","Number","isInteger","format","decimalFormatter","rate","symbol","indexOf","substring","tmpls","tmpl","removeAttribute","dataset","t","formatDuration","dur","y","mo","m","seconds","floor","count","timeMod","aYear","aMonth","aDay","anHour","aMinute","inputFields","inputField","preventDefault","easeIn","easeOut","easeInHard","easeOutHard","WalletIcons","stateElement","icons","sleeping","locked","unlocked","nowallet","syncing","nopeers","status","hide","show","textContent","intl","wallet","syncIcon","running","peerCount","synced","tooltip","syncProgress","toFixed","setSyncing","open","ms","setTimeout","darkModeCK","popupsCK","State","cname","cvalue","setTime","expires","toUTCString","cookie","split","trim","dark","setCookie","body","filter","item","includes","getCookie","localStorage","setItem","JSON","stringify","clear","getItem","parse","_assertThisInitialized","ReferenceError","_setPrototypeOf","p","_inherits","subClass","superClass","_typeof","_possibleConstructorReturn","_getPrototypeOf","ConnectionStatus","application","BasePage","requestJSON","addr","reqBody","fetch","headers","Headers","response","json","requestSuccessful","text","msg","postJSON","data","getJSON","_toConsumableArray","app","orderOptTmpl","booleanOptTmpl","rangeOptTmpl","RateEncodingFactor","sellString","ord","sell","typeString","tif","isMarketBuy","hasLiveMatches","order","matches","match","revoked","statusString","isLive","cancelling","filled","qty","reduce","isCancel","settled","side","setOptionTemplates","page","OrderOption","opt","isSwapOption","report","node","cloneNode","parseTemplate","optName","displayname","description","baseSymbol","quoteSymbol","chainIcon","src","logoPath","on","bind","enable","toggle","stopPropagation","disable","dexAssetSymbol","host","quote","base","BooleanOrderOption","changed","cfg","control","controls","appendChild","reason","options","store","XYRangeOrderOption","xyRange","setVal","x","handler","XYRangeHandler","initVal","updated","selected","roundY","slider","rangeX","rangeY","normalizeX","r","number","minimumSignificantDigits","maximumSignificantDigits","accept","skipUpdate","style","clickOutX","xInput","xx","parseFloat","clamp","unbind","focus","clickOutY","yInput","yy","button","startX","clientWidth","startLeft","trackMouse","ee","mouseUp","rangeLblStart","label","rangeLblEnd","xUnit","yUnit","optionElement","change","isSwap","assetID","exchanges","assets","NewWalletForm","form","success","pwCache","backFunc","pwHiders","refresh","goBack","empty","walletTabTmpl","subform","WalletConfigForm","walletSettings","showOther","walletSettingsHeader","submitAdd","submit","oneBttn","passwordIsCached","pw","appPass","newWalletPass","newWalletErr","currentAsset","createForm","pass","config","map","walletType","currentWalletType","loaded","loading","mainForm","res","checkResponse","setError","asset","tabs","walletTypeTabs","assetLogo","assetName","availablewallets","header","walletDef","wDef","tab","kids","update","bindTooltips","appPwCached","auth","oneBttnBox","newWalletPassBox","configOpts","configopts","isBirthdayConfig","seedGenTime","toUnixDate","seeded","noauth","dynamicOpts","loadDefaults","errMsg","walletDefinition","configpath","setLoadedConfig","sectionize","configElements","allSettings","tmplElement","textInputTmpl","dateInputTmpl","checkboxTmpl","fileSelector","fileInput","showIcon","hideIcon","showHideMsg","otherSettings","loadedSettingsMsg","loadedSettings","defaultSettingsMsg","defaultSettings","click","fileInputChanged","setOtherSettingsViz","files","configtext","append","setConfig","reorder","defaultOpts","loadedOpts","walletIsActive","defaultedOpts","addOpt","elID","isboolean","isdate","input","configOpt","safeSelector","htmlFor","prepend","noecho","checked","getMinMaxVal","minMax","toISOString","valueAsDate","disabled","Boolean","disablewhenactive","visible","finds","toLowerCase","parseInt","minDate","MIN_SAFE_INTEGER","maxDate","MAX_SAFE_INTEGER","date","inputs","ConfirmRegistrationForm","certFile","submitForm","xc","passBox","unitinfo","feeAssetID","regAsset","regFees","fee","formatCoinValue","amount","feeUnit","unit","toUpperCase","logo","animate","prog","transform","opacity","String","pow","offset","regErr","innerText","user","feeAsset","cert","dexAddr","registration","FeeAssetSelectionForm","cleanTemplates","marketTmpl","assetTmpl","allMarkets","cFactor","ui","marketNode","mkt","excludeIcon","baseAsset","baseid","baseUnitInfo","quoteAsset","quoteid","quoteUnitInfo","excludeBase","otherSymbol","otherLogo","parent","parentNode","insertBefore","nextSibling","lotsize","lotSize","spot","quoteLotSize","quoteLot","OrderUtil","haveWallet","assetNode","confs","ready","markets","fader","setExchange","how","regAssetElements","allmkts","marginTop","paddingTop","fontSize","WalletWaitForm","progressCache","progressed","funded","registerNoteFeeder","walletstate","note","reportWalletState","balance","reportBalance","txFee","regFee","depoAddr","address","syncUncheck","syncCheck","balUncheck","balCheck","syncRemainBox","balanceBox","totalFees","sendEnoughWithEst","sendEnough","syncSpinner","available","progress","reportProgress","bal","cache","stamp","shift","first","last","progDelta","progRate","toGoTime","syncRemain","UnlockWalletForm","idDescendants","submitUnlock","uwAssetLogo","uwAssetName","uwAppPass","unlockErr","uwAppPassBox","submitUnlockDiv","AccelerateOrderForm","accelerateSubmit","submitEarlyConfirm","sendAccelerateRequest","earlyAcceleration","recentAccelerationTime","timePast","recentSwapTime","wasAcceleration","recentAccelerationMsg","recentSwapMsg","configureAccelerationDiv","accelerateErr","earlyAccelerationDiv","req","acceleratePass","orderID","newRate","acceleratedRate","accelerateMainDiv","accelerateTxID","txID","preAccelerateErr","accelerateMsgDiv","accelerateSuccess","displayEarlyAccelerationMsg","feeEstimateDiv","preAccelerate","currencyUnit","suggestedRange","accelerateAvgFeeRate","swapRate","accelerateCurrentFeeRate","suggestedRate","updateRate","newY","rangeHandler","updateAccelerationEstimate","sliderContainer","feeRateEstimate","baseID","assetSymbol","quoteID","feeEstimate","DEXAddressForm","dexToUpdate","defaultTLSText","selectedCert","onCertFileChange","removeCert","clearCertFile","addCert","showCustom","customBox","knownExchanges","knownXCs","div","checkDEX","appPW","addDexHdr","updateDexHdr","appPWBox","pickServerMsg","addCustomMsg","endpoint","newHost","oldHost","needCert","paid","fetchUser","loadPage","LoginForm","headerTxt","rememberPass","notes","setNotes","animationLength","slideSwap","form1","form2","submitBttn","wrapper","RegistrationPage","bindForm","appPWForm","appPWSubmit","setAppPass","showSeedRestore","seedRestore","loginForm","dexAddrForm","newWalletForm","newWalletCreated","animateRegAsset","currentDEX","confirmRegisterForm","walletWaitForm","regAssetForm","setAsset","animateConfirmForm","getRegistrationTxFeeEstimate","setWallet","walletWait","confirmRegForm","registerDEXSuccess","currentForm","forms","authed","oldForm","getCertFile","txfee","appPWErrMsg","pwAgain","appPWAgain","seed","seedInput","updateMenuItemsDisplay","feeAmt","LoginPage","idel","loggedIn","make","subject","details","severity","acked","topic","WalletsPage","restoreInfoCard","closePopups","cancelForce","copyAddressBtn","copyAddress","firstRow","getAction","row","rowInfos","walletTable","tr","stateIcons","actions","connect","unlock","send","deposit","rescan","lock","settings","marketCard","oneMarket","createWalletSuccess","reconfigForm","reconfigInputs","unlockForm","unlockWalletForm","openWalletSuccess","sendForm","submitSendForm","submitReconfig","reconfig","rowInfo","showMarkets","rightBox","lastFormAsset","mouseInElement","keyup","isDisplayed","downloadLogs","exportWallet","displayExportWalletAuth","recoverWallet","showRecoverWallet","exportWalletAuth","exportWalletAuthSubmit","recoverWalletConfirm","recoverWalletSubmit","confirmForce","confirmForceSubmit","run","doConnect","showSendForm","showDeposit","showNewWallet","rescanWallet","openWallet","showReconfig","newDepAddrBttn","newDepositAddress","sendAvail","sendAsset","sendAmt","showFiatValue","sendValue","traits","subtractCheckBox","walletMap","fiatDisplay","amt","showChangePW","changeWalletPW","setPWSettingViz","changeWalletTypeSelect","changeWalletType","showChangeType","isHidden","changeTypeHideIcon","changeTypeShowIcon","changeTypeMsg","reconfigAsset","fiatrateupdate","handleRatesNote","handleBalanceNote","handleWalletStateNote","walletconfig","clipboard","writeText","depositAddress","copyAlert","changePW","switchPWMsg","animation","displayed","focuser","marketsBox","card","marketsCard","hideBox","marketsFor","marketsForLogo","market","marketBox","dexTitle","mBox","prettyMarketName","counterSymbol","basesymbol","quotesymbol","pageData","showBox","walletAsset","url","code","forceUrl","forceReq","showConfirmForce","confirmForceErr","showForm","recoverWalletErr","showOpen","openAsset","errorMsg","showErrorOnly","walletPass","reconfigErr","currentDef","currentWalletDefinition","option","recfgAssetLogo","recfgAssetName","updateDisplayedReconfigFields","depositErr","depositLogo","depositAsset","notify","ntfn","depositName","qrcode","senderOnlyHelpText","toggleSubtract","sendAddr","sendPW","sendErr","formatFullPrecision","sendLogo","sendName","encrypted","subtract","newWalletPW","newPW","search","URLSearchParams","URL","location","href","pathname","exportWalletErr","exportWalletPW","displayRestoreWalletInfo","restorationinfo","restoreInfoCardsList","wr","seedName","instructions","restoreWalletInfo","recoverWalletPW","force","fiatRatesMap","fiatRates","display","formatFiatConversion","parentElement","readWallet","SettingsPage","fiatRateSources","darkMode","showPokes","showPopups","commitHash","addADex","source","importAccount","prepareAccountImport","authorizeAccountImportForm","authorizeImportAccountConfirm","changeAppPW","changeAppPWForm","submitNewPW","accountFile","onAccountFileChange","removeAccount","clearAccountFile","addAccount","exportSeed","exportSeedAuth","exportSeedSubmit","submitExportSeedReq","exportSeedPW","seedDiv","selectedAccount","importAccountErr","importAccountAppPass","accountString","account","message","importResponse","loginResponse","reload","exportAccountErr","exportSeedE","authorizeSeedDisplay","changePWErrMsg","clearValues","newAppPW","confirmNewPW","OrderBook","mktBook","buys","book","sells","qtyAtomic","splice","less","findIdx","token","removeFromSide","findOrder","updateRemainingSide","epochIdx","approve","epoch","best","bestGapOrder","PIPI","PI","plusChar","fromCharCode","minusChar","darkTheme","axisLabel","gridBorder","gridLines","gapLine","zoom","zoomHover","sellLine","buyLine","sellFill","buyFill","crosshairs","legendFill","legendText","lightTheme","Chart","reporters","theme","isDark","canvas","ctx","getContext","textAlign","textBaseline","setZoomBttns","mousePos","clientX","clientY","draw","wheelLimiter","wheel","boundResizer","resize","clientHeight","clearRect","render","deltaY","parentHeight","plotExtents","Extents","xLblExtents","yLblExtents","plotRegion","Region","xRegion","yRegion","requestAnimationFrame","bigger","font","fillStyle","labels","minX","maxX","unitLines","extents","plot","tools","applyLabelStyle","lastX","unitCenter","lbls","lbl","fillText","txt","val","lineWidth","strokeStyle","line","region","minY","maxY","lastY","step","valFmt","yLabels","makeLabels","dataExtents","yAxisWidth","widest","plotYLabels","beginPath","dataCoords","moveTo","lineTo","stroke","DepthChart","resized","clicked","zoomed","zoomLevel","lines","markers","zoomInBttn","zoomOutBttn","wheeled","translator","unx","rateStep","qFactor","bFactor","baseUnit","quoteUnit","gap","midGap","gapWidth","minZoom","halfWindow","high","low","buyMarkers","sellMarkers","sort","b","buyDepth","buyEpoch","sellDepth","sellEpoch","volumeReport","buyBase","buyQuote","sellBase","sellQuote","sum","epochSum","floatCompare","active","buySum","epochBuySum","sellSum","epochSellSum","growthFactor","doYLabels","xLabels","plotXLabels","mouseData","drawFrame","formatLabelValue","topCenterX","midX","topCenterY","zoomPct","xRange","zoomText","measureText","bttnLeft","bttnTop","bttnSize","setExtents","hover","midY","drawLine","color","save","setLineDash","restore","tolerance","hoverMarkers","marker","hovered","withinTolerance","size","tip","sqrt","closePath","fill","dataX","evalSide","trigger","ptX","dotColor","bestDepth","pt","depth","drawDepth","radius","arc","dot","volume","mouse","firstPt","globalAlpha","bestGapBuy","bestGapSell","CandleChart","numToShow","ext","candleExtents","yRange","candleRegion","volumeExtents","volumeRegion","resizeTimer","clearTimeout","idx","zoomLevels","candles","candleWidth","allCandles","c","truncate","endStamp","paddedStart","paddedWidth","highRate","lowRate","matchVolume","highVol","ratestep","rFactor","rateConversionFactor","screenW","spacingGuess","diff","tick","zoneOffset","getTimezoneOffset","dayStamp","lastDay","lastYear","pts","months","getMonth","getDate","getHours","getMinutes","padStart","year","getFullYear","makeCandleTimeLabels","mouseCandle","selectedStartStamp","fillRect","yExt","rangeTxt","toLocaleString","rangeWidth","xExt","rectArgs","rangeHeight","strokeRect","volDataExtents","desc","startRate","endRate","cx","maxCandles","xMin","xMax","yMin","yMax","screenMinX","screenMaxY","screenH","xFactor","yFactor","uny","drawFunc","skipMask","clip","tx","ty","tickGuess","absMax","abs","sigFigs","toPrecision","unitW","x0","y0","x1","y1","skipStroke","labelSpecs","forward","route","payload","handlers","MessageSocket","queue","maxQlength","connection","readyState","WebSocket","OPEN","close","uri","reloader","retrys","go","conn","timeout","onmessage","evt","onclose","delay","onopen","request","onerror","bookRoute","bookOrderRoute","unbookOrderRoute","epochOrderRoute","candlesRoute","candleUpdateRoute","lastMarketKey","chartRatioKey","depthZoomKey","depthChart","candleChart","check","percentFormatter","MarketsPage","main","maxOrderUpdateCounter","metaOrders","preorderCache","depthLines","hovers","ordersSortKey","ordersSortDirection","ogTitle","title","depthReporters","reportDepthClick","reportDepthVolume","reportDepthMouse","z","reportDepthZoom","marketChart","candleReporters","reportMouseCandle","accelerateOrderForm","accelerateForm","currentChart","candleDur","wgt","balanceWgt","BalanceWidget","balanceTable","baseIcons","quoteIcons","walletUnlocked","expired","newWalletBttn","showCreate","rowTemplate","liveTemplate","durBttnTemplate","marketList","MarketList","xcSections","marketRows","setMarket","quoteUnits","baseUnits","buyBttn","swapBttns","sellBttn","maxLbl","setOrderBttnText","setOrderVisibility","drawChartLines","limitBttn","marketBttn","rateField","isSell","setMarketBuyOrderEstimate","maxOrd","maxSell","lotField","swap","lots","maxBuys","adjustedRate","lotChanged","depthBttn","depthChartSelected","candlestickBttn","candleChartSelected","disableMouseWheel","qtyField","mktBuyField","ws","handleBookRoute","handleBookOrderRoute","handleUnbookOrderRoute","handleUpdateRemainingRoute","handleEpochOrderRoute","handleCandleUpdateRoute","handleCandlesRoute","openFunc","createWallet","orderForm","stepSubmit","verifyForm","vSubmit","submitOrder","vUnlockSubmit","submitEstimateUnlock","cancelForm","cancelSubmit","submitCancel","vFeeDetails","vDetailPane","closeDetailPane","showVerifyForm","liveTable","th","setOrdersSortCol","ordercol","unsetOrdersSortColClasses","refreshActiveOrders","setOrdersSortColClasses","sortCls","vPass","cancelPass","quantityChanged","marketBuyChanged","rateFieldChanged","previewQuoteAmt","marketSearch","filterMarkets","clearChartLines","buyRows","sellRows","liveList","activeMarkerRate","setDepthMarkers","setChartRatio","chartDivRatio","chartResizer","chartRatio","rightSide","handleOrderNote","handleEpochNote","handleConnNote","feepayment","handleFeePayment","spots","handlePriceUpdate","makeMarket","exists","secondTicker","setInterval","metaOrder","timeSince","submitTime","setRegistrationStatusVisibility","setBalanceVisibility","dex","pendingFee","isLimit","priceBox","tifBox","qtyBox","maxBox","mktBuyBox","feePaid","hasFeePending","assetsAreSupported","hasWallets","loaderMsg","quoteCfg","baseCfg","titleContent","confStatusMsg","titleClass","regStatusTitle","regStatusConfsDisplay","registrationStatus","regStatusDex","pending","confirmationsRequired","confReq","setRegistrationStatusView","connectionStatus","Connected","updateRegistrationStatusView","resolveOrderFormVisibility","durBttnBox","candleDurs","bttn","candleDurationSelected","chartErrMsg","marketLoader","qui","bui","maxEstimateTimer","mktId","marketID","sid","maxSellRequested","candleCaches","sellBalance","buyBalance","loadCandles","setLoaderMsgVisibility","setCandleDurBttns","q","sellBookedBase","sellBookedQuote","buyBookedBase","buyBookedQuote","metaOrd","hoverPrice","hoverVolume","hoverData","candle","candleStart","candleEnd","candleHigh","candleLow","candleVol","limit","convertToAtoms","tifnow","tifNow","parseOrder","adjusted","orderErr","preSell","preBuy","orderPreview","quoteQty","total","baseWallet","setMaxOrder","scheduleMaxEstimate","quoteWallet","aLot","maxBuy","path","maxLoaded","bid","qid","bWallet","qWallet","maxLotBox","maxAboveZero","maxFromLots","maxFromLotsLbl","counter","maxOrder","fromAsset","toAsset","maxFromAmt","maxFromTicker","toConversion","maxToAmt","maxToTicker","loadTable","addTableOrder","set","msgRate","buffer","buybuffer","midGapConventional","minMktBuy","localeCompare","oid","orders","compare","ordersSortCompare","updateUserOrderRow","icon","showCancel","accelerateBttn","showAccelerate","canAccelerateOrder","bindInternalNavigation","updateDataCol","rateFactor","setMarkers","midGapValue","baseSymb","quoteSymb","handleBook","updateTitle","select","setWallets","removeTableOrder","updateRemaining","updateTableOrder","candlesLoading","timer","setCandles","startStamp","currentOrder","vUnlockPreorder","vPreorderErr","vPreorder","vBuySell","buySellStr","vSideSubmit","vOrderHost","verifyLimit","verifyMarket","orderDesc","vOrderType","vRate","vQty","vTotal","vFiatTotal","vmFromTotal","vmFromAsset","vmFromTotalFiat","vMarketEstimate","received","vmToTotal","vmToAsset","vmTotalFiat","buyBtnClass","sellBtnClass","vHeader","preOrder","unlockWalletsForEstimates","vErr","vUnlockPass","attemptWalletUnlock","setPreorderErr","assetIDs","cacheKey","cached","wireOrder","estimate","vPreorderErrTip","refreshPreorder","fetchPreorder","est","redeem","vOrderOpts","setFeeEstimates","vFeeSummary","backgroundColor","addOption","swapped","fmtPct","toUI","fromUI","bestSwapPct","realisticBestCase","vSwapFeesLowPct","vSwapFeesLow","worstSwapPct","realisticWorstCase","vSwapFeesHighPct","vSwapFeesHigh","vSwapFeesMaxPct","maxFees","vSwapFeesMax","estRate","bestRedeemPct","vRedeemFeesLowPct","vRedeemFeesLow","worstRedeemPct","vRedeemFeesHighPct","vRedeemFeesHigh","vFeeSummaryLow","vFeeSummaryHigh","cancelData","cancelErr","remaining","cancelRemain","cancelUnit","currentCreate","validateOrder","showVerify","xcSection","marketRow","setSpot","oldStatus","cancelBttn","setEpoch","clearOrderTableEpochs","alreadyMatched","statusTD","avail","vLoader","updateAsset","finalize","mktBuyLots","mktBuyScore","NaN","loadTableSide","bins","currEpochBin","currNonEpochBin","currRate","bin","bookSide","tbody","binOrdersByRateAndEpoch","orderTableRow","manager","getRate","insertOrder","removeOrder","u","updateOrderQty","clearOrderTableEpochSide","removeEpochOrders","orderBin","OrderTableRowManager","chart","setConnectionStatus","filterTxt","setFilter","setLines","candleHoverData","epochLine","depthHoverData","depthSummary","requestCandles","unattach","clearInterval","xcTmpl","ExchangeSection","sortedSections","firstXC","firstMkt","setConnected","template","disconnectedIco","disconnected","mkts","mktrow","MarketRow","sortedMarkets","isConnected","baseIcon","quoteIcon","pctChange","pct","change24","num","sign","bottomRow","price","table","baseImg","baseAvail","newWalletRow","baseNewWalletRow","baseNewButton","baseLocked","immature","baseImmature","unsupported","baseUnsupported","baseExpired","baseConnect","spinner","baseSpinner","iconBox","baseWalletState","quoteImg","quoteAvail","quoteNewWalletRow","quoteNewButton","quoteLocked","quoteImmature","quoteUnsupported","quoteExpired","quoteConnect","quoteSpinner","quoteWalletState","updateWallet","fetchBalance","contractlocked","before","col","stringyOptions","assign","tableRow","setRateEl","setEpochEl","updateQtyNumOrdersEl","epochEl","isEpoch","rateEl","cssClass","curr","numOrders","qtyEl","numOrdersEl","setAttribute","index","findIndex","newEpoch","OrdersPage","orderTmpl","rowTmpl","filterState","hosts","statuses","readFilter","filterKey","subFilter","hostFilter","assetFilter","statusFilter","applyButtons","monitorFilter","applyBttn","submitFilter","filter1","filter2","compareSubFilter","parseSubFilter","ordersTable","nextPage","exportOrders","tableBody","appendOrders","tmplID","mktID","to","fromQty","toQty","conventionalRate","dateTime","fetchOrders","setOrders","currentFilter","setQuery","orderLoader","net","OrderPage","stampers","fetchOrder","refreshOnPopupClose","showAccelerateForm","showAccelerationButton","link","setCoinHref","setStamp","span","handleMatchNote","actionsLabel","processMatch","matchBox","matchID","setCoin","divName","linkName","coin","coinLink","stringID","explorerCoin","counterSwap","counterRedeem","refund","swapSpan","cSwapSpan","inCounterSwapCast","inSwapCast","confirmationString","required","assetExplorer","CoinExplorers","explorerId","cid","txid","vout","DexSettingsPage","exportDexBtn","prepareAccountExport","authorizeAccountExportForm","disableAcctBtn","prepareAccountDisable","disableAccountForm","updateCertBtn","certFileInput","updateHostBtn","prepareUpdateHost","authorizeExportAccountConfirm","exportAccount","disableAccountConfirm","disableAccount","exportAccountAppPass","exportAccountHost","accountForExport","disableAccountAppPW","disableAccountHost","disableAccountErr","updateCertMsg","exchange","displayIcons","connected","disconnectedIcon","connectedIcon","Disconnected","InvalidCert","loggersKey","recordersKey","constructors","login","register","wallets","dexsettings","unauthedPages","Application","pokes","inited","seedgentime","ok","process","noteReceivers","loggers","enableLogger","loggerID","recorderKeys","recorders","recordLogger","dumpLogger","btoa","download","handlerFromPath","history","replaceState","attachHeader","attachCommon","attach","protocol","reconnected","resp","skipNote","skipPush","noteBox","profileBox","origin","requestedHandler","doc","noderize","delivered","pushState","replaceWith","handlerID","loadedPage","unload","lyt","layoutMetrics","popupNotes","popupTmpl","noteTmpl","pokeTmpl","loader","noteMenuEntry","pokeList","noteList","ackNotes","noteCat","pokeCat","showDropdown","noteIndicator","setNoteTimes","storeNotes","profileMenuEntry","innerNoteIcon","innerProfileIcon","profileSignout","signOut","dialog","ico","innerWidth","acks","pageURL","params","searchParams","walletsMenuEntry","marketsMenuEntry","updateExchangeRegistration","confirmations","setDEXPaid","prependNoteElement","updateOrder","handleFeePaymentNote","updateMatch","mktName","indicator","setSeverityClass","pn","prependPokeElement","receivers","nowString","time","cn","makePoke","prependListElement","skipSave","makeNote","unacked","ni","noteCacheSize","lastChild","cls","toLocaleDateString","toLocaleTimeString","haveAssetOrders","fromAssetID","supportedAsset","encRate","assetInfo","emptyidx","def","clearAllStore","removeAuthCK","severityClassMap","getSeconds","getMilliseconds"],"sourceRoot":""}